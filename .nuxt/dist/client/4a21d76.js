/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{799:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return cr})),n.d(e,"b",(function(){return lr})),n.d(e,"c",(function(){return fr})),n.d(e,"d",(function(){return pr})),n.d(e,"e",(function(){return dr})),n.d(e,"f",(function(){return vr})),n.d(e,"g",(function(){return ur})),n.d(e,"h",(function(){return ar}));var r=function(t,b){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,b){t.__proto__=b}||function(t,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(t[p]=b[p])})(t,b)};function o(t){var s="function"==typeof Symbol&&Symbol.iterator,e=s&&t[s],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")}var c,h="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},f=f||{},l=h||self;function d(){}function v(a){var b=typeof a;return"array"==(b="object"!=b?b:a?Array.isArray(a)?"array":b:"null")||"object"==b&&"number"==typeof a.length}function y(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}var m="closure_uid_"+(1e9*Math.random()>>>0),w=0;function I(a,b,t){return a.call.apply(a.bind,arguments)}function E(a,b,t){if(!a)throw Error();if(2<arguments.length){var e=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,e),a.apply(b,t)}}return function(){return a.apply(b,arguments)}}function p(a,b,t){return(p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?I:E).apply(null,arguments)}function _(a,b){var t=Array.prototype.slice.call(arguments,1);return function(){var e=t.slice();return e.push.apply(e,arguments),a.apply(this,e)}}function q(){return Date.now()}function O(a,b){function t(){}t.prototype=b.prototype,a.X=b.prototype,a.prototype=new t,a.prototype.constructor=a,a.Kb=function(t,e,n){for(var g=Array(arguments.length-2),r=2;r<arguments.length;r++)g[r-2]=arguments[r];return b.prototype[e].apply(t,g)}}function T(){this.j=this.j,this.i=this.i}T.prototype.j=!1,T.prototype.ja=function(){if(!this.j&&(this.j=!0,this.G(),0))(function(a){Object.prototype.hasOwnProperty.call(a,m)&&a[m]||(a[m]=++w)})(this)},T.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var A=Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b,void 0)}:function(a,b){if("string"==typeof a)return"string"!=typeof b||1!=b.length?-1:a.indexOf(b,0);for(var t=0;t<a.length;t++)if(t in a&&a[t]===b)return t;return-1},j=Array.prototype.forEach?function(a,b,t){Array.prototype.forEach.call(a,b,t)}:function(a,b,t){for(var e=a.length,n="string"==typeof a?a.split(""):a,r=0;r<e;r++)r in n&&b.call(t,n[r],r,a)};function N(a){return Array.prototype.concat.apply([],arguments)}function S(a){var b=a.length;if(0<b){for(var t=Array(b),e=0;e<b;e++)t[e]=a[e];return t}return[]}function k(a){return/^[\s\xa0]*$/.test(a)}var x,D=String.prototype.trim?function(a){return a.trim()}:function(a){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(a)[1]};function P(a,b){return-1!=a.indexOf(b)}function R(a,b){return a<b?-1:a>b?1:0}t:{var C=l.navigator;if(C){var L=C.userAgent;if(L){x=L;break t}}x=""}function U(a,b,t){for(var e in a)b.call(t,a[e],e,a)}function V(a){var b={};for(var t in a)b[t]=a[t];return b}var M="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function F(a,b){for(var t,e,n=1;n<arguments.length;n++){for(t in e=arguments[n])a[t]=e[t];for(var r=0;r<M.length;r++)t=M[r],Object.prototype.hasOwnProperty.call(e,t)&&(a[t]=e[t])}}function B(a){return B[" "](a),a}B[" "]=d;var G,a,z=P(x,"Opera"),K=P(x,"Trident")||P(x,"MSIE"),H=P(x,"Edge"),W=H||K,Y=P(x,"Gecko")&&!(P(x.toLowerCase(),"webkit")&&!P(x,"Edge"))&&!(P(x,"Trident")||P(x,"MSIE"))&&!P(x,"Edge"),Q=P(x.toLowerCase(),"webkit")&&!P(x,"Edge");function J(){var a=l.document;return a?a.documentMode:void 0}t:{var X="",$=(a=x,Y?/rv:([^\);]+)(\)|;)/.exec(a):H?/Edge\/([\d\.]+)/.exec(a):K?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a):Q?/WebKit\/(\S+)/.exec(a):z?/(?:Version)[ \/]?(\S+)/.exec(a):void 0);if($&&(X=$?$[1]:""),K){var Z=J();if(null!=Z&&Z>parseFloat(X)){G=String(Z);break t}}G=X}var tt,et={};function nt(a){return function(a,b){var t=et;return Object.prototype.hasOwnProperty.call(t,a)?t[a]:t[a]=b(a)}(a,(function(){for(var b=0,t=D(String(G)).split("."),e=D(String(a)).split("."),g=Math.max(t.length,e.length),n=0;0==b&&n<g;n++){var r=t[n]||"",o=e[n]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==r[0].length&&0==o[0].length)break;b=R(0==r[1].length?0:parseInt(r[1],10),0==o[1].length?0:parseInt(o[1],10))||R(0==r[2].length,0==o[2].length)||R(r[2],o[2]),r=r[3],o=o[3]}while(0==b)}return 0<=b}))}if(l.document&&K){var it=J();tt=it||(parseInt(G,10)||void 0)}else tt=void 0;var ot=tt,st=!K||9<=Number(ot),ut=K&&!nt("9"),at=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});try{l.addEventListener("test",d,b),l.removeEventListener("test",d,b)}catch(t){}return a}();function ct(a,b){this.type=a,this.a=this.target=b,this.defaultPrevented=!1}function ht(a,b){if(ct.call(this,a?a.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,a){var t=this.type=a.type,e=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.a=b,b=a.relatedTarget){if(Y){t:{try{B(b.nodeName);var n=!0;break t}catch(t){}n=!1}n||(b=null)}}else"mouseover"==t?b=a.fromElement:"mouseout"==t&&(b=a.toElement);this.relatedTarget=b,e?(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType="string"==typeof a.pointerType?a.pointerType:ft[a.pointerType]||"",this.c=a,a.defaultPrevented&&this.b()}}ct.prototype.b=function(){this.defaultPrevented=!0},O(ht,ct);var ft={2:"touch",3:"pen",4:"mouse"};ht.prototype.b=function(){ht.X.b.call(this);var a=this.c;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,ut)try{(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)&&(a.keyCode=-1)}catch(t){}};var lt="closure_listenable_"+(1e6*Math.random()|0),pt=0;function vt(a,b,t,e,n){this.listener=a,this.proxy=null,this.src=b,this.type=t,this.capture=!!e,this.ca=n,this.key=++pt,this.Y=this.Z=!1}function yt(a){a.Y=!0,a.listener=null,a.proxy=null,a.src=null,a.ca=null}function gt(a){this.src=a,this.a={},this.b=0}function mt(a,b){var t=b.type;if(t in a.a){var e,n=a.a[t],r=A(n,b);(e=0<=r)&&Array.prototype.splice.call(n,r,1),e&&(yt(b),0==a.a[t].length&&(delete a.a[t],a.b--))}}function bt(a,b,t,e){for(var n=0;n<a.length;++n){var r=a[n];if(!r.Y&&r.listener==b&&r.capture==!!t&&r.ca==e)return n}return-1}gt.prototype.add=function(a,b,t,e,n){var r=a.toString();(a=this.a[r])||(a=this.a[r]=[],this.b++);var g=bt(a,b,e,n);return-1<g?(b=a[g],t||(b.Z=!1)):((b=new vt(b,this.src,r,!!e,n)).Z=t,a.push(b)),b};var wt="closure_lm_"+(1e6*Math.random()|0),It={};function Et(a,b,t,e,n){if(e&&e.once)return function t(a,b,e,n,r){if(Array.isArray(b)){for(var o=0;o<b.length;o++)t(a,b[o],e,n,r);return null}return e=kt(e),a&&a[lt]?a.wa(b,e,y(n)?!!n.capture:!!n,r):_t(a,b,e,!0,n,r)}(a,b,t,e,n);if(Array.isArray(b)){for(var r=0;r<b.length;r++)Et(a,b[r],t,e,n);return null}return t=kt(t),a&&a[lt]?a.va(b,t,y(e)?!!e.capture:!!e,n):_t(a,b,t,!1,e,n)}function _t(a,b,t,e,n,r){if(!b)throw Error("Invalid event type");var g=y(n)?!!n.capture:!!n;if(g&&!st)return null;var o=Nt(a);if(o||(a[wt]=o=new gt(a)),(t=o.add(b,t,e,g,r)).proxy)return t;if(e=function(){var a=jt,b=st?function(t){return a.call(b.src,b.listener,t)}:function(t){if(!(t=a.call(b.src,b.listener,t)))return t};return b}(),t.proxy=e,e.src=a,e.listener=t,a.addEventListener)at||(n=g),void 0===n&&(n=!1),a.addEventListener(b.toString(),e,n);else if(a.attachEvent)a.attachEvent(Tt(b.toString()),e);else{if(!a.addListener||!a.removeListener)throw Error("addEventListener and attachEvent are unavailable.");a.addListener(e)}return t}function Ot(a){if("number"!=typeof a&&a&&!a.Y){var b=a.src;if(b&&b[lt])mt(b.c,a);else{var t=a.type,e=a.proxy;b.removeEventListener?b.removeEventListener(t,e,a.capture):b.detachEvent?b.detachEvent(Tt(t),e):b.addListener&&b.removeListener&&b.removeListener(e),(t=Nt(b))?(mt(t,a),0==t.b&&(t.src=null,b[wt]=null)):yt(a)}}}function Tt(a){return a in It?It[a]:It[a]="on"+a}function At(a,b){var t=a.listener,e=a.ca||a.src;return a.Z&&Ot(a),t.call(e,b)}function jt(a,b){if(a.Y)return!0;if(!st){if(!b)t:{b=["window","event"];for(var t=l,e=0;e<b.length;e++)if(null==(t=t[b[e]])){b=null;break t}b=t}return At(a,b=new ht(b,this))}return At(a,new ht(b,this))}function Nt(a){return(a=a[wt])instanceof gt?a:null}var St="__closure_events_fn_"+(1e9*Math.random()>>>0);function kt(a){return"function"==typeof a?a:(a[St]||(a[St]=function(b){return a.handleEvent(b)}),a[St])}function xt(){T.call(this),this.c=new gt(this),this.J=this,this.C=null}function Dt(a,b){var t,e=a.C;if(e)for(t=[];e;e=e.C)t.push(e);if(a=a.J,e=b.type||b,"string"==typeof b)b=new ct(b,a);else if(b instanceof ct)b.target=b.target||a;else{var n=b;F(b=new ct(e,a),n)}if(n=!0,t)for(var r=t.length-1;0<=r;r--){var g=b.a=t[r];n=Pt(g,e,!0,b)&&n}if(n=Pt(g=b.a=a,e,!0,b)&&n,n=Pt(g,e,!1,b)&&n,t)for(r=0;r<t.length;r++)n=Pt(g=b.a=t[r],e,!1,b)&&n}function Pt(a,b,t,e){if(!(b=a.c.a[String(b)]))return!0;b=b.concat();for(var n=!0,r=0;r<b.length;++r){var g=b[r];if(g&&!g.Y&&g.capture==t){var o=g.listener,c=g.ca||g.src;g.Z&&mt(a.c,g),n=!1!==o.call(c,e)&&n}}return n&&!e.defaultPrevented}O(xt,T),xt.prototype[lt]=!0,(c=xt.prototype).addEventListener=function(a,b,t,e){Et(this,a,b,t,e)},c.removeEventListener=function(a,b,t,e){!function t(a,b,e,n,r){if(Array.isArray(b))for(var o=0;o<b.length;o++)t(a,b[o],e,n,r);else n=y(n)?!!n.capture:!!n,e=kt(e),a&&a[lt]?(a=a.c,(b=String(b).toString())in a.a&&(-1<(e=bt(o=a.a[b],e,n,r))&&(yt(o[e]),Array.prototype.splice.call(o,e,1),0==o.length&&(delete a.a[b],a.b--)))):a&&(a=Nt(a))&&(b=a.a[b.toString()],a=-1,b&&(a=bt(b,e,n,r)),(e=-1<a?b[a]:null)&&Ot(e))}(this,a,b,t,e)},c.G=function(){if(xt.X.G.call(this),this.c){var t,a=this.c;for(t in a.a){for(var e=a.a[t],n=0;n<e.length;n++)yt(e[n]);delete a.a[t],a.b--}}this.C=null},c.va=function(a,b,t,e){return this.c.add(String(a),b,!1,t,e)},c.wa=function(a,b,t,e){return this.c.add(String(a),b,!0,t,e)};var Rt=l.JSON.stringify;function Ct(){this.b=this.a=null}var Lt,Ut=new(function(){function t(a,b){this.c=a,this.f=b,this.b=0,this.a=null}return t.prototype.get=function(){var a;return 0<this.b?(this.b--,a=this.a,this.a=a.next,a.next=null):a=this.c(),a},t}())((function(){return new Mt}),(function(a){a.reset()}));function Vt(){var a=Gt,b=null;return a.a&&(b=a.a,a.a=a.a.next,a.a||(a.b=null),b.next=null),b}function Mt(){this.next=this.b=this.a=null}function Ft(a){l.setTimeout((function(){throw a}),0)}function qt(a,b){Lt||function(){var a=l.Promise.resolve(void 0);Lt=function(){a.then(zt)}}(),Bt||(Lt(),Bt=!0),Gt.add(a,b)}Ct.prototype.add=function(a,b){var t=Ut.get();t.set(a,b),this.b?this.b.next=t:this.a=t,this.b=t},Mt.prototype.set=function(a,b){this.a=a,this.b=b,this.next=null},Mt.prototype.reset=function(){this.next=this.b=this.a=null};var Bt=!1,Gt=new Ct;function zt(){for(var a;a=Vt();){try{a.a.call(a.b)}catch(t){Ft(t)}var b=Ut;b.f(a),100>b.b&&(b.b++,a.next=b.a,b.a=a)}Bt=!1}function Kt(a,b){xt.call(this),this.b=a||1,this.a=b||l,this.f=p(this.Za,this),this.g=q()}function Ht(a){a.aa=!1,a.M&&(a.a.clearTimeout(a.M),a.M=null)}function Wt(a,b,t){if("function"==typeof a)t&&(a=p(a,t));else{if(!a||"function"!=typeof a.handleEvent)throw Error("Invalid listener argument");a=p(a.handleEvent,a)}return 2147483647<Number(b)?-1:l.setTimeout(a,b||0)}function Yt(a){a.a=Wt((function(){a.a=null,a.c&&(a.c=!1,Yt(a))}),a.h);var b=a.b;a.b=null,a.g.apply(null,b)}O(Kt,xt),(c=Kt.prototype).aa=!1,c.M=null,c.Za=function(){if(this.aa){var a=q()-this.g;0<a&&a<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-a):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Dt(this,"tick"),this.aa&&(Ht(this),this.start()))}},c.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=q())},c.G=function(){Kt.X.G.call(this),Ht(this),delete this.a};var Qt=function(t){function e(a,b){var e=t.call(this)||this;return e.g=a,e.h=b,e.b=null,e.c=!1,e.a=null,e}return function(t,b){function e(){this.constructor=t}r(t,b),t.prototype=null===b?Object.create(b):(e.prototype=b.prototype,new e)}(e,t),e.prototype.f=function(a){this.b=arguments,this.a?this.c=!0:Yt(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(l.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(T);function Jt(a){T.call(this),this.b=a,this.a={}}O(Jt,T);var Xt=[];function $t(a,b,t,e){Array.isArray(t)||(t&&(Xt[0]=t.toString()),t=Xt);for(var n=0;n<t.length;n++){var r=Et(b,t[n],e||a.handleEvent,!1,a.b||a);if(!r)break;a.a[r.key]=r}}function Zt(a){U(a.a,(function(b,t){this.a.hasOwnProperty(t)&&Ot(b)}),a),a.a={}}function te(){this.a=!0}function ee(a,b,t,e){a.info((function(){return"XMLHTTP TEXT ("+b+"): "+function(a,b){if(!a.a)return b;if(!b)return null;try{var t=JSON.parse(b);if(t)for(a=0;a<t.length;a++)if(Array.isArray(t[a])){var e=t[a];if(!(2>e.length)){var n=e[1];if(Array.isArray(n)&&!(1>n.length)){var r=n[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var g=1;g<n.length;g++)n[g]=""}}}return Rt(t)}catch(t){return b}}(a,t)+(e?" "+e:"")}))}Jt.prototype.G=function(){Jt.X.G.call(this),Zt(this)},Jt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},te.prototype.info=function(){};var ne={},re=null;function ie(){return re=re||new xt}function oe(a){ct.call(this,ne.Fa,a)}function se(a){var b=ie();Dt(b,new oe(b,a))}function ue(a,b){ct.call(this,ne.STAT_EVENT,a),this.stat=b}function ae(a){var b=ie();Dt(b,new ue(b,a))}function ce(a){ct.call(this,ne.Ga,a)}function he(a,b){if("function"!=typeof a)throw Error("Fn must not be null and must be a function");return l.setTimeout((function(){a()}),b)}ne.Fa="serverreachability",O(oe,ct),ne.STAT_EVENT="statevent",O(ue,ct),ne.Ga="timingevent",O(ce,ct);var fe={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},le={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function pe(){}function de(a){var b;return(b=a.a)||(b=a.a={}),b}function ve(){}pe.prototype.a=null;var ye,ge={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function me(){ct.call(this,"d")}function be(){ct.call(this,"c")}function we(){}function Ie(a,b,t,e){this.g=a,this.c=b,this.f=t,this.S=e||1,this.J=new Jt(this),this.P=Ee,a=W?125:void 0,this.R=new Kt(a),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}O(me,ct),O(be,ct),O(we,pe),ye=new we;var Ee=45e3,_e={},Oe={};function Te(a,b,t){a.H=1,a.i=We(qe(b)),a.j=t,a.I=!0,Ae(a,null)}function Ae(a,b){a.u=q(),Se(a),a.l=qe(a.i);var t=a.l,e=a.S;Array.isArray(e)||(e=[String(e)]),sn(t.b,"t",e),a.D=0,a.a=Zn(a.g,a.g.C?b:null),0<a.O&&(a.F=new Qt(p(a.Ca,a,a.a),a.O)),$t(a.J,a.a,"readystatechange",a.Xa),b=a.B?V(a.B):{},a.j?(a.m||(a.m="POST"),b["Content-Type"]="application/x-www-form-urlencoded",a.a.ba(a.l,a.m,a.j,b)):(a.m="GET",a.a.ba(a.l,a.m,null,b)),se(1),function(a,b,t,e,n,r){a.info((function(){if(a.a)if(r)for(var g="",o=r.split("&"),c=0;c<o.length;c++){var u=o[c].split("=");if(1<u.length){var h=u[0];u=u[1];var f=h.split("_");g=2<=f.length&&"type"==f[1]?g+(h+"=")+u+"&":g+(h+"=redacted&")}}else g=null;else g=r;return"XMLHTTP REQ ("+e+") [attempt "+n+"]: "+b+"\n"+t+"\n"+g}))}(a.c,a.m,a.l,a.f,a.S,a.j)}function je(a,b,t){for(var e=!0;!a.A&&a.D<t.length;){var n=Ne(a,t);if(n==Oe){4==b&&(a.h=4,ae(14),e=!1),ee(a.c,a.f,null,"[Incomplete Response]");break}if(n==_e){a.h=4,ae(15),ee(a.c,a.f,t,"[Invalid Chunk]"),e=!1;break}ee(a.c,a.f,n,null),Re(a,n)}4==b&&0==t.length&&(a.h=1,ae(16),e=!1),a.b=a.b&&e,e?0<t.length&&!a.V&&(a.V=!0,(b=a.g).a==a&&b.U&&!b.F&&(b.c.info("Great, no buffering proxy detected. Bytes received: "+t.length),Kn(b),b.F=!0,ae(11))):(ee(a.c,a.f,t,"[Invalid Chunked Response]"),Pe(a),De(a))}function Ne(a,b){var t=a.D,e=b.indexOf("\n",t);return-1==e?Oe:(t=Number(b.substring(t,e)),isNaN(t)?_e:(e+=1)+t>b.length?Oe:(b=b.substr(e,t),a.D=e+t,b))}function Se(a){a.T=q()+a.P,ke(a,a.P)}function ke(a,b){if(null!=a.o)throw Error("WatchDog timer not null");a.o=he(p(a.Va,a),b)}function xe(a){a.o&&(l.clearTimeout(a.o),a.o=null)}function De(a){0==a.g.v||a.A||Yn(a.g,a)}function Pe(a){xe(a);var b=a.F;b&&"function"==typeof b.ja&&b.ja(),a.F=null,Ht(a.R),Zt(a.J),a.a&&(b=a.a,a.a=null,b.abort(),b.ja())}function Re(a,b){try{var t=a.g;if(0!=t.v&&(t.a==a||pn(t.b,a)))if(t.I=a.N,!a.C&&pn(t.b,a)&&3==t.v){try{var e=t.ka.a.parse(b)}catch(t){e=null}if(Array.isArray(e)&&3==e.length){var n=e;if(0==n[0]){t:if(!t.j){if(t.a){if(!(t.a.u+3e3<a.u))break t;Wn(t),Ln(t)}zn(t),ae(18)}}else t.oa=n[1],0<t.oa-t.P&&37500>n[2]&&t.H&&0==t.o&&!t.m&&(t.m=he(p(t.Sa,t),6e3));if(1>=ln(t.b)&&t.ea){try{t.ea()}catch(t){}t.ea=void 0}}else Jn(t,11)}else if((a.C||t.a==a)&&Wn(t),!k(b))for(b=e=t.ka.a.parse(b),e=0;e<b.length;e++)if(n=b[e],t.P=n[0],n=n[1],2==t.v)if("c"==n[0]){t.J=n[1],t.ga=n[2];var r=n[3];null!=r&&(t.ha=r,t.c.info("VER="+t.ha));var g=n[4];null!=g&&(t.pa=g,t.c.info("SVER="+t.pa));var o=n[5];if(null!=o&&"number"==typeof o&&0<o){var c=1.5*o;t.D=c,t.c.info("backChannelRequestTimeoutMs_="+c)}c=t;var u=a.a;if(u){var h=u.a?u.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var f=c.b;!f.a&&(P(h,"spdy")||P(h,"quic")||P(h,"h2"))&&(f.f=f.g,f.a=new Set,f.b&&(dn(f,f.b),f.b=null))}if(c.A){var l=u.a?u.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(c.na=l,He(c.B,c.A,l))}}t.v=3,t.f&&t.f.ta(),t.U&&(t.N=q()-a.u,t.c.info("Handshake RTT: "+t.N+"ms"));var d=a;if((c=t).la=$n(c,c.C?c.ga:null,c.fa),d.C){vn(c.b,d);var v=d,y=c.D;y&&v.setTimeout(y),v.o&&(xe(v),Se(v)),c.a=d}else Gn(c);0<t.g.length&&Mn(t)}else"stop"!=n[0]&&"close"!=n[0]||Jn(t,7);else 3==t.v&&("stop"==n[0]||"close"==n[0]?"stop"==n[0]?Jn(t,7):Cn(t):"noop"!=n[0]&&t.f&&t.f.sa(n),t.o=0);se(4)}catch(t){}}function Ce(a,b){if(a.forEach&&"function"==typeof a.forEach)a.forEach(b,void 0);else if(v(a)||"string"==typeof a)j(a,b,void 0);else{if(a.L&&"function"==typeof a.L)var t=a.L();else if(a.K&&"function"==typeof a.K)t=void 0;else if(v(a)||"string"==typeof a){t=[];for(var e=a.length,n=0;n<e;n++)t.push(n)}else for(n in t=[],e=0,a)t[e++]=n;n=(e=function(a){if(a.K&&"function"==typeof a.K)return a.K();if("string"==typeof a)return a.split("");if(v(a)){for(var b=[],t=a.length,e=0;e<t;e++)b.push(a[e]);return b}for(e in b=[],t=0,a)b[t++]=a[e];return b}(a)).length;for(var r=0;r<n;r++)b.call(void 0,e[r],t&&t[r],a)}}function Le(a,b){this.b={},this.a=[],this.c=0;var t=arguments.length;if(1<t){if(t%2)throw Error("Uneven number of arguments");for(var e=0;e<t;e+=2)this.set(arguments[e],arguments[e+1])}else if(a)if(a instanceof Le)for(t=a.L(),e=0;e<t.length;e++)this.set(t[e],a.get(t[e]));else for(e in a)this.set(e,a[e])}function Ue(a){if(a.c!=a.a.length){for(var b=0,t=0;b<a.a.length;){var e=a.a[b];Ve(a.b,e)&&(a.a[t++]=e),b++}a.a.length=t}if(a.c!=a.a.length){var n={};for(t=b=0;b<a.a.length;)Ve(n,e=a.a[b])||(a.a[t++]=e,n[e]=1),b++;a.a.length=t}}function Ve(a,b){return Object.prototype.hasOwnProperty.call(a,b)}(c=Ie.prototype).setTimeout=function(a){this.P=a},c.Xa=function(a){a=a.target;var b=this.F;b&&3==xn(a)?b.f():this.Ca(a)},c.Ca=function(a){try{if(a==this.a)t:{var b=xn(this.a),t=this.a.ua(),e=this.a.W();if(!(3>b||3==b&&!W&&!this.a.$())){this.A||4!=b||7==t||se(8==t||0>=e?3:2),xe(this);var n=this.a.W();this.N=n;var r=this.a.$();if(this.b=200==n,function(a,b,t,e,n,r,g){a.info((function(){return"XMLHTTP RESP ("+e+") [ attempt "+n+"]: "+b+"\n"+t+"\n"+r+" "+g}))}(this.c,this.m,this.l,this.f,this.S,b,n),this.b){if(this.U&&!this.C){e:{if(this.a){var g,o=this.a;if((g=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(g)){var c=g;break e}}c=null}if(!c){this.b=!1,this.h=3,ae(12),Pe(this),De(this);break t}ee(this.c,this.f,c,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Re(this,c)}this.I?(je(this,b,r),W&&this.b&&3==b&&($t(this.J,this.R,"tick",this.Wa),this.R.start())):(ee(this.c,this.f,r,null),Re(this,r)),4==b&&Pe(this),this.b&&!this.A&&(4==b?Yn(this.g,this):(this.b=!1,Se(this)))}else 400==n&&0<r.indexOf("Unknown SID")?(this.h=3,ae(12)):(this.h=0,ae(13)),Pe(this),De(this)}}}catch(t){}},c.Wa=function(){if(this.a){var a=xn(this.a),b=this.a.$();this.D<b.length&&(xe(this),je(this,a,b),this.b&&4!=a&&Se(this))}},c.cancel=function(){this.A=!0,Pe(this)},c.Va=function(){this.o=null;var a=q();0<=a-this.T?(function(a,b){a.info((function(){return"TIMEOUT: "+b}))}(this.c,this.l),2!=this.H&&(se(3),ae(17)),Pe(this),this.h=2,De(this)):ke(this,this.T-a)},(c=Le.prototype).K=function(){Ue(this);for(var a=[],b=0;b<this.a.length;b++)a.push(this.b[this.a[b]]);return a},c.L=function(){return Ue(this),this.a.concat()},c.get=function(a,b){return Ve(this.b,a)?this.b[a]:b},c.set=function(a,b){Ve(this.b,a)||(this.c++,this.a.push(a)),this.b[a]=b},c.forEach=function(a,b){for(var t=this.L(),e=0;e<t.length;e++){var n=t[e],r=this.get(n);a.call(b,r,n,this)}};var Me=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Fe(a,b){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,a instanceof Fe){this.a=void 0!==b?b:a.a,Be(this,a.f),this.j=a.j,Ge(this,a.c),ze(this,a.h),this.g=a.g,b=a.b;var t=new en;t.c=b.c,b.a&&(t.a=new Le(b.a),t.b=b.b),Ke(this,t),this.i=a.i}else a&&(t=String(a).match(Me))?(this.a=!!b,Be(this,t[1]||"",!0),this.j=Ye(t[2]||""),Ge(this,t[3]||"",!0),ze(this,t[4]),this.g=Ye(t[5]||"",!0),Ke(this,t[6]||"",!0),this.i=Ye(t[7]||"")):(this.a=!!b,this.b=new en(null,this.a))}function qe(a){return new Fe(a)}function Be(a,b,t){a.f=t?Ye(b,!0):b,a.f&&(a.f=a.f.replace(/:$/,""))}function Ge(a,b,t){a.c=t?Ye(b,!0):b}function ze(a,b){if(b){if(b=Number(b),isNaN(b)||0>b)throw Error("Bad port number "+b);a.h=b}else a.h=null}function Ke(a,b,t){b instanceof en?(a.b=b,function(a,b){b&&!a.f&&(nn(a),a.c=null,a.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(rn(this,e),sn(this,n,t))}),a)),a.f=b}(a.b,a.a)):(t||(b=Qe(b,Ze)),a.b=new en(b,a.a))}function He(a,b,t){a.b.set(b,t)}function We(a){return He(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^q()).toString(36)),a}function Ye(a,b){return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Qe(a,b,t){return"string"==typeof a?(a=encodeURI(a).replace(b,dd),t&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function dd(a){return"%"+((a=a.charCodeAt(0))>>4&15).toString(16)+(15&a).toString(16)}Fe.prototype.toString=function(){var a=[],b=this.f;b&&a.push(Qe(b,Je,!0),":");var t=this.c;return(t||"file"==b)&&(a.push("//"),(b=this.j)&&a.push(Qe(b,Je,!0),"@"),a.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.h)&&a.push(":",String(t))),(t=this.g)&&(this.c&&"/"!=t.charAt(0)&&a.push("/"),a.push(Qe(t,"/"==t.charAt(0)?$e:Xe,!0))),(t=this.b.toString())&&a.push("?",t),(t=this.i)&&a.push("#",Qe(t,tn)),a.join("")};var Je=/[#\/\?@]/g,Xe=/[#\?:]/g,$e=/[#\?]/g,Ze=/[#\?@]/g,tn=/#/g;function en(a,b){this.b=this.a=null,this.c=a||null,this.f=!!b}function nn(a){a.a||(a.a=new Le,a.b=0,a.c&&function(a,b){if(a){a=a.split("&");for(var t=0;t<a.length;t++){var e=a[t].indexOf("="),n=null;if(0<=e){var r=a[t].substring(0,e);n=a[t].substring(e+1)}else r=a[t];b(r,n?decodeURIComponent(n.replace(/\+/g," ")):"")}}}(a.c,(function(b,t){a.add(decodeURIComponent(b.replace(/\+/g," ")),t)})))}function rn(a,b){nn(a),b=un(a,b),Ve(a.a.b,b)&&(a.c=null,a.b-=a.a.get(b).length,Ve((a=a.a).b,b)&&(delete a.b[b],a.c--,a.a.length>2*a.c&&Ue(a)))}function on(a,b){return nn(a),b=un(a,b),Ve(a.a.b,b)}function sn(a,b,t){rn(a,b),0<t.length&&(a.c=null,a.a.set(un(a,b),S(t)),a.b+=t.length)}function un(a,b){return b=String(b),a.f&&(b=b.toLowerCase()),b}(c=en.prototype).add=function(a,b){nn(this),this.c=null,a=un(this,a);var t=this.a.get(a);return t||this.a.set(a,t=[]),t.push(b),this.b+=1,this},c.forEach=function(a,b){nn(this),this.a.forEach((function(t,e){j(t,(function(t){a.call(b,t,e,this)}),this)}),this)},c.L=function(){nn(this);for(var a=this.a.K(),b=this.a.L(),t=[],e=0;e<b.length;e++)for(var n=a[e],r=0;r<n.length;r++)t.push(b[e]);return t},c.K=function(a){nn(this);var b=[];if("string"==typeof a)on(this,a)&&(b=N(b,this.a.get(un(this,a))));else{a=this.a.K();for(var t=0;t<a.length;t++)b=N(b,a[t])}return b},c.set=function(a,b){return nn(this),this.c=null,on(this,a=un(this,a))&&(this.b-=this.a.get(a).length),this.a.set(a,[b]),this.b+=1,this},c.get=function(a,b){return a&&0<(a=this.K(a)).length?String(a[0]):b},c.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var a=[],b=this.a.L(),t=0;t<b.length;t++){var e=b[t],n=encodeURIComponent(String(e));e=this.K(e);for(var r=0;r<e.length;r++){var g=n;""!==e[r]&&(g+="="+encodeURIComponent(String(e[r]))),a.push(g)}}return this.c=a.join("&")};var an=function(a,b){this.b=a,this.a=b};function cn(a){this.g=a||hn,l.PerformanceNavigationTiming?a=0<(a=l.performance.getEntriesByType("navigation")).length&&("hq"==a[0].nextHopProtocol||"h2"==a[0].nextHopProtocol):a=!!(l.ia&&l.ia.ya&&l.ia.ya()&&l.ia.ya().Lb),this.f=a?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var hn=10;function fn(a){return!!a.b||!!a.a&&a.a.size>=a.f}function ln(a){return a.b?1:a.a?a.a.size:0}function pn(a,b){return a.b?a.b==b:!!a.a&&a.a.has(b)}function dn(a,b){a.a?a.a.add(b):a.b=b}function vn(a,b){a.b&&a.b==b?a.b=null:a.a&&a.a.has(b)&&a.a.delete(b)}function yn(a){var t,e;if(null!=a.b)return a.c.concat(a.b.s);if(null!=a.a&&0!==a.a.size){var b=a.c;try{for(var n=o(a.a.values()),r=n.next();!r.done;r=n.next()){var c=r.value;b=b.concat(c.s)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return b}return S(a.c)}function gn(){}function mn(){this.a=new gn}function bn(a,b,t){var e=t||"";try{Ce(a,(function(t,n){var g=t;y(t)&&(g=Rt(t)),b.push(e+n+"="+encodeURIComponent(g))}))}catch(t){throw b.push(e+"type="+encodeURIComponent("_badmap")),t}}function wn(a,b,t,e,n){try{b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null,n(e)}catch(t){}}cn.prototype.cancel=function(){var t,e;if(this.c=yn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=o(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},gn.prototype.stringify=function(a){return l.JSON.stringify(a,void 0)},gn.prototype.parse=function(a){return l.JSON.parse(a,void 0)};var In=l.JSON.parse;function En(a){xt.call(this),this.headers=new Le,this.H=a||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=_n,this.D=this.F=!1}O(En,xt);var _n="",On=/^https?$/i,td=["POST","PUT"];function Tn(a){return"content-type"==a.toLowerCase()}function An(a,b){a.b=!1,a.a&&(a.g=!0,a.a.abort(),a.g=!1),a.f=b,a.h=5,jn(a),Sn(a)}function jn(a){a.u||(a.u=!0,Dt(a,"complete"),Dt(a,"error"))}function Nn(a){if(a.b&&void 0!==f&&(!a.s[1]||4!=xn(a)||2!=a.W()))if(a.l&&4==xn(a))Wt(a.za,0,a);else if(Dt(a,"readystatechange"),4==xn(a)){a.b=!1;try{var t,e=a.W();t:switch(e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break t;default:b=!1}if(!(t=b)){var n;if(n=0===e){var r=String(a.B).match(Me)[1]||null;if(!r&&l.self&&l.self.location){var o=l.self.location.protocol;r=o.substr(0,o.length-1)}n=!On.test(r?r.toLowerCase():"")}t=n}if(t)Dt(a,"complete"),Dt(a,"success");else{a.h=6;try{var c=2<xn(a)?a.a.statusText:""}catch(e){c=""}a.f=c+" ["+a.W()+"]",jn(a)}}finally{Sn(a)}}}function Sn(a,b){if(a.a){kn(a);var t=a.a,e=a.s[0]?d:null;a.a=null,a.s=null,b||Dt(a,"ready");try{t.onreadystatechange=e}catch(t){}}}function kn(a){a.a&&a.D&&(a.a.ontimeout=null),a.m&&(l.clearTimeout(a.m),a.m=null)}function xn(a){return a.a?a.a.readyState:0}function Dn(a,b,t){t:{for(e in t){var e=!1;break t}e=!0}e||(t=function(a){var b="";return U(a,(function(t,e){b+=e,b+=":",b+=t,b+="\r\n"})),b}(t),"string"==typeof a?null!=t&&encodeURIComponent(String(t)):He(a,b,t))}function Pn(a,b,t){return t&&t.internalChannelParams&&t.internalChannelParams[a]||b}function Rn(a){this.pa=0,this.g=[],this.c=new te,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Pn("failFast",!1,a),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Pn("baseRetryDelayMs",5e3,a),this.Ra=Pn("retryDelaySeedMs",1e4,a),this.Ma=Pn("forwardChannelMaxRetries",2,a),this.ma=Pn("forwardChannelRequestTimeoutMs",2e4,a),this.Na=a&&a.g||void 0,this.D=void 0,this.C=a&&a.supportsCrossDomainXhr||!1,this.J="",this.b=new cn(a&&a.concurrentRequestLimit),this.ka=new mn,this.da=a&&a.fastHandshake||!1,this.Ia=a&&a.b||!1,a&&a.f&&(this.c.a=!1),a&&a.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&a&&a.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=a&&a.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Cn(a){if(Un(a),3==a.v){var b=a.R++,t=qe(a.B);He(t,"SID",a.J),He(t,"RID",b),He(t,"TYPE","terminate"),qn(a,t),(b=new Ie(a,a.c,b,void 0)).H=2,b.i=We(qe(t)),t=!1,l.navigator&&l.navigator.sendBeacon&&(t=l.navigator.sendBeacon(b.i.toString(),"")),!t&&l.Image&&((new Image).src=b.i,t=!0),t||(b.a=Zn(b.g,null),b.a.ba(b.i)),b.u=q(),Se(b)}Xn(a)}function Ln(a){a.a&&(Kn(a),a.a.cancel(),a.a=null)}function Un(a){Ln(a),a.j&&(l.clearTimeout(a.j),a.j=null),Wn(a),a.b.cancel(),a.h&&("number"==typeof a.h&&l.clearTimeout(a.h),a.h=null)}function Vn(a,b){a.g.push(new an(a.Oa++,b)),3==a.v&&Mn(a)}function Mn(a){fn(a.b)||a.h||(a.h=!0,qt(a.Ba,a),a.u=0)}function Fn(a,b){var t;t=b?b.f:a.R++;var e=qe(a.B);He(e,"SID",a.J),He(e,"RID",t),He(e,"AID",a.P),qn(a,e),a.i&&a.l&&Dn(e,a.i,a.l),t=new Ie(a,a.c,t,a.u+1),null===a.i&&(t.B=a.l),b&&(a.g=b.s.concat(a.g)),b=Bn(a,t,1e3),t.setTimeout(Math.round(.5*a.ma)+Math.round(.5*a.ma*Math.random())),dn(a.b,t),Te(t,e,b)}function qn(a,b){a.f&&Ce({},(function(t,e){He(b,e,t)}))}function Bn(a,b,t){t=Math.min(a.g.length,t);var e=a.f?p(a.f.Ja,a.f,a):null;t:for(var n=a.g,r=-1;;){var g=["count="+t];-1==r?0<t?(r=n[0].b,g.push("ofs="+r)):r=0:g.push("ofs="+r);for(var o=!0,c=0;c<t;c++){var u=n[c].b,h=n[c].a;if(0>(u-=r))r=Math.max(0,n[c].b-100),o=!1;else try{bn(h,g,"req"+u+"_")}catch(t){e&&e(h)}}if(o){e=g.join("&");break t}}return a=a.g.splice(0,t),b.s=a,e}function Gn(a){a.a||a.j||(a.T=1,qt(a.Aa,a),a.o=0)}function zn(a){return!(a.a||a.j||3<=a.o)&&(a.T++,a.j=he(p(a.Aa,a),Qn(a,a.o)),a.o++,!0)}function Kn(a){null!=a.s&&(l.clearTimeout(a.s),a.s=null)}function Hn(a){a.a=new Ie(a,a.c,"rpc",a.T),null===a.i&&(a.a.B=a.l),a.a.O=0;var b=qe(a.la);He(b,"RID","rpc"),He(b,"SID",a.J),He(b,"CI",a.H?"0":"1"),He(b,"AID",a.P),qn(a,b),He(b,"TYPE","xmlhttp"),a.i&&a.l&&Dn(b,a.i,a.l),a.D&&a.a.setTimeout(a.D);var t=a.a;a=a.ga,t.H=1,t.i=We(qe(b)),t.j=null,t.I=!0,Ae(t,a)}function Wn(a){null!=a.m&&(l.clearTimeout(a.m),a.m=null)}function Yn(a,b){var t=null;if(a.a==b){Wn(a),Kn(a),a.a=null;var e=2}else{if(!pn(a.b,b))return;t=b.s,vn(a.b,b),e=1}if(a.I=b.N,0!=a.v)if(b.b)if(1==e){t=b.j?b.j.length:0,b=q()-b.u;var n=a.u;Dt(e=ie(),new ce(e,t,b,n)),Mn(a)}else Gn(a);else if(3==(n=b.h)||0==n&&0<a.I||!(1==e&&function(a,b){return!(ln(a.b)>=a.b.f-(a.h?1:0))&&(a.h?(a.g=b.s.concat(a.g),!0):!(1==a.v||2==a.v||a.u>=(a.La?0:a.Ma))&&(a.h=he(p(a.Ba,a,b),Qn(a,a.u)),a.u++,!0))}(a,b)||2==e&&zn(a)))switch(t&&0<t.length&&(b=a.b,b.c=b.c.concat(t)),n){case 1:Jn(a,5);break;case 4:Jn(a,10);break;case 3:Jn(a,6);break;default:Jn(a,2)}}function Qn(a,b){var t=a.Ha+Math.floor(Math.random()*a.Ra);return a.f||(t*=2),t*b}function Jn(a,b){if(a.c.info("Error code "+b),2==b){var t=null;a.f&&(t=null);var e=p(a.Ya,a);t||(t=new Fe("//www.google.com/images/cleardot.gif"),l.location&&"http"==l.location.protocol||Be(t,"https"),We(t)),function(a,b){var t=new te;if(l.Image){var e=new Image;e.onload=_(wn,t,e,"TestLoadImage: loaded",!0,b),e.onerror=_(wn,t,e,"TestLoadImage: error",!1,b),e.onabort=_(wn,t,e,"TestLoadImage: abort",!1,b),e.ontimeout=_(wn,t,e,"TestLoadImage: timeout",!1,b),l.setTimeout((function(){e.ontimeout&&e.ontimeout()}),1e4),e.src=a}else b(!1)}(t.toString(),e)}else ae(2);a.v=0,a.f&&a.f.ra(b),Xn(a),Un(a)}function Xn(a){a.v=0,a.I=-1,a.f&&(0==yn(a.b).length&&0==a.g.length||(a.b.c.length=0,S(a.g),a.g.length=0),a.f.qa())}function $n(a,b,t){var e=function(a){return a instanceof Fe?qe(a):new Fe(a,void 0)}(t);if(""!=e.c)b&&Ge(e,b+"."+e.c),ze(e,e.h);else{var n=l.location;e=function(a,b,t,e){var n=new Fe(null,void 0);return a&&Be(n,a),b&&Ge(n,b),t&&ze(n,t),e&&(n.g=e),n}(n.protocol,b?b+"."+n.hostname:n.hostname,+n.port,t)}return a.V&&U(a.V,(function(t,g){He(e,g,t)})),b=a.A,t=a.na,b&&t&&He(e,b,t),He(e,"VER",a.ha),qn(a,e),e}function Zn(a,b){if(b&&!a.C)throw Error("Can't create secondary domain capable XhrIo object.");return(b=new En(a.Na)).F=a.C,b}function er(){}function nr(){if(K&&!(10<=Number(ot)))throw Error("Environmental error: no available transport.")}function rr(a,b){xt.call(this),this.a=new Rn(b),this.o=a,this.b=b&&b.messageUrlParams||null,a=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.a.l=a,a=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(a?a["X-WebChannel-Content-Type"]=b.messageContentType:a={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.a&&(a?a["X-WebChannel-Client-Profile"]=b.a:a={"X-WebChannel-Client-Profile":b.a}),this.a.O=a,(a=b&&b.httpHeadersOverwriteParam)&&!k(a)&&(this.a.i=a),this.m=b&&b.supportsCrossDomainXhr||!1,this.l=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!k(b)&&(this.a.A=b,null!==(a=this.b)&&b in a&&(b in(a=this.b)&&delete a[b])),this.f=new sr(this)}function ir(a){me.call(this);var b=a.__sm__;if(b){t:{for(var t in b){a=t;break t}a=void 0}(this.c=a)?(a=this.c,this.data=null!==b&&a in b?b[a]:void 0):this.data=b}else this.data=a}function or(){be.call(this),this.status=1}function sr(a){this.a=a}(c=En.prototype).ba=function(a,b,t,e){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+a);b=b?b.toUpperCase():"GET",this.B=a,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?de(this.H):de(ye),this.a.onreadystatechange=p(this.za,this);try{this.A=!0,this.a.open(b,String(a),!0),this.A=!1}catch(t){return void An(this,t)}a=t||"";var n=new Le(this.headers);e&&Ce(e,(function(t,g){n.set(g,t)})),e=function(a){t:{for(var b=Tn,t=a.length,e="string"==typeof a?a.split(""):a,n=0;n<t;n++)if(n in e&&b.call(void 0,e[n],n,a)){b=n;break t}b=-1}return 0>b?null:"string"==typeof a?a.charAt(b):a[b]}(n.L()),t=l.FormData&&a instanceof l.FormData,!(0<=A(td,b))||e||t||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),n.forEach((function(t,g){this.a.setRequestHeader(g,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{kn(this),0<this.o&&((this.D=function(a){return K&&nt(9)&&"number"==typeof a.timeout&&void 0!==a.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=p(this.xa,this)):this.m=Wt(this.xa,this.o,this)),this.l=!0,this.a.send(a),this.l=!1}catch(t){An(this,t)}},c.xa=function(){void 0!==f&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Dt(this,"timeout"),this.abort(8))},c.abort=function(a){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=a||7,Dt(this,"complete"),Dt(this,"abort"),Sn(this))},c.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Sn(this,!0)),En.X.G.call(this)},c.za=function(){this.j||(this.A||this.l||this.g?Nn(this):this.Ua())},c.Ua=function(){Nn(this)},c.W=function(){try{return 2<xn(this)?this.a.status:-1}catch(t){return-1}},c.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},c.Pa=function(a){if(this.a){var b=this.a.responseText;return a&&0==b.indexOf(a)&&(b=b.substring(a.length)),In(b)}},c.ua=function(){return this.h},c.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(c=Rn.prototype).ha=8,c.v=1,c.Ba=function(a){if(this.h)if(this.h=null,1==this.v){if(!a){this.R=Math.floor(1e5*Math.random()),a=this.R++;var t,b=new Ie(this,this.c,a,void 0),e=this.l;if(this.O&&(e?F(e=V(e),this.O):e=this.O),null===this.i&&(b.B=e),this.da)t:{for(var n=t=0;n<this.g.length;n++){var r=this.g[n];if(void 0===(r="__data__"in r.a&&"string"==typeof(r=r.a.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break t}if(4096===t||n===this.g.length-1){t=n+1;break t}}t=1e3}else t=1e3;t=Bn(this,b,t),He(n=qe(this.B),"RID",a),He(n,"CVER",22),this.A&&He(n,"X-HTTP-Session-Id",this.A),qn(this,n),this.i&&e&&Dn(n,this.i,e),dn(this.b,b),this.Ia&&He(n,"TYPE","init"),this.da?(He(n,"$req",t),He(n,"SID","null"),b.U=!0,Te(b,n,null)):Te(b,n,t),this.v=2}}else 3==this.v&&(a?Fn(this,a):0==this.g.length||fn(this.b)||Fn(this))},c.Aa=function(){if(this.j=null,Hn(this),this.U&&!(this.F||null==this.a||0>=this.N)){var a=2*this.N;this.c.info("BP detection timer enabled: "+a),this.s=he(p(this.Ta,this),a)}},c.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,ae(10),Ln(this),Hn(this))},c.Sa=function(){null!=this.m&&(this.m=null,Ln(this),zn(this),ae(19))},c.Ya=function(a){a?(this.c.info("Successfully pinged google.com"),ae(2)):(this.c.info("Failed to ping google.com"),ae(1))},(c=er.prototype).ta=function(){},c.sa=function(){},c.ra=function(){},c.qa=function(){},c.Ja=function(){},nr.prototype.a=function(a,b){return new rr(a,b)},O(rr,xt),rr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var a=this.a,b=this.o,t=this.b||void 0;ae(0),a.fa=b,a.V=t||{},a.H=a.S,a.B=$n(a,null,a.fa),Mn(a)},rr.prototype.close=function(){Cn(this.a)},rr.prototype.h=function(a){if("string"==typeof a){var b={};b.__data__=a,Vn(this.a,b)}else this.l?((b={}).__data__=Rt(a),Vn(this.a,b)):Vn(this.a,a)},rr.prototype.G=function(){this.a.f=null,delete this.f,Cn(this.a),delete this.a,rr.X.G.call(this)},O(ir,me),O(or,be),O(sr,er),sr.prototype.ta=function(){Dt(this.a,"a")},sr.prototype.sa=function(a){Dt(this.a,new ir(a))},sr.prototype.ra=function(a){Dt(this.a,new or(a))},sr.prototype.qa=function(){Dt(this.a,"b")},nr.prototype.createWebChannel=nr.prototype.a,rr.prototype.send=rr.prototype.h,rr.prototype.open=rr.prototype.g,rr.prototype.close=rr.prototype.close,fe.NO_ERROR=0,fe.TIMEOUT=8,fe.HTTP_ERROR=6,le.COMPLETE="complete",ve.EventType=ge,ge.OPEN="a",ge.CLOSE="b",ge.ERROR="c",ge.MESSAGE="d",xt.prototype.listen=xt.prototype.va,En.prototype.listenOnce=En.prototype.wa,En.prototype.getLastError=En.prototype.Qa,En.prototype.getLastErrorCode=En.prototype.ua,En.prototype.getStatus=En.prototype.W,En.prototype.getResponseJson=En.prototype.Pa,En.prototype.getResponseText=En.prototype.$,En.prototype.send=En.prototype.ba;var ur=function(){return new nr},ar=function(){return ie()},cr=fe,fr=le,lr=ne,pr={gb:0,jb:1,kb:2,Db:3,Ib:4,Fb:5,Gb:6,Eb:7,Cb:8,Hb:9,PROXY:10,NOPROXY:11,Ab:12,wb:13,xb:14,vb:15,yb:16,zb:17,bb:18,ab:19,cb:20},dr=ve,vr=En}).call(this,n(46))},800:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return c})),n.d(e,"c",(function(){return h})),n.d(e,"d",(function(){return f}));var r=function(t,b){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,b){t.__proto__=b}||function(t,b){for(var p in b)b.hasOwnProperty(p)&&(t[p]=b[p])})(t,b)};function o(t,b){function e(){this.constructor=t}r(t,b),t.prototype=null===b?Object.create(b):(e.prototype=b.prototype,new e)}function c(t,e,n,r){return new(n||(n=Promise))((function(o,c){function h(t){try{l(r.next(t))}catch(t){c(t)}}function f(t){try{l(r.throw(t))}catch(t){c(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(h,f)}l((r=r.apply(t,e||[])).next())}))}function h(t,body){var e,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(h){return function(c){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(t,o)}catch(t){c=[6,t],n=0}finally{e=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,h])}}}function f(){for(var s=0,i=0,t=arguments.length;i<t;i++)s+=arguments[i].length;var e=Array(s),n=0;for(i=0;i<t;i++)for(var a=arguments[i],r=0,o=a.length;r<o;r++,n++)e[n]=a[r];return e}},819:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return vc})),n.d(e,"b",(function(){return lc})),n.d(e,"c",(function(){return R})),n.d(e,"d",(function(){return hc})),n.d(e,"e",(function(){return pc})),n.d(e,"f",(function(){return wc})),n.d(e,"g",(function(){return bc})),n.d(e,"h",(function(){return Ta})),n.d(e,"i",(function(){return Ic})),n.d(e,"j",(function(){return Oc})),n.d(e,"k",(function(){return Oa})),n.d(e,"l",(function(){return _c})),n.d(e,"m",(function(){return Ac})),n.d(e,"n",(function(){return dc})),n.d(e,"o",(function(){return Lu})),n.d(e,"p",(function(){return nt})),n.d(e,"q",(function(){return cc})),n.d(e,"r",(function(){return jc}));var r=n(792),o=n(779),c=n(799),h=n(800),f=new r.b("@firebase/firestore");function l(){return f.logLevel}function d(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(f.logLevel<=r.a.DEBUG){var i=e.map(m);f.debug.apply(f,Object(h.d)(["Firestore (8.2.0): "+t],i))}}function v(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(f.logLevel<=r.a.ERROR){var i=e.map(m);f.error.apply(f,Object(h.d)(["Firestore (8.2.0): "+t],i))}}function y(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(f.logLevel<=r.a.WARN){var i=e.map(m);f.warn.apply(f,Object(h.d)(["Firestore (8.2.0): "+t],i))}}function m(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function w(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.2.0) INTERNAL ASSERTION FAILED: "+t;throw v(e),new Error(e)}function I(t,e){t||w()}function E(t,e){return t}function _(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var O=function(){function t(){}return t.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=_(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function T(t,e){return t<e?-1:t>e?1:0}function A(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function j(t){return t+"\0"}var N=function(){function t(t){this.i=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.i,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},t.prototype.o=function(){return 2*this.i.length},t.prototype.u=function(t){return T(this.i,t.i)},t.prototype.isEqual=function(t){return this.i===t.i},t}();N.h=new N("");var S={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},k=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(h.b)(e,t),e}(Error),x=function(){function t(t){this.l=t}return t.fromBase64String=function(e){try{return new t(N.fromBase64String(e))}catch(e){throw new k(S.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(N.fromUint8Array(e))},t.prototype.toBase64=function(){return this.l.toBase64()},t.prototype.toUint8Array=function(){return this.l.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.l.isEqual(t.l)},t}(),q=function(t){this._=t};function D(){if("undefined"==typeof Uint8Array)throw new k(S.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function P(){if("undefined"==typeof atob)throw new k(S.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.b)(e,t),e.fromBase64String=function(t){return P(),new e(x.fromBase64String(t))},e.fromUint8Array=function(t){return D(),new e(x.fromUint8Array(t))},e.prototype.toBase64=function(){return P(),this._.toBase64()},e.prototype.toUint8Array=function(){return D(),this._.toUint8Array()},e.prototype.isEqual=function(t){return this._.isEqual(t._)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(q),C=function(){function t(t){this.uid=t}return t.prototype.T=function(){return null!=this.uid},t.prototype.I=function(){return this.T()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();C.UNAUTHENTICATED=new C(null),C.m=new C("google-credentials-uid"),C.A=new C("first-party-uid");var L=function(t,e){this.user=e,this.type="OAuth",this.R={},this.R.Authorization="Bearer "+t},U=function(){function t(){this.P=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.g=function(){},t.prototype.V=function(t){this.P=t,t(C.UNAUTHENTICATED)},t.prototype.p=function(){this.P=null},t}(),V=function(){function t(t){var e=this;this.v=null,this.currentUser=C.UNAUTHENTICATED,this.S=!1,this.D=0,this.P=null,this.forceRefresh=!1,this.v=function(){e.D++,e.currentUser=e.C(),e.S=!0,e.P&&e.P(e.currentUser)},this.D=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.v):(this.v(null),t.get().then((function(t){e.auth=t,e.v&&e.auth.addAuthTokenListener(e.v)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.D,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.D!==e?(d("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(I("string"==typeof n.accessToken),new L(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.g=function(){this.forceRefresh=!0},t.prototype.V=function(t){this.P=t,this.S&&t(this.currentUser)},t.prototype.p=function(){this.auth&&this.auth.removeAuthTokenListener(this.v),this.v=null,this.P=null},t.prototype.C=function(){var t=this.auth&&this.auth.getUid();return I(null===t||"string"==typeof t),new C(t)},t}(),M=function(){function t(t,e){this.N=t,this.F=e,this.type="FirstParty",this.user=C.A}return Object.defineProperty(t.prototype,"R",{get:function(){var t={"X-Goog-AuthUser":this.F},e=this.N.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),F=function(){function t(t,e){this.N=t,this.F=e}return t.prototype.getToken=function(){return Promise.resolve(new M(this.N,this.F))},t.prototype.V=function(t){t(C.A)},t.prototype.p=function(){},t.prototype.g=function(){},t}(),B=function(t,e,n,r,i,o){this.O=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.k=o},G=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"M",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),z=function(){function t(){}return t.prototype.L=function(t){},t.prototype.$=function(){},t}(),K=function(){function t(){var t=this;this.B=function(){return t.q()},this.U=function(){return t.K()},this.W=[],this.j()}return t.prototype.L=function(t){this.W.push(t)},t.prototype.$=function(){window.removeEventListener("online",this.B),window.removeEventListener("offline",this.U)},t.prototype.j=function(){window.addEventListener("online",this.B),window.addEventListener("offline",this.U)},t.prototype.q=function(){d("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.W;t<e.length;t++)(0,e[t])(0)},t.prototype.K=function(){d("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.W;t<e.length;t++)(0,e[t])(1)},t.G=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}();function H(t){return null==t}function W(t){return 0===t&&1/t==-1/0}function Y(t){return"number"==typeof t&&Number.isInteger(t)&&!W(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Q,rt,J={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};function X(t){switch(t){case S.OK:return w();case S.CANCELLED:case S.UNKNOWN:case S.DEADLINE_EXCEEDED:case S.RESOURCE_EXHAUSTED:case S.INTERNAL:case S.UNAVAILABLE:case S.UNAUTHENTICATED:return!1;case S.INVALID_ARGUMENT:case S.NOT_FOUND:case S.ALREADY_EXISTS:case S.PERMISSION_DENIED:case S.FAILED_PRECONDITION:case S.ABORTED:case S.OUT_OF_RANGE:case S.UNIMPLEMENTED:case S.DATA_LOSS:return!0;default:return w()}}function $(t){if(void 0===t)return v("GRPC error has no .code"),S.UNKNOWN;switch(t){case Q.OK:return S.OK;case Q.CANCELLED:return S.CANCELLED;case Q.UNKNOWN:return S.UNKNOWN;case Q.DEADLINE_EXCEEDED:return S.DEADLINE_EXCEEDED;case Q.RESOURCE_EXHAUSTED:return S.RESOURCE_EXHAUSTED;case Q.INTERNAL:return S.INTERNAL;case Q.UNAVAILABLE:return S.UNAVAILABLE;case Q.UNAUTHENTICATED:return S.UNAUTHENTICATED;case Q.INVALID_ARGUMENT:return S.INVALID_ARGUMENT;case Q.NOT_FOUND:return S.NOT_FOUND;case Q.ALREADY_EXISTS:return S.ALREADY_EXISTS;case Q.PERMISSION_DENIED:return S.PERMISSION_DENIED;case Q.FAILED_PRECONDITION:return S.FAILED_PRECONDITION;case Q.ABORTED:return S.ABORTED;case Q.OUT_OF_RANGE:return S.OUT_OF_RANGE;case Q.UNIMPLEMENTED:return S.UNIMPLEMENTED;case Q.DATA_LOSS:return S.DATA_LOSS;default:return w()}}(rt=Q||(Q={}))[rt.OK=0]="OK",rt[rt.CANCELLED=1]="CANCELLED",rt[rt.UNKNOWN=2]="UNKNOWN",rt[rt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",rt[rt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",rt[rt.NOT_FOUND=5]="NOT_FOUND",rt[rt.ALREADY_EXISTS=6]="ALREADY_EXISTS",rt[rt.PERMISSION_DENIED=7]="PERMISSION_DENIED",rt[rt.UNAUTHENTICATED=16]="UNAUTHENTICATED",rt[rt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",rt[rt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",rt[rt.ABORTED=10]="ABORTED",rt[rt.OUT_OF_RANGE=11]="OUT_OF_RANGE",rt[rt.UNIMPLEMENTED=12]="UNIMPLEMENTED",rt[rt.INTERNAL=13]="INTERNAL",rt[rt.UNAVAILABLE=14]="UNAVAILABLE",rt[rt.DATA_LOSS=15]="DATA_LOSS";var Z=function(){function t(t){this.H=t.H,this.J=t.J}return t.prototype.Y=function(t){this.X=t},t.prototype.Z=function(t){this.tt=t},t.prototype.onMessage=function(t){this.et=t},t.prototype.close=function(){this.J()},t.prototype.send=function(t){this.H(t)},t.prototype.nt=function(){this.X()},t.prototype.st=function(t){this.tt(t)},t.prototype.it=function(t){this.et(t)},t}(),tt=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},et=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.k=e.k,n}return Object(h.b)(e,t),e.prototype.lt=function(t,e,n,r){return new Promise((function(i,o){var u=new c.f;u.listenOnce(c.c.COMPLETE,(function(){try{switch(u.getLastErrorCode()){case c.a.NO_ERROR:var e=u.getResponseJson();d("Connection","XHR received:",JSON.stringify(e)),i(e);break;case c.a.TIMEOUT:d("Connection",'RPC "'+t+'" timed out'),o(new k(S.DEADLINE_EXCEEDED,"Request time out"));break;case c.a.HTTP_ERROR:var n=u.getStatus();if(d("Connection",'RPC "'+t+'" failed with status:',n,"response text:",u.getResponseText()),n>0){var r=u.getResponseJson().error;if(r&&r.status&&r.message){var s=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(S).indexOf(e)>=0?e:S.UNKNOWN}(r.status);o(new k(s,r.message))}else o(new k(S.UNKNOWN,"Server responded with status "+u.getStatus()))}else o(new k(S.UNAVAILABLE,"Connection failed."));break;default:w()}}finally{d("Connection",'RPC "'+t+'" completed.')}}));var s=JSON.stringify(r);u.send(e,"POST",s,n,15)}))},e.prototype.ft=function(t,e){var a=[this.ot,"/","google.firestore.v1.Firestore","/",t,"/channel"],n=Object(c.g)(),r=Object(c.h)(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.O.projectId+"/databases/"+this.O.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.k};this.ht(h.initMessageHeaders,e),Object(o.l)()||Object(o.n)()||Object(o.j)()||Object(o.k)()||Object(o.o)()||Object(o.i)()||(h.httpHeadersOverwriteParam="$httpHeaders");var f=a.join("");d("Connection","Creating WebChannel: "+f,h);var g=n.createWebChannel(f,h),l=!1,b=!1,v=new Z({H:function(t){b?d("Connection","Not sending because WebChannel is closed:",t):(l||(d("Connection","Opening WebChannel transport."),g.open(),l=!0),d("Connection","WebChannel sending:",t),g.send(t))},J:function(){return g.close()}}),m=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return m(g,c.e.EventType.OPEN,(function(){b||d("Connection","WebChannel transport opened.")})),m(g,c.e.EventType.CLOSE,(function(){b||(b=!0,d("Connection","WebChannel transport closed"),v.st())})),m(g,c.e.EventType.ERROR,(function(t){b||(b=!0,y("Connection","WebChannel transport errored:",t),v.st(new k(S.UNAVAILABLE,"The operation could not be completed")))})),m(g,c.e.EventType.MESSAGE,(function(t){var e;if(!b){var n=t.data[0];I(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){d("Connection","WebChannel received error:",i);var o=i.status,u=function(t){var e=Q[t];if(void 0!==e)return $(e)}(o),s=i.message;void 0===u&&(u=S.INTERNAL,s="Unknown error status: "+o+" with message "+i.message),b=!0,v.st(new k(u,s)),g.close()}else d("Connection","WebChannel received:",n),v.it(n)}})),m(r,c.b.STAT_EVENT,(function(t){t.stat===c.d.PROXY?d("Connection","Detected buffering proxy"):t.stat===c.d.NOPROXY&&d("Connection","Detected no buffering proxy")})),setTimeout((function(){v.nt()}),0),v},e}(function(){function t(t){this.rt=t,this.O=t.O;var e=t.ssl?"https":"http";this.ot=e+"://"+t.host,this.ct="projects/"+this.O.projectId+"/databases/"+this.O.database+"/documents"}return t.prototype.at=function(t,e,n,r){var i=this.ut(t,e);d("RestConnection","Sending: ",i,n);var o={};return this.ht(o,r),this.lt(t,i,o,n).then((function(t){return d("RestConnection","Received: ",t),t}),(function(e){throw y("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype._t=function(t,e,n,r){return this.at(t,e,n,r)},t.prototype.ht=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.0",t["Content-Type"]="text/plain",e)for(var n in e.R)e.R.hasOwnProperty(n)&&(t[n]=e.R[n])},t.prototype.ut=function(t,e){var n=J[t];return this.ot+"/v1/"+e+":"+n},t}()),nt=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new k(S.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new k(S.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new k(S.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new k(S.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.dt=function(t){return this.seconds===t.seconds?T(this.nanoseconds,t.nanoseconds):T(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),it=function(){function t(t){this.timestamp=t}return t.wt=function(e){return new t(e)},t.min=function(){return new t(new nt(0,0))},t.prototype.u=function(t){return this.timestamp.dt(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.Et=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.Tt=function(){return this.timestamp},t}(),ot=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&w(),void 0===n?n=t.length-e:n>t.length-e&&w(),this.segments=t,this.offset=e,this.It=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.It},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.At(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.Rt(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.Pt=function(t){return t=void 0===t?1:t,this.Rt(this.segments,this.offset+t,this.length-t)},t.prototype.yt=function(){return this.Rt(this.segments,this.offset,this.length-1)},t.prototype.gt=function(){return this.segments[this.offset]},t.prototype.Vt=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.bt=function(){return 0===this.length},t.prototype.vt=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.St=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.Dt=function(){return this.segments.slice(this.offset,this.limit())},t.At=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),st=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.b)(e,t),e.prototype.Rt=function(t,n,r){return new e(t,n,r)},e.prototype.Ct=function(){return this.Dt().join("/")},e.prototype.toString=function(){return this.Ct()},e.xt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var u=o[i];if(u.indexOf("//")>=0)throw new k(S.INVALID_ARGUMENT,"Invalid segment ("+u+"). Paths must not contain // in them.");r.push.apply(r,u.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.Nt=function(){return new e([])},e}(ot),dt=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ut=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.b)(e,t),e.prototype.Rt=function(t,n,r){return new e(t,n,r)},e.Ft=function(t){return dt.test(t)},e.prototype.Ct=function(){return this.Dt().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.Ft(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.Ct()},e.prototype.Ot=function(){return 1===this.length&&"__name__"===this.get(0)},e.kt=function(){return new e(["__name__"])},e.Mt=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new k(S.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},u=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new k(S.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new k(S.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===s?(u=!u,i++):"."!==s||u?(r+=s,i++):(o(),i++)}if(o(),u)throw new k(S.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.Nt=function(){return new e([])},e}(ot),at=function(){function t(t){this.path=t}return t.Lt=function(e){return new t(st.xt(e))},t.$t=function(e){return new t(st.xt(e).Pt(5))},t.prototype.Bt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===st.At(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.At=function(t,e){return st.At(t.path,e.path)},t.qt=function(t){return t.length%2==0},t.Ut=function(e){return new t(new st(e.slice()))},t}();function ct(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ht(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ft(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var lt=function(){function t(t){this.fields=t,t.sort(ut.At)}return t.prototype.Qt=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].vt(t))return!0;return!1},t.prototype.isEqual=function(t){return A(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),pt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vt(t){if(I(!!t),"string"==typeof t){var e=0,n=pt.exec(t);if(I(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:yt(t.seconds),nanos:yt(t.nanos)}}function yt(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function gt(t){return"string"==typeof t?N.fromBase64String(t):N.fromUint8Array(t)}function mt(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function bt(t){var e=vt(t.mapValue.fields.__local_write_time__.timestampValue);return new nt(e.seconds,e.nanos)}function wt(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?mt(t)?4:10:w()}function It(t,e){var n=wt(t);if(n!==wt(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return bt(t).isEqual(bt(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=vt(t.timestampValue),r=vt(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return gt(t.bytesValue).isEqual(gt(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return yt(t.geoPointValue.latitude)===yt(e.geoPointValue.latitude)&&yt(t.geoPointValue.longitude)===yt(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return yt(t.integerValue)===yt(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=yt(t.doubleValue),r=yt(e.doubleValue);return n===r?W(n)===W(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return A(t.arrayValue.values||[],e.arrayValue.values||[],It);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(ct(n)!==ct(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!It(n[i],r[i])))return!1;return!0}(t,e);default:return w()}}function Et(t,e){return void 0!==(t.values||[]).find((function(t){return It(t,e)}))}function _t(t,e){var n=wt(t),r=wt(e);if(n!==r)return T(n,r);switch(n){case 0:return 0;case 1:return T(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=yt(t.integerValue||t.doubleValue),r=yt(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Ot(t.timestampValue,e.timestampValue);case 4:return Ot(bt(t),bt(e));case 5:return T(t.stringValue,e.stringValue);case 6:return function(t,e){var n=gt(t),r=gt(e);return n.u(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=T(n[i],r[i]);if(0!==o)return o}return T(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=T(yt(t.latitude),yt(e.latitude));return 0!==n?n:T(yt(t.longitude),yt(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=_t(n[i],r[i]);if(o)return o}return T(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var u=0;u<r.length&&u<o.length;++u){var s=T(r[u],o[u]);if(0!==s)return s;var a=_t(n[r[u]],i[o[u]]);if(0!==a)return a}return T(r.length,o.length)}(t.mapValue,e.mapValue);default:throw w()}}function Ot(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return T(t,e);var n=vt(t),r=vt(e),i=T(n.seconds,r.seconds);return 0!==i?i:T(n.nanos,r.nanos)}function Tt(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){var e=vt(t);return"time("+e.seconds+","+e.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?gt(e.bytesValue).toBase64():"referenceValue"in e?(r=e.referenceValue,at.$t(r).toString()):"geoPointValue"in e?"geo("+(n=e.geoPointValue).latitude+","+n.longitude+")":"arrayValue"in e?function(e){for(var n="[",r=!0,o=0,i=e.values||[];o<i.length;o++)r?r=!1:n+=",",n+=t(i[o]);return n+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var n="{",r=!0,o=0,i=Object.keys(e.fields||{}).sort();o<i.length;o++){var c=i[o];r?r=!1:n+=",",n+=c+":"+t(e.fields[c])}return n+"}"}(e.mapValue):w();var n,r}(t)}function At(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.Ct()}}function jt(t){return!!t&&"integerValue"in t}function Nt(t){return!!t&&"arrayValue"in t}function St(t){return!!t&&"nullValue"in t}function kt(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function xt(t){return!!t&&"mapValue"in t}var Dt=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.bt())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!xt(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.Vt()])||null},t.prototype.isEqual=function(t){return It(this.proto,t.proto)},t}(),Pt=function(){function t(t){void 0===t&&(t=Dt.empty()),this.Kt=t,this.Wt=new Map}return t.prototype.set=function(t,e){return this.jt(t,e),this},t.prototype.delete=function(t){return this.jt(t,null),this},t.prototype.jt=function(t,e){for(var n=this.Wt,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===wt(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.Vt(),e)},t.prototype.Gt=function(){var t=this.zt(ut.Nt(),this.Wt);return null!=t?new Dt(t):this.Kt},t.prototype.zt=function(t,e){var n=this,r=!1,i=this.Kt.field(t),o=xt(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var u=n.zt(t.child(i),e);null!=u&&(o[i]=u,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},t}();function Rt(t){var e=[];return ht(t.fields||{},(function(t,n){var r=new ut([t]);if(xt(n)){var i=Rt(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,u=i;o<u.length;o++){var s=u[o];e.push(r.child(s))}}else e.push(r)})),new lt(e)}var Ct=function(t,e){this.key=t,this.version=e},Lt=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).Ht=r,o.Jt=!!i.Jt,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return Object(h.b)(e,t),e.prototype.field=function(t){return this.Ht.field(t)},e.prototype.data=function(){return this.Ht},e.prototype.Yt=function(){return this.Ht.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Jt===t.Jt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ht.isEqual(t.Ht)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Ht.toString()+", {hasLocalMutations: "+this.Jt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.Jt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(Ct),Ut=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return Object(h.b)(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Ct),Vt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.b)(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Ct),Mt=function(t,e,n,r,i,o,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=u,this.Xt=null};function Ft(t,e,n,r,i,o,u){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===u&&(u=null),new Mt(t,e,n,r,i,o,u)}function qt(t){var e=E(t);if(null===e.Xt){var n=e.path.Ct();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.Ct()+t.op.toString()+Tt(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.Ct()+t.dir}(t)})).join(","),H(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=te(e.startAt)),e.endAt&&(n+="|ub:",n+=te(e.endAt)),e.Xt=n}return e.Xt}function Bt(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!ne(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!It(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ie(t.startAt,e.startAt)&&ie(t.endAt,e.endAt)}function Gt(t){return at.qt(t.path)&&null===t.collectionGroup&&0===t.filters.length}var zt=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(h.b)(e,t),e.create=function(t,n,r){return t.Ot()?"in"===n||"not-in"===n?this.Zt(t,n,r):new Kt(t,n,r):"array-contains"===n?new Qt(t,r):"in"===n?new Jt(t,r):"not-in"===n?new Xt(t,r):"array-contains-any"===n?new $t(t,r):new e(t,n,r)},e.Zt=function(t,e,n){return"in"===e?new Ht(t,n):new Wt(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.te(_t(e,this.value)):null!==e&&wt(this.value)===wt(e)&&this.te(_t(e,this.value))},e.prototype.te=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return w()}},e.prototype.ee=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),Kt=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=at.$t(r.referenceValue),i}return Object(h.b)(e,t),e.prototype.matches=function(t){var e=at.At(t.key,this.key);return this.te(e)},e}(zt),Ht=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Yt("in",n),r}return Object(h.b)(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(zt),Wt=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Yt("not-in",n),r}return Object(h.b)(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(zt);function Yt(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return at.$t(t.referenceValue)}))}var Qt=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(h.b)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return Nt(e)&&Et(e.arrayValue,this.value)},e}(zt),Jt=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(h.b)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Et(this.value.arrayValue,e)},e}(zt),Xt=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(h.b)(e,t),e.prototype.matches=function(t){if(Et(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!Et(this.value.arrayValue,e)},e}(zt),$t=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(h.b)(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Nt(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return Et(e.value.arrayValue,t)}))},e}(zt),Zt=function(t,e){this.position=t,this.before=e};function te(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return Tt(t)})).join(",")}var ee=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function ne(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function re(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],u=t.position[i];if(r=o.field.Ot()?at.At(at.$t(u.referenceValue),n.key):_t(u,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ie(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!It(t.position[n],e.position[n]))return!1;return!0}var oe=function(t,e,n,r,i,o,u,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===u&&(u=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.ne=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=u,this.endAt=s,this.se=null,this.ie=null,this.startAt,this.endAt};function se(t,e,n,r,i,o,u,s){return new oe(t,e,n,r,i,o,u,s)}function ue(t){return new oe(t)}function ae(t){return!H(t.limit)&&"F"===t.limitType}function ce(t){return!H(t.limit)&&"L"===t.limitType}function he(t){return t.ne.length>0?t.ne[0].field:null}function fe(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.ee())return r.field}return null}function le(t){return null!==t.collectionGroup}function pe(t){var e=E(t);if(null===e.se){e.se=[];var n=fe(e),r=he(e);if(null!==n&&null===r)n.Ot()||e.se.push(new ee(n)),e.se.push(new ee(ut.kt(),"asc"));else{for(var i=!1,o=0,u=e.ne;o<u.length;o++){var s=u[o];e.se.push(s),s.field.Ot()&&(i=!0)}if(!i){var a=e.ne.length>0?e.ne[e.ne.length-1].dir:"asc";e.se.push(new ee(ut.kt(),a))}}}return e.se}function de(t){var e=E(t);if(!e.ie)if("F"===e.limitType)e.ie=Ft(e.path,e.collectionGroup,pe(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=pe(e);r<i.length;r++){var o=i[r],u="desc"===o.dir?"asc":"desc";n.push(new ee(o.field,u))}var s=e.endAt?new Zt(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Zt(e.startAt.position,!e.startAt.before):null;e.ie=Ft(e.path,e.collectionGroup,n,e.filters,e.limit,s,a)}return e.ie}function ve(t,e,n){return new oe(t.path,t.collectionGroup,t.ne.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ye(t,e){return Bt(de(t),de(e))&&t.limitType===e.limitType}function ge(t){return qt(de(t))+"|lt:"+t.limitType}function me(t){return"Query(target="+function(t){var e=t.path.Ct();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.Ct()+" "+e.op+" "+Tt(e.value);var e})).join(", ")+"]"),H(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.Ct()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+te(t.startAt)),t.endAt&&(e+=", endAt: "+te(t.endAt)),"Target("+e+")"}(de(t))+"; limitType="+t.limitType+")"}function be(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.Bt(t.collectionGroup)&&t.path.vt(n):at.qt(t.path)?t.path.isEqual(n):t.path.St(n)}(t,e)&&function(t,e){for(var n=0,r=t.ne;n<r.length;n++){var i=r[n];if(!i.field.Ot()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!re(t.startAt,pe(t),e)||t.endAt&&re(t.endAt,pe(t),e))}(t,e)}function we(t){return function(e,n){for(var r=!1,i=0,o=pe(t);i<o.length;i++){var u=o[i],s=Ie(u,e,n);if(0!==s)return s;r=r||u.field.Ot()}return 0}}function Ie(t,e,n){var r=t.field.Ot()?at.At(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?_t(r,i):w()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return w()}}var Ee=function(){function t(t,e,n,r,i,o,u){void 0===i&&(i=it.min()),void 0===o&&(o=it.min()),void 0===u&&(u=N.h),this.target=t,this.targetId=e,this.re=n,this.sequenceNumber=r,this.oe=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u}return t.prototype.ce=function(e){return new t(this.target,this.targetId,this.re,e,this.oe,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.ae=function(e,n){return new t(this.target,this.targetId,this.re,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.ue=function(e){return new t(this.target,this.targetId,this.re,this.sequenceNumber,this.oe,e,this.resumeToken)},t}();function _e(t,e){if(t.he){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:W(e)?"-0":e}}function Oe(t){return{integerValue:""+t}}function Te(t,e){return Y(e)?Oe(e):_e(t,e)}var Ae=function(){this.le=void 0};function je(t,e,n){return t instanceof ke?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof xe?De(t,e):t instanceof Pe?Re(t,e):function(t,e){var n=Se(t,e),r=Le(n)+Le(t._e);return jt(n)&&jt(t._e)?Oe(r):_e(t.fe,r)}(t,e)}function Ne(t,e,n){return t instanceof xe?De(t,e):t instanceof Pe?Re(t,e):n}function Se(t,e){return t instanceof Ce?jt(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var ke=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.b)(e,t),e}(Ae),xe=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(h.b)(e,t),e}(Ae);function De(t,e){for(var n=Ue(e),r=function(t){n.some((function(e){return It(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Pe=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(h.b)(e,t),e}(Ae);function Re(t,e){for(var n=Ue(e),r=function(t){n=n.filter((function(e){return!It(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Ce=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).fe=e,r._e=n,r}return Object(h.b)(e,t),e}(Ae);function Le(t){return yt(t.integerValue||t.doubleValue)}function Ue(t){return Nt(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Ve=function(t,e){this.field=t,this.transform=e},Me=function(t,e){this.version=t,this.transformResults=e},Fe=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.de=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"we",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function qe(t,e){return void 0!==t.updateTime?e instanceof Lt&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Lt}var Be=function(){};function Ge(t,e,n){return t instanceof Ye?function(t,e,n){var r=t.value;if(n.transformResults){var i=Xe(t.fieldTransforms,e,n.transformResults);r=Ze(t.fieldTransforms,r,i)}return new Lt(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Qe?function(t,e,n){if(!qe(t.Ee,e))return new Vt(t.key,n.version);var r=Je(t,e,n.transformResults?Xe(t.fieldTransforms,e,n.transformResults):[]);return new Lt(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new Ut(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function ze(t,e,n,r){return t instanceof Ye?function(t,e,n,r){if(!qe(t.Ee,e))return e;var i=t.value;if(t.fieldTransforms){var o=$e(t.fieldTransforms,n,e,r);i=Ze(t.fieldTransforms,i,o)}var u=We(e);return new Lt(t.key,u,i,{Jt:!0})}(t,e,r,n):t instanceof Qe?function(t,e,n,r){if(!qe(t.Ee,e))return e;var i=We(e),o=Je(t,e,$e(t.fieldTransforms,n,e,r));return new Lt(t.key,i,o,{Jt:!0})}(t,e,r,n):function(t,e){return qe(t.Ee,e)?new Ut(t.key,it.min()):e}(t,e)}function Ke(t,e){return void 0!==t.fieldTransforms?function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],u=e instanceof Lt?e.field(o.field):void 0,s=Se(o.transform,u||null);null!=s&&(n=null==n?(new Pt).set(o.field,s):n.set(o.field,s))}return n?n.Gt():null}(t.fieldTransforms,e):null}function He(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ee.isEqual(e.Ee)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&A(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof xe&&e instanceof xe||t instanceof Pe&&e instanceof Pe?A(t.elements,e.elements,It):t instanceof Ce&&e instanceof Ce?It(t._e,e._e):t instanceof ke&&e instanceof ke}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.Te.isEqual(e.Te))}function We(t){return t instanceof Lt?t.version:it.min()}var Ye=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.Ee=r,o.fieldTransforms=i,o.type=0,o}return Object(h.b)(e,t),e}(Be),Qe=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var u=this;return(u=t.call(this)||this).key=e,u.data=n,u.Te=r,u.Ee=i,u.fieldTransforms=o,u.type=1,u}return Object(h.b)(e,t),e}(Be);function Je(t,e,n){var r;return r=function(t,e){var n=new Pt(e);return t.Te.fields.forEach((function(e){if(!e.bt()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}})),n.Gt()}(t,r=e instanceof Lt?e.data():Dt.empty()),Ze(t.fieldTransforms,r,n)}function Xe(t,e,n){var r=[];I(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],u=o.transform,s=null;e instanceof Lt&&(s=e.field(o.field)),r.push(Ne(u,s,n[i]))}return r}function $e(t,e,n,r){for(var i=[],o=0,u=t;o<u.length;o++){var s=u[o],a=s.transform,c=null;n instanceof Lt&&(c=n.field(s.field)),null===c&&r instanceof Lt&&(c=r.field(s.field)),i.push(je(a,c,e))}return i}function Ze(t,e,n){for(var r=new Pt(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.Gt()}var tn=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Ee=n,r.type=2,r.fieldTransforms=[],r}return Object(h.b)(e,t),e}(Be),en=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Ee=n,r.type=3,r.fieldTransforms=[],r}return Object(h.b)(e,t),e}(Be),nn=function(t){this.count=t},rn=function(){function t(t,e){this.At=t,this.root=e||sn.EMPTY}return t.prototype.Ie=function(e,n){return new t(this.At,this.root.Ie(e,n,this.At).copy(null,null,sn.me,null,null))},t.prototype.remove=function(e){return new t(this.At,this.root.remove(e,this.At).copy(null,null,sn.me,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.bt();){var n=this.At(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.bt();){var r=this.At(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.bt=function(){return this.root.bt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.Ae=function(){return this.root.Ae()},t.prototype.Re=function(){return this.root.Re()},t.prototype.Pe=function(t){return this.root.Pe(t)},t.prototype.forEach=function(t){this.Pe((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.Pe((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.ye=function(t){return this.root.ye(t)},t.prototype.ge=function(){return new on(this.root,null,this.At,!1)},t.prototype.Ve=function(t){return new on(this.root,t,this.At,!1)},t.prototype.pe=function(){return new on(this.root,null,this.At,!0)},t.prototype.be=function(t){return new on(this.root,t,this.At,!0)},t}(),on=function(){function t(t,e,n,r){this.ve=r,this.Se=[];for(var i=1;!t.bt();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.ve?t.left:t.right;else{if(0===i){this.Se.push(t);break}this.Se.push(t),t=this.ve?t.right:t.left}}return t.prototype.De=function(){var t=this.Se.pop(),e={key:t.key,value:t.value};if(this.ve)for(t=t.left;!t.bt();)this.Se.push(t),t=t.right;else for(t=t.right;!t.bt();)this.Se.push(t),t=t.left;return e},t.prototype.Ce=function(){return this.Se.length>0},t.prototype.xe=function(){if(0===this.Se.length)return null;var t=this.Se[this.Se.length-1];return{key:t.key,value:t.value}},t}(),sn=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.bt=function(){return!1},t.prototype.Pe=function(t){return this.left.Pe(t)||t(this.key,this.value)||this.right.Pe(t)},t.prototype.ye=function(t){return this.right.ye(t)||t(this.key,this.value)||this.left.ye(t)},t.prototype.min=function(){return this.left.bt()?this:this.left.min()},t.prototype.Ae=function(){return this.min().key},t.prototype.Re=function(){return this.right.bt()?this.key:this.right.Re()},t.prototype.Ie=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Ie(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Ie(t,e,n))).Ne()},t.prototype.Fe=function(){if(this.left.bt())return t.EMPTY;var e=this;return e.left.Oe()||e.left.left.Oe()||(e=e.ke()),(e=e.copy(null,null,null,e.left.Fe(),null)).Ne()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.bt()||i.left.Oe()||i.left.left.Oe()||(i=i.ke()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.Oe()&&(i=i.Me()),i.right.bt()||i.right.Oe()||i.right.left.Oe()||(i=i.Le()),0===n(e,i.key)){if(i.right.bt())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.Fe())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.Ne()},t.prototype.Oe=function(){return this.color},t.prototype.Ne=function(){var t=this;return t.right.Oe()&&!t.left.Oe()&&(t=t.$e()),t.left.Oe()&&t.left.left.Oe()&&(t=t.Me()),t.left.Oe()&&t.right.Oe()&&(t=t.Be()),t},t.prototype.ke=function(){var t=this.Be();return t.right.left.Oe()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Me())).$e()).Be()),t},t.prototype.Le=function(){var t=this.Be();return t.left.left.Oe()&&(t=(t=t.Me()).Be()),t},t.prototype.$e=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.Me=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.Be=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.qe=function(){var t=this.Ue();return Math.pow(2,t)<=this.size+1},t.prototype.Ue=function(){if(this.Oe()&&this.left.Oe())throw w();if(this.right.Oe())throw w();var t=this.left.Ue();if(t!==this.right.Ue())throw w();return t+(this.Oe()?0:1)},t}();sn.EMPTY=null,sn.RED=!0,sn.me=!1,sn.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw w()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw w()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw w()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw w()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw w()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.Ie=function(t,e,n){return new sn(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.bt=function(){return!0},t.prototype.Pe=function(t){return!1},t.prototype.ye=function(t){return!1},t.prototype.Ae=function(){return null},t.prototype.Re=function(){return null},t.prototype.Oe=function(){return!1},t.prototype.qe=function(){return!0},t.prototype.Ue=function(){return 0},t}());var un=function(){function t(t){this.At=t,this.data=new rn(this.At)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.Ae()},t.prototype.last=function(){return this.data.Re()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.Pe((function(e,n){return t(e),!1}))},t.prototype.Qe=function(t,e){for(var n=this.data.Ve(t[0]);n.Ce();){var r=n.De();if(this.At(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Ke=function(t,e){var n;for(n=void 0!==e?this.data.Ve(e):this.data.ge();n.Ce();)if(!t(n.De().key))return},t.prototype.We=function(t){var e=this.data.Ve(t);return e.Ce()?e.De().key:null},t.prototype.ge=function(){return new an(this.data.ge())},t.prototype.Ve=function(t){return new an(this.data.Ve(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).Ie(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.bt=function(){return this.data.bt()},t.prototype.je=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.ge(),r=e.data.ge();n.Ce();){var i=n.De().key,o=r.De().key;if(0!==this.At(i,o))return!1}return!0},t.prototype.Dt=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.At);return n.data=e,n},t}(),an=function(){function t(t){this.Ge=t}return t.prototype.De=function(){return this.Ge.De().key},t.prototype.Ce=function(){return this.Ge.Ce()},t}(),cn=new rn(at.At);function hn(){return cn}function fn(){return hn()}var ln=new rn(at.At);function pn(){return ln}var dn=new rn(at.At);function vn(){return dn}var yn=new un(at.At);function gn(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=yn,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var mn=new un(T);function bn(){return mn}var wn=function(){function t(t){this.At=t?function(e,n){return t(e,n)||at.At(e.key,n.key)}:function(t,e){return at.At(t.key,e.key)},this.ze=pn(),this.He=new rn(this.At)}return t.Je=function(e){return new t(e.At)},t.prototype.has=function(t){return null!=this.ze.get(t)},t.prototype.get=function(t){return this.ze.get(t)},t.prototype.first=function(){return this.He.Ae()},t.prototype.last=function(){return this.He.Re()},t.prototype.bt=function(){return this.He.bt()},t.prototype.indexOf=function(t){var e=this.ze.get(t);return e?this.He.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.He.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.He.Pe((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.ze.Ie(t.key,t),e.He.Ie(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.ze.remove(t),this.He.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.He.ge(),r=e.He.ge();n.Ce();){var i=n.De().key,o=r.De().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.At=this.At,r.ze=e,r.He=n,r},t}(),In=function(){function t(){this.Ye=new rn(at.At)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Ye.get(e);n?0!==t.type&&3===n.type?this.Ye=this.Ye.Ie(e,t):3===t.type&&1!==n.type?this.Ye=this.Ye.Ie(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ye=this.Ye.Ie(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ye=this.Ye.Ie(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ye=this.Ye.remove(e):1===t.type&&2===n.type?this.Ye=this.Ye.Ie(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ye=this.Ye.Ie(e,{type:2,doc:t.doc}):w():this.Ye=this.Ye.Ie(e,t)},t.prototype.Xe=function(){var t=[];return this.Ye.Pe((function(e,n){t.push(n)})),t},t}(),En=function(){function t(t,e,n,r,i,o,u,s){this.query=t,this.docs=e,this.Ze=n,this.docChanges=r,this.tn=i,this.fromCache=o,this.en=u,this.nn=s}return t.sn=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,wn.Je(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.tn.bt()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.en===t.en&&this.tn.isEqual(t.tn)&&ye(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ze.isEqual(t.Ze)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),_n=function(){function t(t,e,n,r,i){this.oe=t,this.rn=e,this.on=n,this.cn=r,this.an=i}return t.un=function(e,n){var r=new Map;return r.set(e,On.hn(e,n)),new t(it.min(),r,bn(),hn(),gn())},t}(),On=function(){function t(t,e,n,r,i){this.resumeToken=t,this.ln=e,this._n=n,this.fn=r,this.dn=i}return t.hn=function(e,n){return new t(N.h,n,gn(),gn(),gn())},t}(),Tn=function(t,e,n,r){this.wn=t,this.removedTargetIds=e,this.key=n,this.En=r},An=function(t,e){this.targetId=t,this.Tn=e},jn=function(t,e,n,r){void 0===n&&(n=N.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Nn=function(){function t(){this.In=0,this.mn=xn(),this.An=N.h,this.Rn=!1,this.Pn=!0}return Object.defineProperty(t.prototype,"ln",{get:function(){return this.Rn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.An},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"yn",{get:function(){return 0!==this.In},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"gn",{get:function(){return this.Pn},enumerable:!1,configurable:!0}),t.prototype.Vn=function(t){t.o()>0&&(this.Pn=!0,this.An=t)},t.prototype.pn=function(){var t=gn(),e=gn(),n=gn();return this.mn.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:w()}})),new On(this.An,this.Rn,t,e,n)},t.prototype.bn=function(){this.Pn=!1,this.mn=xn()},t.prototype.vn=function(t,e){this.Pn=!0,this.mn=this.mn.Ie(t,e)},t.prototype.Sn=function(t){this.Pn=!0,this.mn=this.mn.remove(t)},t.prototype.Dn=function(){this.In+=1},t.prototype.Cn=function(){this.In-=1},t.prototype.xn=function(){this.Pn=!0,this.Rn=!0},t}(),Sn=function(){function t(t){this.Nn=t,this.Fn=new Map,this.On=hn(),this.kn=kn(),this.Mn=new un(T)}return t.prototype.Ln=function(t){for(var e=0,n=t.wn;e<n.length;e++){var r=n[e];t.En instanceof Lt?this.$n(r,t.En):t.En instanceof Ut&&this.Bn(r,t.key,t.En)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.Bn(r,t.key,t.En)},t.prototype.qn=function(t){var e=this;this.Un(t,(function(n){var r=e.Qn(n);switch(t.state){case 0:e.Kn(n)&&r.Vn(t.resumeToken);break;case 1:r.Cn(),r.yn||r.bn(),r.Vn(t.resumeToken);break;case 2:r.Cn(),r.yn||e.removeTarget(n);break;case 3:e.Kn(n)&&(r.xn(),r.Vn(t.resumeToken));break;case 4:e.Kn(n)&&(e.Wn(n),r.Vn(t.resumeToken));break;default:w()}}))},t.prototype.Un=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.Fn.forEach((function(t,r){n.Kn(r)&&e(r)}))},t.prototype.jn=function(t){var e=t.targetId,n=t.Tn.count,r=this.Gn(e);if(r){var i=r.target;if(Gt(i))if(0===n){var o=new at(i.path);this.Bn(e,o,new Ut(o,it.min()))}else I(1===n);else this.zn(e)!==n&&(this.Wn(e),this.Mn=this.Mn.add(e))}},t.prototype.Hn=function(t){var e=this,n=new Map;this.Fn.forEach((function(r,i){var o=e.Gn(i);if(o){if(r.ln&&Gt(o.target)){var u=new at(o.target.path);null!==e.On.get(u)||e.Jn(i,u)||e.Bn(i,u,new Ut(u,t))}r.gn&&(n.set(i,r.pn()),r.bn())}}));var r=gn();this.kn.forEach((function(t,n){var i=!0;n.Ke((function(t){var n=e.Gn(t);return!n||2===n.re||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new _n(t,n,this.Mn,this.On,r);return this.On=hn(),this.kn=kn(),this.Mn=new un(T),i},t.prototype.$n=function(t,e){if(this.Kn(t)){var n=this.Jn(t,e.key)?2:0;this.Qn(t).vn(e.key,n),this.On=this.On.Ie(e.key,e),this.kn=this.kn.Ie(e.key,this.Yn(e.key).add(t))}},t.prototype.Bn=function(t,e,n){if(this.Kn(t)){var r=this.Qn(t);this.Jn(t,e)?r.vn(e,1):r.Sn(e),this.kn=this.kn.Ie(e,this.Yn(e).delete(t)),n&&(this.On=this.On.Ie(e,n))}},t.prototype.removeTarget=function(t){this.Fn.delete(t)},t.prototype.zn=function(t){var e=this.Qn(t).pn();return this.Nn.Xn(t).size+e._n.size-e.dn.size},t.prototype.Dn=function(t){this.Qn(t).Dn()},t.prototype.Qn=function(t){var e=this.Fn.get(t);return e||(e=new Nn,this.Fn.set(t,e)),e},t.prototype.Yn=function(t){var e=this.kn.get(t);return e||(e=new un(T),this.kn=this.kn.Ie(t,e)),e},t.prototype.Kn=function(t){var e=null!==this.Gn(t);return e||d("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.Gn=function(t){var e=this.Fn.get(t);return e&&e.yn?null:this.Nn.Zn(t)},t.prototype.Wn=function(t){var e=this;this.Fn.set(t,new Nn),this.Nn.Xn(t).forEach((function(n){e.Bn(t,n,null)}))},t.prototype.Jn=function(t,e){return this.Nn.Xn(t).has(e)},t}();function kn(){return new rn(at.At)}function xn(){return new rn(at.At)}var Dn={asc:"ASCENDING",desc:"DESCENDING"},Pn={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Rn=function(t,e){this.O=t,this.he=e};function Cn(t,e){return t.he?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ln(t,e){return t.he?e.toBase64():e.toUint8Array()}function Un(t,e){return Cn(t,e.Tt())}function Vn(t){return I(!!t),it.wt(function(t){var e=vt(t);return new nt(e.seconds,e.nanos)}(t))}function Mn(t,e){return function(t){return new st(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).Ct()}function Fn(t){var e=st.xt(t);return I(ar(e)),e}function qn(t,e){return Mn(t.O,e.path)}function Bn(t,e){var n=Fn(e);if(n.get(1)!==t.O.projectId)throw new k(S.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.O.projectId);if(n.get(3)!==t.O.database)throw new k(S.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.O.database);return new at(Kn(n))}function Gn(t,e){return Mn(t.O,e)}function zn(t){var e=Fn(t);return 4===e.length?st.Nt():Kn(e)}function tr(t){return new st(["projects",t.O.projectId,"databases",t.O.database]).Ct()}function Kn(t){return I(t.length>4&&"documents"===t.get(4)),t.Pt(5)}function Hn(t,e,n){return{name:qn(t,e),fields:n.proto.mapValue.fields}}function Wn(t,e,n){var r=Bn(t,e.name),i=Vn(e.updateTime),o=new Dt({mapValue:{fields:e.fields}});return new Lt(r,i,o,{hasCommittedMutations:!!n})}function Yn(t,e){var n;if(e instanceof Ye)n={update:Hn(t,e.key,e.value)};else if(e instanceof tn)n={delete:qn(t,e.key)};else if(e instanceof Qe)n={update:Hn(t,e.key,e.data),updateMask:ur(e.Te)};else{if(!(e instanceof en))return w();n={verify:qn(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof ke)return{fieldPath:e.field.Ct(),setToServerValue:"REQUEST_TIME"};if(n instanceof xe)return{fieldPath:e.field.Ct(),appendMissingElements:{values:n.elements}};if(n instanceof Pe)return{fieldPath:e.field.Ct(),removeAllFromArray:{values:n.elements}};if(n instanceof Ce)return{fieldPath:e.field.Ct(),increment:n._e};throw w()}(0,t)}))),e.Ee.we||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Un(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:w()}(t,e.Ee)),n}function Qn(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Fe.updateTime(Vn(t.updateTime)):void 0!==t.exists?Fe.exists(t.exists):Fe.de()}(e.currentDocument):Fe.de(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)I("REQUEST_TIME"===e.setToServerValue),n=new ke;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new xe(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new Pe(i)}else"increment"in e?n=new Ce(t,e.increment):w();var o=ut.Mt(e.fieldPath);return new Ve(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=Bn(t,e.update.name),o=new Dt({mapValue:{fields:e.update.fields}});if(e.updateMask){var u=function(t){var e=t.fieldPaths||[];return new lt(e.map((function(t){return ut.Mt(t)})))}(e.updateMask);return new Qe(i,o,u,n,r)}return new Ye(i,o,n,r)}if(e.delete){var s=Bn(t,e.delete);return new tn(s,n)}if(e.verify){var a=Bn(t,e.verify);return new en(a,n)}return w()}function Jn(t,e){return{documents:[Gn(t,e.path)]}}function Xn(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Gn(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Gn(t,r.yt()),n.structuredQuery.from=[{collectionId:r.Vt()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(kt(t.value))return{unaryFilter:{field:rr(t.field),op:"IS_NAN"}};if(St(t.value))return{unaryFilter:{field:rr(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(kt(t.value))return{unaryFilter:{field:rr(t.field),op:"IS_NOT_NAN"}};if(St(t.value))return{unaryFilter:{field:rr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:rr(t.field),op:nr(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:rr(t.field),direction:er(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var u=function(t,e){return t.he||H(e)?e:{value:e}}(t,e.limit);return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=Zn(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Zn(e.endAt)),n}function $n(t){var e=zn(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){I(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var u=[];n.where&&(u=function t(e){return e?void 0!==e.unaryFilter?[sr(e)]:void 0!==e.fieldFilter?[or(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return t(e)})).reduce((function(t,e){return t.concat(e)})):w():[]}(n.where));var s=[];n.orderBy&&(s=n.orderBy.map((function(t){return function(t){return new ee(ir(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var a=null;n.limit&&(a=function(t){var e;return H(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=hr(n.startAt));var h=null;return n.endAt&&(h=hr(n.endAt)),se(e,i,s,u,a,"F",c,h)}function Zn(t){return{before:t.before,values:t.position}}function hr(t){var e=!!t.before,n=t.values||[];return new Zt(n,e)}function er(t){return Dn[t]}function nr(t){return Pn[t]}function rr(t){return{fieldPath:t.Ct()}}function ir(t){return ut.Mt(t.fieldPath)}function or(t){return zt.create(ir(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return w()}}(t.fieldFilter.op),t.fieldFilter.value)}function sr(t){switch(t.unaryFilter.op){case"IS_NAN":var e=ir(t.unaryFilter.field);return zt.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=ir(t.unaryFilter.field);return zt.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=ir(t.unaryFilter.field);return zt.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=ir(t.unaryFilter.field);return zt.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return w()}}function ur(t){var e=[];return t.fields.forEach((function(t){return e.push(t.Ct())})),{fieldPaths:e}}function ar(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function br(t){return new Rn(t,!0)}var cr=function(){function t(t){var e=this;this.ts=null,this.es=null,this.result=void 0,this.error=void 0,this.ns=!1,this.ss=!1,t((function(t){e.ns=!0,e.result=t,e.ts&&e.ts(t)}),(function(t){e.ns=!0,e.error=t,e.es&&e.es(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.ss&&w(),this.ss=!0,this.ns?this.error?this.rs(n,this.error):this.os(e,this.result):new t((function(t,i){r.ts=function(n){r.os(e,n).next(t,i)},r.es=function(e){r.rs(n,e).next(t,i)}}))},t.prototype.cs=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.us=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.os=function(e,n){return e?this.us((function(){return e(n)})):t.resolve(n)},t.prototype.rs=function(e,n){return e?this.us((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.hs=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.ls=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.hs(r)},t}(),fr=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this._s=new tt,this.transaction.oncomplete=function(){n._s.resolve()},this.transaction.onabort=function(){e.error?n._s.reject(new dr(t,e.error)):n._s.resolve()},this.transaction.onerror=function(e){var r=wr(e.target.error);n._s.reject(new dr(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new dr(n,e)}},Object.defineProperty(t.prototype,"fs",{get:function(){return this._s.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this._s.reject(t),this.aborted||(d("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new yr(e)},t}(),lr=function(){function e(t,n,r){this.name=t,this.version=n,this.ds=r,12.2===e.ws(Object(o.g)())&&v("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return e.delete=function(t){return d("SimpleDb","Removing database:",t),gr(window.indexedDB.deleteDatabase(t)).cs()},e.G=function(){if("undefined"==typeof indexedDB)return!1;if(e.Es())return!0;var t=Object(o.g)(),n=e.ws(t),r=0<n&&n<10,i=e.Ts(t),c=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||c)},e.Es=function(){var e;return void 0!==t&&"YES"===(null===(e=t.env)||void 0===e?void 0:e.Is)},e.As=function(t,e){return t.store(e)},e.ws=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},e.Ts=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},e.prototype.Rs=function(t){return Object(h.a)(this,void 0,void 0,(function(){var e,n=this;return Object(h.c)(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(d("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new dr(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new k(S.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new dr(t,n))},i.onupgradeneeded=function(t){d("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.ds.Ps(e,i.transaction,t.oldVersion,n.version).next((function(){d("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.ys&&(this.db.onversionchange=function(t){return n.ys(t)}),this.db)]}}))}))},e.prototype.gs=function(t){this.ys=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},e.prototype.runTransaction=function(t,e,n,r){return Object(h.a)(this,void 0,void 0,(function(){var i,o,u,s,a;return Object(h.c)(this,(function(c){switch(c.label){case 0:i="readonly"===e,o=0,u=function(){var e,u,a,c,f;return Object(h.c)(this,(function(h){switch(h.label){case 0:++o,h.label=1;case 1:return h.trys.push([1,4,,5]),[4,s.Rs(t)];case 2:return s.db=h.sent(),e=fr.open(s.db,t,i?"readonly":"readwrite",n),u=r(e).catch((function(t){return e.abort(t),cr.reject(t)})).cs(),a={},u.catch((function(){})),[4,e.fs];case 3:return[2,(a.value=(h.sent(),u),a)];case 4:return c=h.sent(),f="FirebaseError"!==c.name&&o<3,d("SimpleDb","Transaction failed with error:",c.message,"Retrying:",f),s.close(),f?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},s=this,c.label=1;case 1:return[5,u()];case 2:if("object"==typeof(a=c.sent()))return[2,a.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},e.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},e}(),pr=function(){function t(t){this.Vs=t,this.ps=!1,this.bs=null}return Object.defineProperty(t.prototype,"ns",{get:function(){return this.ps},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vs",{get:function(){return this.bs},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Vs=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.ps=!0},t.prototype.Ss=function(t){this.bs=t},t.prototype.delete=function(){return gr(this.Vs.delete())},t}(),dr=function(t){function e(e,n){var r=this;return(r=t.call(this,S.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(h.b)(e,t),e}(k);function vr(t){return"IndexedDbTransactionError"===t.name}var yr=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(d("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(d("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),gr(n)},t.prototype.add=function(t){return d("SimpleDb","ADD",this.store.name,t,t),gr(this.store.add(t))},t.prototype.get=function(t){var e=this;return gr(this.store.get(t)).next((function(n){return void 0===n&&(n=null),d("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return d("SimpleDb","DELETE",this.store.name,t),gr(this.store.delete(t))},t.prototype.count=function(){return d("SimpleDb","COUNT",this.store.name),gr(this.store.count())},t.prototype.Ds=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.Cs(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.xs=function(t,e){d("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Ns=!1;var r=this.cursor(n);return this.Cs(r,(function(t,e,n){return n.delete()}))},t.prototype.Fs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.Cs(r,e)},t.prototype.Os=function(t){var e=this.cursor({});return new cr((function(n,r){e.onerror=function(t){var e=wr(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.Cs=function(t,e){var n=[];return new cr((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new pr(i),u=e(i.primaryKey,i.value,o);if(u instanceof cr){var s=u.catch((function(t){return o.done(),cr.reject(t)}));n.push(s)}o.ns?r():null===o.vs?i.continue():i.continue(o.vs)}else r()}})).next((function(){return cr.hs(n)}))},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Ns?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function gr(t){return new cr((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=wr(t.target.error);n(e)}}))}var mr=!1;function wr(t){var e=lr.ws(Object(o.g)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new k("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return mr||(mr=!0,setTimeout((function(){throw r}),0)),r}}return t}var Ir=function(){function t(t,e,n,r,i){this.ks=t,this.Ms=e,this.Ls=n,this.op=r,this.$s=i,this.Bs=new tt,this.then=this.Bs.promise.then.bind(this.Bs.promise),this.Bs.promise.catch((function(t){}))}return t.qs=function(e,n,r,i,o){var u=new t(e,n,Date.now()+r,i,o);return u.start(r),u},t.prototype.start=function(t){var e=this;this.Us=setTimeout((function(){return e.Qs()}),t)},t.prototype.Ks=function(){return this.Qs()},t.prototype.cancel=function(t){null!==this.Us&&(this.clearTimeout(),this.Bs.reject(new k(S.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.Qs=function(){var t=this;this.ks.Ws((function(){return null!==t.Us?(t.clearTimeout(),t.op().then((function(e){return t.Bs.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.Us&&(this.$s(this),clearTimeout(this.Us),this.Us=null)},t}();function Er(t,e){if(v("AsyncQueue",e+": "+t),vr(t))return new k(S.UNAVAILABLE,e+": "+t);throw t}var _r=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.js=t,this.Ms=e,this.Gs=n,this.zs=r,this.Hs=i,this.Js=0,this.Ys=null,this.Xs=Date.now(),this.reset()}return t.prototype.reset=function(){this.Js=0},t.prototype.Zs=function(){this.Js=this.Hs},t.prototype.ti=function(t){var e=this;this.cancel();var n=Math.floor(this.Js+this.ei()),r=Math.max(0,Date.now()-this.Xs),i=Math.max(0,n-r);i>0&&d("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Js+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ys=this.js.ni(this.Ms,i,(function(){return e.Xs=Date.now(),t()})),this.Js*=this.zs,this.Js<this.Gs&&(this.Js=this.Gs),this.Js>this.Hs&&(this.Js=this.Hs)},t.prototype.si=function(){null!==this.Ys&&(this.Ys.Ks(),this.Ys=null)},t.prototype.cancel=function(){null!==this.Ys&&(this.Ys.cancel(),this.Ys=null)},t.prototype.ei=function(){return(Math.random()-.5)*this.Js},t}(),Or=function(){function t(t,e,n,r,i,o){this.js=t,this.ii=n,this.ri=r,this.oi=i,this.listener=o,this.state=0,this.ci=0,this.ai=null,this.stream=null,this.ui=new _r(t,e)}return t.prototype.hi=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.li=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this._i()},t.prototype.stop=function(){return Object(h.a)(this,void 0,void 0,(function(){return Object(h.c)(this,(function(t){switch(t.label){case 0:return this.hi()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.fi=function(){this.state=0,this.ui.reset()},t.prototype.di=function(){var t=this;this.li()&&null===this.ai&&(this.ai=this.js.ni(this.ii,6e4,(function(){return t.wi()})))},t.prototype.Ei=function(t){this.Ti(),this.stream.send(t)},t.prototype.wi=function(){return Object(h.a)(this,void 0,void 0,(function(){return Object(h.c)(this,(function(t){return this.li()?[2,this.close(0)]:[2]}))}))},t.prototype.Ti=function(){this.ai&&(this.ai.cancel(),this.ai=null)},t.prototype.close=function(t,e){return Object(h.a)(this,void 0,void 0,(function(){return Object(h.c)(this,(function(n){switch(n.label){case 0:return this.Ti(),this.ui.cancel(),this.ci++,3!==t?this.ui.reset():e&&e.code===S.RESOURCE_EXHAUSTED?(v(e.toString()),v("Using maximum backoff delay to prevent overloading the backend."),this.ui.Zs()):e&&e.code===S.UNAUTHENTICATED&&this.oi.g(),null!==this.stream&&(this.Ii(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Z(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.Ii=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.mi(this.ci),n=this.ci;this.oi.getToken().then((function(e){t.ci===n&&t.Ai(e)}),(function(n){e((function(){var e=new k(S.UNKNOWN,"Fetching auth token failed: "+n.message);return t.Ri(e)}))}))},t.prototype.Ai=function(t){var e=this,n=this.mi(this.ci);this.stream=this.Pi(t),this.stream.Y((function(){n((function(){return e.state=2,e.listener.Y()}))})),this.stream.Z((function(t){n((function(){return e.Ri(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype._i=function(){var t=this;this.state=4,this.ui.ti((function(){return Object(h.a)(t,void 0,void 0,(function(){return Object(h.c)(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.Ri=function(t){return d("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.mi=function(t){var e=this;return function(n){e.js.Ws((function(){return e.ci===t?n():(d("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Tr=function(t){function e(e,n,r,i,o){var u=this;return(u=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).fe=i,u}return Object(h.b)(e,t),e.prototype.Pi=function(t){return this.ri.ft("Listen",t)},e.prototype.onMessage=function(t){this.ui.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:w()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.he?(I(void 0===e||"string"==typeof e),N.fromBase64String(e||"")):(I(void 0===e||e instanceof Uint8Array),N.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),u=(s=e.targetChange.cause)&&function(t){var e=void 0===t.code?S.UNKNOWN:$(t.code);return new k(e,t.message||"")}(s);n=new jn(r,i,o,u||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=Bn(t,r.document.name),o=Vn(r.document.updateTime);var s=new Dt({mapValue:{fields:r.document.fields}}),a=(u=new Lt(i,o,s,{}),r.targetIds||[]),c=r.removedTargetIds||[];n=new Tn(a,c,u.key,u)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=Bn(t,r.document),o=r.readTime?Vn(r.readTime):it.min(),s=new Ut(i,o),u=r.removedTargetIds||[],n=new Tn([],u,s.key,s);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=Bn(t,r.document),o=r.removedTargetIds||[],n=new Tn([],o,i,null);else{if(!("filter"in e))return w();e.filter;var h=e.filter;h.targetId,r=h.count||0,i=new nn(r),o=h.targetId,n=new An(o,i)}return n}(this.fe,t),n=function(t){if(!("targetChange"in t))return it.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?it.min():e.readTime?Vn(e.readTime):it.min()}(t);return this.listener.yi(e,n)},e.prototype.gi=function(t){var e={};e.database=tr(this.fe),e.addTarget=function(t,e){var n,r=e.target;return(n=Gt(r)?{documents:Jn(t,r)}:{query:Xn(t,r)}).targetId=e.targetId,e.resumeToken.o()>0?n.resumeToken=Ln(t,e.resumeToken):e.oe.u(it.min())>0&&(n.readTime=Cn(t,e.oe.Tt())),n}(this.fe,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return w()}}(0,e.re);return null==n?null:{"goog-listen-tags":n}}(this.fe,t);n&&(e.labels=n),this.Ei(e)},e.prototype.Vi=function(t){var e={};e.database=tr(this.fe),e.removeTarget=t,this.Ei(e)},e}(Or),Ar=function(t){function e(e,n,r,i,o){var u=this;return(u=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).fe=i,u.pi=!1,u}return Object(h.b)(e,t),Object.defineProperty(e.prototype,"bi",{get:function(){return this.pi},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.pi=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.Ii=function(){this.pi&&this.vi([])},e.prototype.Pi=function(t){return this.ri.ft("Write",t)},e.prototype.onMessage=function(t){if(I(!!t.streamToken),this.lastStreamToken=t.streamToken,this.pi){this.ui.reset();var e=function(t,e){return t&&t.length>0?(I(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?Vn(t.updateTime):Vn(e);n.isEqual(it.min())&&(n=Vn(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new Me(n,r)}(t,e)}))):[]}(t.writeResults,t.commitTime),n=Vn(t.commitTime);return this.listener.Si(n,e)}return I(!t.writeResults||0===t.writeResults.length),this.pi=!0,this.listener.Di()},e.prototype.Ci=function(){var t={};t.database=tr(this.fe),this.Ei(t)},e.prototype.vi=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Yn(e.fe,t)}))};this.Ei(n)},e}(Or),jr=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.ri=n,i.fe=r,i.xi=!1,i}return Object(h.b)(e,t),e.prototype.Ni=function(){if(this.xi)throw new k(S.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.at=function(t,e,n){var r=this;return this.Ni(),this.credentials.getToken().then((function(i){return r.ri.at(t,e,n,i)})).catch((function(t){throw t.code===S.UNAUTHENTICATED&&r.credentials.g(),t}))},e.prototype._t=function(t,e,n){var r=this;return this.Ni(),this.credentials.getToken().then((function(i){return r.ri._t(t,e,n,i)})).catch((function(t){throw t.code===S.UNAUTHENTICATED&&r.credentials.g(),t}))},e.prototype.terminate=function(){this.xi=!1},e}((function(){})),Nr="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Sr=function(){function t(){this.Fi=[]}return t.prototype.Oi=function(t){this.Fi.push(t)},t.prototype.ki=function(){this.Fi.forEach((function(t){return t()}))},t}(),kr={Mi:!1,Li:0,$i:0,Bi:0},xr=function(){function t(t,e,n){this.qi=t,this.Ui=e,this.Qi=n}return t.Ki=function(e){return new t(e,t.Wi,t.ji)},t}();xr.Wi=10,xr.ji=1e3,xr.Gi=new xr(41943040,xr.Wi,xr.ji),xr.zi=new xr(-1,0,0);var Dr=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.Hi=function(t){return n.Ji(t)},this.Yi=function(t){return e.Xi(t)})}return t.prototype.Ji=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.Yi&&this.Yi(t),t},t}();function Pr(t){return Object(h.a)(this,void 0,void 0,(function(){return Object(h.c)(this,(function(e){if(t.code!==S.FAILED_PRECONDITION||t.message!==Nr)throw t;return d("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}Dr.Zi=-1;var Rr=function(t,e){this.progress=t,this.tr=e},Cr=function(){function t(t,e,n,r){this.batchId=t,this.er=e,this.baseMutations=n,this.mutations=r}return t.prototype.nr=function(t,e,n){for(var r=n.sr,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Ge(o,e,r[i]))}return e},t.prototype.ir=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=ze(i,e,e,this.er))}for(var o=e,u=0,s=this.mutations;u<s.length;u++){var a=s[u];a.key.isEqual(t)&&(e=ze(a,e,o,this.er))}return e},t.prototype.rr=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.ir(r.key,t.get(r.key));i&&(n=n.Ie(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),gn())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&A(this.mutations,t.mutations,(function(t,e){return He(t,e)}))&&A(this.baseMutations,t.baseMutations,(function(t,e){return He(t,e)}))},t}(),Lr=function(){function t(t,e,n,r){this.batch=t,this.cr=e,this.sr=n,this.ar=r}return t.from=function(e,n,r){I(e.mutations.length===r.length);for(var i=vn(),o=e.mutations,u=0;u<o.length;u++)i=i.Ie(o[u].key,r[u].version);return new t(e,n,r,i)},t}(),Ur=function(){function t(t,e){this.ur=t,this.hr=e,this.lr={}}return t.prototype.get=function(t){var e=this.ur(t),n=this.lr[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],u=o[0],s=o[1];if(this.hr(u,t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.ur(t),r=this.lr[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.hr(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.lr[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.ur(t),n=this.lr[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.hr(n[r][0],t))return 1===n.length?delete this.lr[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){ht(this.lr,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],u=o[0],s=o[1];t(u,s)}}))},t.prototype.bt=function(){return ft(this.lr)},t}(),Vr=function(){function t(){this._r=new Ur((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.dr=!1}return t.prototype.wr=function(t){var e=this._r.get(t);return e?e.readTime:it.min()},t.prototype.Er=function(t,e){this.Tr(),this._r.set(t.key,{Ir:t,readTime:e})},t.prototype.mr=function(t,e){void 0===e&&(e=null),this.Tr(),this._r.set(t,{Ir:null,readTime:e})},t.prototype.Ar=function(t,e){this.Tr();var n=this._r.get(e);return void 0!==n?cr.resolve(n.Ir):this.Rr(t,e)},t.prototype.getEntries=function(t,e){return this.Pr(t,e)},t.prototype.apply=function(t){return this.Tr(),this.dr=!0,this.yr(t)},t.prototype.Tr=function(){},t}();function Mr(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],u=T(n,i);return 0===u?T(r,o):u}var Fr=function(){function t(t){this.gr=t,this.buffer=new un(Mr),this.Vr=0}return t.prototype.pr=function(){return++this.Vr},t.prototype.br=function(t){var e=[t,this.pr()];if(this.buffer.size<this.gr)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Mr(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),qr=function(){function t(t,e){this.vr=t,this.ks=e,this.Sr=!1,this.Dr=null}return t.prototype.start=function(t){-1!==this.vr.params.qi&&this.Cr(t)},t.prototype.stop=function(){this.Dr&&(this.Dr.cancel(),this.Dr=null)},Object.defineProperty(t.prototype,"Nr",{get:function(){return null!==this.Dr},enumerable:!1,configurable:!0}),t.prototype.Cr=function(t){var e=this,n=this.Sr?3e5:6e4;d("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.Dr=this.ks.ni("lru_garbage_collection",n,(function(){return Object(h.a)(e,void 0,void 0,(function(){var e;return Object(h.c)(this,(function(n){switch(n.label){case 0:this.Dr=null,this.Sr=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.Fr(this.vr)];case 2:return n.sent(),[3,7];case 3:return vr(e=n.sent())?(d("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Pr(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.Cr(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),Br=function(){function t(t,e){this.Or=t,this.params=e}return t.prototype.kr=function(t,e){return this.Or.Mr(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.Lr=function(t,e){var n=this;if(0===e)return cr.resolve(Dr.Zi);var r=new Fr(e);return this.Or.Un(t,(function(t){return r.br(t.sequenceNumber)})).next((function(){return n.Or.$r(t,(function(t){return r.br(t)}))})).next((function(){return r.maxValue}))},t.prototype.Br=function(t,e,n){return this.Or.Br(t,e,n)},t.prototype.qr=function(t,e){return this.Or.qr(t,e)},t.prototype.Ur=function(t,e){var n=this;return-1===this.params.qi?(d("LruGarbageCollector","Garbage collection skipped; disabled"),cr.resolve(kr)):this.Qr(t).next((function(r){return r<n.params.qi?(d("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.qi),kr):n.Kr(t,e)}))},t.prototype.Qr=function(t){return this.Or.Qr(t)},t.prototype.Kr=function(t,e){var n,i,o,u,s,a,c,h=this,f=Date.now();return this.kr(t,this.params.Ui).next((function(e){return e>h.params.Qi?(d("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Qi+" from "+e),i=h.params.Qi):i=e,u=Date.now(),h.Lr(t,i)})).next((function(r){return n=r,s=Date.now(),h.Br(t,n,e)})).next((function(e){return o=e,a=Date.now(),h.qr(t,n)})).next((function(t){return c=Date.now(),l()<=r.a.DEBUG&&d("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(u-f)+"ms\n\tDetermined least recently used "+i+" in "+(s-u)+"ms\n\tRemoved "+o+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),cr.resolve({Mi:!0,Li:i,$i:o,Bi:t})}))},t}();function Gr(t,e,n){if(!n)throw new k(S.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function zr(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new k(S.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Kr(t,e,n,r){if(!0===e&&!0===r)throw new k(S.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Hr(t){if(!at.qt(t))throw new k(S.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Wr(t){if(at.qt(t))throw new k(S.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Yr(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":w()}function Qr(t,e){if("_delegate"in t&&(t=t._),!(t instanceof e)){if(e.name===t.constructor.name)throw new k(S.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Yr(t);throw new k(S.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Jr(t,e){if(e<=0)throw new k(S.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Xr=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new k(S.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new k(S.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Kr("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),$r=new Map,Zr=function(){function t(t,e){this.Wr="(lite)",this.jr=new Xr({}),this.Gr=!1,t instanceof G?(this.zr=t,this.Hr=new U):(this.Jr=t,this.zr=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new k(S.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new G(t.options.projectId)}(t),this.Hr=new V(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.Jr)throw new k(S.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Jr},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Yr",{get:function(){return this.Gr},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Xr",{get:function(){return void 0!==this.Zr},enumerable:!1,configurable:!0}),t.prototype.eo=function(t){if(this.Gr)throw new k(S.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.jr=new Xr(t),void 0!==t.credentials&&(this.Hr=function(t){if(!t)return new U;switch(t.type){case"gapi":var e=t.client;return I(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new F(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new k(S.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.no=function(){return this.jr},t.prototype.so=function(){return this.Gr=!0,this.jr},t.prototype._delete=function(){return this.Zr||(this.Zr=this.io()),this.Zr},t.prototype.io=function(){return this,(t=$r.get(this))&&(d("ComponentProvider","Removing Datastore"),$r.delete(this),t.terminate()),Promise.resolve();var t},t}();function ti(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=li(e)),e=ei(t.get(n),e);return li(e)}function ei(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function li(t){return t+""}function ni(t){var e=t.length;if(I(e>=2),2===e)return I(""===t.charAt(0)&&""===t.charAt(1)),st.Nt();for(var n=e-2,r=[],i="",o=0;o<e;){var u=t.indexOf("",o);switch((u<0||u>n)&&w(),t.charAt(u+1)){case"":var s=t.substring(o,u),a=void 0;0===i.length?a=s:(a=i+=s,i=""),r.push(a);break;case"":i+=t.substring(o,u),i+="\0";break;case"":i+=t.substring(o,u+1);break;default:w()}o=u+2}return new st(r)}var ri=function(t,e){this.seconds=t,this.nanoseconds=e},ii=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};ii.store="owner",ii.key="owner";var oi=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};oi.store="mutationQueues",oi.keyPath="userId";var si=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};si.store="mutations",si.keyPath="batchId",si.userMutationsIndex="userMutationsIndex",si.userMutationsKeyPath=["userId","batchId"];var ui=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,ti(e)]},t.key=function(t,e,n){return[t,ti(e),n]},t}();ui.store="documentMutations",ui.PLACEHOLDER=new ui;var ai=function(t,e){this.path=t,this.readTime=e},ci=function(t,e){this.path=t,this.version=e},hi=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};hi.store="remoteDocuments",hi.readTimeIndex="readTimeIndex",hi.readTimeIndexPath="readTime",hi.collectionReadTimeIndex="collectionReadTimeIndex",hi.collectionReadTimeIndexPath=["parentPath","readTime"];var fi=function(t){this.byteSize=t};fi.store="remoteDocumentGlobal",fi.key="remoteDocumentGlobalKey";var pi=function(t,e,n,r,i,o,u){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=u};pi.store="targets",pi.keyPath="targetId",pi.queryTargetsIndexName="queryTargetsIndex",pi.queryTargetsKeyPath=["canonicalId","targetId"];var di=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};di.store="targetDocuments",di.keyPath=["targetId","path"],di.documentTargetsIndex="documentTargetsIndex",di.documentTargetsKeyPath=["path","targetId"];var vi=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};vi.key="targetGlobalKey",vi.store="targetGlobal";var yi=function(t,e){this.collectionId=t,this.parent=e};yi.store="collectionParents",yi.keyPath=["collectionId","parent"];var gi=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};gi.store="clientMetadata",gi.keyPath="clientId";var mi=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};mi.store="bundles",mi.keyPath="bundleId";var bi=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};bi.store="namedQueries",bi.keyPath="name";var wi=Object(h.d)(Object(h.d)(Object(h.d)(Object(h.d)([oi.store,si.store,ui.store,hi.store,pi.store,ii.store,vi.store,di.store],[gi.store]),[fi.store]),[yi.store]),[mi.store,bi.store]),Ii=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).ro=e,r.oo=n,r}return Object(h.b)(e,t),e}(Sr);function Ei(t,e){var n=E(t);return lr.As(n.ro,e)}var _i=function(t){this.co=t};function Oi(t,e){if(e.document)return Wn(t.co,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=at.Ut(e.noDocument.path),r=Si(e.noDocument.readTime);return new Ut(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=at.Ut(e.unknownDocument.path);return r=Si(e.unknownDocument.version),new Vt(i,r)}return w()}function Ti(t,e,n){var r=Ai(n),i=e.key.path.yt().Dt();if(e instanceof Lt){var o=function(t,e){return{name:qn(t,e.key),fields:e.Yt().mapValue.fields,updateTime:Cn(t,e.version.Tt())}}(t.co,e),u=e.hasCommittedMutations;return new hi(null,null,o,u,r,i)}if(e instanceof Ut){var s=e.key.path.Dt(),a=Ni(e.version);return u=e.hasCommittedMutations,new hi(null,new ai(s,a),null,u,r,i)}if(e instanceof Vt){var c=e.key.path.Dt(),h=Ni(e.version);return new hi(new ci(c,h),null,null,!0,r,i)}return w()}function Ai(t){var e=t.Tt();return[e.seconds,e.nanoseconds]}function ji(t){var e=new nt(t[0],t[1]);return it.wt(e)}function Ni(t){var e=t.Tt();return new ri(e.seconds,e.nanoseconds)}function Si(t){var e=new nt(t.seconds,t.nanoseconds);return it.wt(e)}function ki(t,e){for(var n=(e.baseMutations||[]).map((function(e){return Qn(t.co,e)})),r=e.mutations.length-1;r>=0;--r){var i=e.mutations[r];void 0!==(null==i?void 0:i.transform)&&(e.mutations[r-1].updateTransforms=i.transform.fieldTransforms,e.mutations.splice(r,1),--r)}var o=e.mutations.map((function(e){return Qn(t.co,e)})),u=nt.fromMillis(e.localWriteTimeMs);return new Cr(e.batchId,u,n,o)}function xi(t){var e,n,r=Si(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Si(t.lastLimboFreeSnapshotVersion):it.min();return void 0!==t.query.documents?(I(1===(n=t.query).documents.length),e=de(ue(zn(n.documents[0])))):e=function(t){return de($n(t))}(t.query),new Ee(e,t.targetId,0,t.lastListenSequenceNumber,r,i,N.fromBase64String(t.resumeToken))}function Di(t,e){var n,r=Ni(e.oe),i=Ni(e.lastLimboFreeSnapshotVersion);n=Gt(e.target)?Jn(t.co,e.target):Xn(t.co,e.target);var o=e.resumeToken.toBase64();return new pi(e.targetId,qt(e.target),r,o,e.sequenceNumber,i,n)}function Pi(t){var e=$n({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?ve(e,e.limit,"L"):e}var Ri=function(){function t(){}return t.prototype.ao=function(t,e){return Ci(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:Si(e.createTime),version:e.version};var e}))},t.prototype.uo=function(t,e){return Ci(t).put({bundleId:(n=e).id,createTime:Ni(Vn(n.createTime)),version:n.version});var n},t.prototype.ho=function(t,e){return Li(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:Pi(e.bundledQuery),readTime:Si(e.readTime)};var e}))},t.prototype.lo=function(t,e){return Li(t).put(function(t){return{name:t.name,readTime:Ni(Vn(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Ci(t){return Ei(t,mi.store)}function Li(t){return Ei(t,bi.store)}var Ui=function(){function t(){this._o=new Vi}return t.prototype.fo=function(t,e){return this._o.add(e),cr.resolve()},t.prototype.wo=function(t,e){return cr.resolve(this._o.getEntries(e))},t}(),Vi=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.Vt(),n=t.yt(),r=this.index[e]||new un(st.At),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.Vt(),n=t.yt(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new un(st.At)).Dt()},t}(),Mi=function(){function t(){this.Eo=new Vi}return t.prototype.fo=function(t,e){var n=this;if(!this.Eo.has(e)){var r=e.Vt(),i=e.yt();t.Oi((function(){n.Eo.add(e)}));var o={collectionId:r,parent:ti(i)};return Fi(t).put(o)}return cr.resolve()},t.prototype.wo=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[j(e),""],!1,!0);return Fi(t).Ds(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(ni(o.parent))}return n}))},t}();function Fi(t){return Ei(t,yi.store)}function qi(t,e,n){var r=t.store(si.store),i=t.store(ui.store),o=[],u=IDBKeyRange.only(n.batchId),s=0,a=r.Fs({range:u},(function(t,e,n){return s++,n.delete()}));o.push(a.next((function(){I(1===s)})));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=ui.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return cr.hs(o).next((function(){return c}))}function Bi(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw w();e=t.noDocument}return JSON.stringify(e).length}var Gi=function(){function t(t,e,n,r){this.userId=t,this.fe=e,this.To=n,this.Io=r,this.mo={}}return t.Ao=function(e,n,r,i){return I(""!==e.uid),new t(e.T()?e.uid:"",n,r,i)},t.prototype.Ro=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ki(t).Fs({index:si.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.Po=function(t,e,n,r){var i=this,o=Hi(t),u=Ki(t);return u.add({}).next((function(s){I("number"==typeof s);for(var a=new Cr(s,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return Yn(t.co,e)})),i=n.mutations.map((function(e){return Yn(t.co,e)}));return new si(e,n.batchId,n.er.toMillis(),r,i)}(i.fe,i.userId,a),h=[],f=new un((function(t,e){return T(t.Ct(),e.Ct())})),l=0,p=r;l<p.length;l++){var d=p[l],v=ui.key(i.userId,d.key.path,s);f=f.add(d.key.path.yt()),h.push(u.put(c)),h.push(o.put(v,ui.PLACEHOLDER))}return f.forEach((function(e){h.push(i.To.fo(t,e))})),t.Oi((function(){i.mo[s]=a.keys()})),cr.hs(h).next((function(){return a}))}))},t.prototype.yo=function(t,e){var n=this;return Ki(t).get(e).next((function(t){return t?(I(t.userId===n.userId),ki(n.fe,t)):null}))},t.prototype.Vo=function(t,e){var n=this;return this.mo[e]?cr.resolve(this.mo[e]):this.yo(t,e).next((function(t){if(t){var r=t.keys();return n.mo[e]=r,r}return null}))},t.prototype.po=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Ki(t).Fs({index:si.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(I(e.batchId>=r),o=ki(n.fe,e)),i.done()})).next((function(){return o}))},t.prototype.bo=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Ki(t).Fs({index:si.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.vo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ki(t).Ds(si.userMutationsIndex,n).next((function(t){return t.map((function(t){return ki(e.fe,t)}))}))},t.prototype.So=function(t,e){var n=this,r=ui.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Hi(t).Fs({range:i},(function(r,i,u){var s=r[0],a=r[1],c=r[2],h=ni(a);if(s===n.userId&&e.path.isEqual(h))return Ki(t).get(c).next((function(t){if(!t)throw w();I(t.userId===n.userId),o.push(ki(n.fe,t))}));u.done()})).next((function(){return o}))},t.prototype.Do=function(t,e){var n=this,r=new un(T),i=[];return e.forEach((function(e){var o=ui.prefixForPath(n.userId,e.path),u=IDBKeyRange.lowerBound(o),s=Hi(t).Fs({range:u},(function(t,i,o){var u=t[0],s=t[1],a=t[2],c=ni(s);u===n.userId&&e.path.isEqual(c)?r=r.add(a):o.done()}));i.push(s)})),cr.hs(i).next((function(){return n.Co(t,r)}))},t.prototype.xo=function(t,e){var n=this,r=e.path,i=r.length+1,o=ui.prefixForPath(this.userId,r),u=IDBKeyRange.lowerBound(o),s=new un(T);return Hi(t).Fs({range:u},(function(t,e,o){var u=t[0],a=t[1],c=t[2],h=ni(a);u===n.userId&&r.vt(h)?h.length===i&&(s=s.add(c)):o.done()})).next((function(){return n.Co(t,s)}))},t.prototype.Co=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(Ki(t).get(e).next((function(t){if(null===t)throw w();I(t.userId===n.userId),r.push(ki(n.fe,t))})))})),cr.hs(i).next((function(){return r}))},t.prototype.No=function(t,e){var n=this;return qi(t.ro,this.userId,e).next((function(r){return t.Oi((function(){n.Fo(e.batchId)})),cr.forEach(r,(function(e){return n.Io.Oo(t,e)}))}))},t.prototype.Fo=function(t){delete this.mo[t]},t.prototype.ko=function(t){var e=this;return this.Ro(t).next((function(n){if(!n)return cr.resolve();var r=IDBKeyRange.lowerBound(ui.prefixForUser(e.userId)),i=[];return Hi(t).Fs({range:r},(function(t,n,r){if(t[0]===e.userId){var o=ni(t[1]);i.push(o)}else r.done()})).next((function(){I(0===i.length)}))}))},t.prototype.Mo=function(t,e){return zi(t,this.userId,e)},t.prototype.Lo=function(t){var e=this;return Wi(t).get(this.userId).next((function(t){return t||new oi(e.userId,-1,"")}))},t}();function zi(t,e,n){var r=ui.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),u=!1;return Hi(t).Fs({range:o,Ns:!0},(function(t,n,r){var o=t[0],s=t[1];t[2],o===e&&s===i&&(u=!0),r.done()})).next((function(){return u}))}function Ki(t){return Ei(t,si.store)}function Hi(t){return Ei(t,ui.store)}function Wi(t){return Ei(t,oi.store)}var Yi=function(){function t(t){this.$o=t}return t.prototype.next=function(){return this.$o+=2,this.$o},t.Bo=function(){return new t(0)},t.qo=function(){return new t(-1)},t}(),Qi=function(){function t(t,e){this.Io=t,this.fe=e}return t.prototype.Uo=function(t){var e=this;return this.Qo(t).next((function(n){var r=new Yi(n.highestTargetId);return n.highestTargetId=r.next(),e.Ko(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.Wo=function(t){return this.Qo(t).next((function(t){return it.wt(new nt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.jo=function(t){return this.Qo(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.Go=function(t,e,n){var r=this;return this.Qo(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.Tt()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Ko(t,i)}))},t.prototype.zo=function(t,e){var n=this;return this.Ho(t,e).next((function(){return n.Qo(t).next((function(r){return r.targetCount+=1,n.Jo(e,r),n.Ko(t,r)}))}))},t.prototype.Yo=function(t,e){return this.Ho(t,e)},t.prototype.Xo=function(t,e){var n=this;return this.Zo(t,e.targetId).next((function(){return Ji(t).delete(e.targetId)})).next((function(){return n.Qo(t)})).next((function(e){return I(e.targetCount>0),e.targetCount-=1,n.Ko(t,e)}))},t.prototype.Br=function(t,e,n){var r=this,i=0,o=[];return Ji(t).Fs((function(u,s){var a=xi(s);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.Xo(t,a)))})).next((function(){return cr.hs(o)})).next((function(){return i}))},t.prototype.Un=function(t,e){return Ji(t).Fs((function(t,n){var r=xi(n);e(r)}))},t.prototype.Qo=function(t){return Xi(t).get(vi.key).next((function(t){return I(null!==t),t}))},t.prototype.Ko=function(t,e){return Xi(t).put(vi.key,e)},t.prototype.Ho=function(t,e){return Ji(t).put(Di(this.fe,e))},t.prototype.Jo=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.tc=function(t){return this.Qo(t).next((function(t){return t.targetCount}))},t.prototype.ec=function(t,e){var n=qt(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Ji(t).Fs({range:r,index:pi.queryTargetsIndexName},(function(t,n,r){var o=xi(n);Bt(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.nc=function(t,e,n){var r=this,i=[],o=$i(t);return e.forEach((function(e){var u=ti(e.path);i.push(o.put(new di(n,u))),i.push(r.Io.sc(t,n,e))})),cr.hs(i)},t.prototype.ic=function(t,e,n){var r=this,i=$i(t);return cr.forEach(e,(function(e){var o=ti(e.path);return cr.hs([i.delete([n,o]),r.Io.rc(t,n,e)])}))},t.prototype.Zo=function(t,e){var n=$i(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.oc=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=$i(t),i=gn();return r.Fs({range:n,Ns:!0},(function(t,e,n){var r=ni(t[1]),o=new at(r);i=i.add(o)})).next((function(){return i}))},t.prototype.Mo=function(t,e){var n=ti(e.path),r=IDBKeyRange.bound([n],[j(n)],!1,!0),i=0;return $i(t).Fs({index:di.documentTargetsIndex,Ns:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.Zn=function(t,e){return Ji(t).get(e).next((function(t){return t?xi(t):null}))},t}();function Ji(t){return Ei(t,pi.store)}function Xi(t){return Ei(t,vi.store)}function $i(t){return Ei(t,di.store)}var Zi=function(){function t(t,e){this.db=t,this.vr=function(t,e){return new Br(t,e)}(this,e)}return t.prototype.Mr=function(t){var e=this.cc(t);return this.db.ac().tc(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.cc=function(t){var e=0;return this.$r(t,(function(t){e++})).next((function(){return e}))},t.prototype.Un=function(t,e){return this.db.ac().Un(t,e)},t.prototype.$r=function(t,e){return this.uc(t,(function(t,n){return e(n)}))},t.prototype.sc=function(t,e,n){return to(t,n)},t.prototype.rc=function(t,e,n){return to(t,n)},t.prototype.Br=function(t,e,n){return this.db.ac().Br(t,e,n)},t.prototype.Oo=function(t,e){return to(t,e)},t.prototype.hc=function(t,e){return function(t,e){var n=!1;return Wi(t).Os((function(r){return zi(t,r,e).next((function(t){return t&&(n=!0),cr.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.qr=function(t,e){var n=this,r=this.db._c().lc(),i=[],o=0;return this.uc(t,(function(u,s){if(s<=e){var a=n.hc(t,u).next((function(e){if(!e)return o++,r.Ar(t,u).next((function(){return r.mr(u),$i(t).delete([0,ti(u.path)])}))}));i.push(a)}})).next((function(){return cr.hs(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.ce(t.oo);return this.db.ac().Yo(t,n)},t.prototype.fc=function(t,e){return to(t,e)},t.prototype.uc=function(t,e){var n,r=$i(t),i=Dr.Zi;return r.Fs({index:di.documentTargetsIndex},(function(t,r){var o=t[0],u=(t[1],r.path),s=r.sequenceNumber;0===o?(i!==Dr.Zi&&e(new at(ni(n)),i),i=s,n=u):i=Dr.Zi})).next((function(){i!==Dr.Zi&&e(new at(ni(n)),i)}))},t.prototype.Qr=function(t){return this.db._c().dc(t)},t}();function to(t,e){return $i(t).put(function(t,e){return new di(0,ti(t.path),e)}(e,t.oo))}var eo=function(){function t(t,e){this.fe=t,this.To=e}return t.prototype.Er=function(t,e,n){return io(t).put(oo(e),n)},t.prototype.mr=function(t,e){var n=io(t),r=oo(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.wc(t,r)}))},t.prototype.Ar=function(t,e){var n=this;return io(t).get(oo(e)).next((function(t){return n.Ec(t)}))},t.prototype.Tc=function(t,e){var n=this;return io(t).get(oo(e)).next((function(t){var e=n.Ec(t);return e?{Ir:e,size:Bi(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=fn();return this.Ic(t,e,(function(t,e){var i=n.Ec(e);r=r.Ie(t,i)})).next((function(){return r}))},t.prototype.mc=function(t,e){var n=this,r=fn(),i=new rn(at.At);return this.Ic(t,e,(function(t,e){var o=n.Ec(e);o?(r=r.Ie(t,o),i=i.Ie(t,Bi(e))):(r=r.Ie(t,null),i=i.Ie(t,0))})).next((function(){return{Ac:r,Rc:i}}))},t.prototype.Ic=function(t,e,n){if(e.bt())return cr.resolve();var r=IDBKeyRange.bound(e.first().path.Dt(),e.last().path.Dt()),i=e.ge(),o=i.De();return io(t).Fs({range:r},(function(t,e,r){for(var u=at.Ut(t);o&&at.At(o,u)<0;)n(o,null),o=i.De();o&&o.isEqual(u)&&(n(o,e),o=i.Ce()?i.De():null),o?r.Ss(o.path.Dt()):r.done()})).next((function(){for(;o;)n(o,null),o=i.Ce()?i.De():null}))},t.prototype.Pc=function(t,e,n){var r=this,i=pn(),o=e.path.length+1,u={};if(n.isEqual(it.min())){var s=e.path.Dt();u.range=IDBKeyRange.lowerBound(s)}else{var a=e.path.Dt(),c=Ai(n);u.range=IDBKeyRange.lowerBound([a,c],!0),u.index=hi.collectionReadTimeIndex}return io(t).Fs(u,(function(t,n,u){if(t.length===o){var s=Oi(r.fe,n);e.path.vt(s.key.path)?s instanceof Lt&&be(e,s)&&(i=i.Ie(s.key,s)):u.done()}})).next((function(){return i}))},t.prototype.lc=function(t){return new no(this,!!t&&t.yc)},t.prototype.dc=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return ro(t).get(fi.key).next((function(t){return I(!!t),t}))},t.prototype.wc=function(t,e){return ro(t).put(fi.key,e)},t.prototype.Ec=function(t){if(t){var e=Oi(this.fe,t);return e instanceof Ut&&e.version.isEqual(it.min())?null:e}return null},t}(),no=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).gc=e,r.yc=n,r.Vc=new Ur((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return Object(h.b)(e,t),e.prototype.yr=function(t){var e=this,n=[],r=0,i=new un((function(t,e){return T(t.Ct(),e.Ct())}));return this._r.forEach((function(o,u){var s=e.Vc.get(o);if(u.Ir){var a=Ti(e.gc.fe,u.Ir,e.wr(o));i=i.add(o.path.yt());var c=Bi(a);r+=c-s,n.push(e.gc.Er(t,o,a))}else if(r-=s,e.yc){var h=Ti(e.gc.fe,new Ut(o,it.min()),e.wr(o));n.push(e.gc.Er(t,o,h))}else n.push(e.gc.mr(t,o))})),i.forEach((function(r){n.push(e.gc.To.fo(t,r))})),n.push(this.gc.updateMetadata(t,r)),cr.hs(n)},e.prototype.Rr=function(t,e){var n=this;return this.gc.Tc(t,e).next((function(t){return null===t?(n.Vc.set(e,0),null):(n.Vc.set(e,t.size),t.Ir)}))},e.prototype.Pr=function(t,e){var n=this;return this.gc.mc(t,e).next((function(t){var e=t.Ac;return t.Rc.forEach((function(t,e){n.Vc.set(t,e)})),e}))},e}(Vr);function ro(t){return Ei(t,fi.store)}function io(t){return Ei(t,hi.store)}function oo(t){return t.path.Dt()}var so=function(){function t(t){this.fe=t}return t.prototype.Ps=function(t,e,n,r){var i=this;I(n<r&&n>=0&&r<=11);var o=new fr("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(ii.store)}(t),function(t){t.createObjectStore(oi.store,{keyPath:oi.keyPath}),t.createObjectStore(si.store,{keyPath:si.keyPath,autoIncrement:!0}).createIndex(si.userMutationsIndex,si.userMutationsKeyPath,{unique:!0}),t.createObjectStore(ui.store)}(t),uo(t),function(t){t.createObjectStore(hi.store)}(t));var u=cr.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(di.store),t.deleteObjectStore(pi.store),t.deleteObjectStore(vi.store)}(t),uo(t)),u=u.next((function(){return function(t){var e=t.store(vi.store),n=new vi(0,0,it.min().Tt(),0);return e.put(vi.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(u=u.next((function(){return function(t,e){return e.store(si.store).Ds().next((function(n){t.deleteObjectStore(si.store),t.createObjectStore(si.store,{keyPath:si.keyPath,autoIncrement:!0}).createIndex(si.userMutationsIndex,si.userMutationsKeyPath,{unique:!0});var r=e.store(si.store),i=n.map((function(t){return r.put(t)}));return cr.hs(i)}))}(t,o)}))),u=u.next((function(){!function(t){t.createObjectStore(gi.store,{keyPath:gi.keyPath})}(t)}))),n<5&&r>=5&&(u=u.next((function(){return i.bc(o)}))),n<6&&r>=6&&(u=u.next((function(){return function(t){t.createObjectStore(fi.store)}(t),i.vc(o)}))),n<7&&r>=7&&(u=u.next((function(){return i.Sc(o)}))),n<8&&r>=8&&(u=u.next((function(){return i.Dc(t,o)}))),n<9&&r>=9&&(u=u.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(hi.store);e.createIndex(hi.readTimeIndex,hi.readTimeIndexPath,{unique:!1}),e.createIndex(hi.collectionReadTimeIndex,hi.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(u=u.next((function(){return i.Cc(o)}))),n<11&&r>=11&&(u=u.next((function(){!function(t){t.createObjectStore(mi.store,{keyPath:mi.keyPath})}(t),function(t){t.createObjectStore(bi.store,{keyPath:bi.keyPath})}(t)}))),u},t.prototype.vc=function(t){var e=0;return t.store(hi.store).Fs((function(t,n){e+=Bi(n)})).next((function(){var n=new fi(e);return t.store(fi.store).put(fi.key,n)}))},t.prototype.bc=function(t){var e=this,n=t.store(oi.store),r=t.store(si.store);return n.Ds().next((function(n){return cr.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Ds(si.userMutationsIndex,i).next((function(r){return cr.forEach(r,(function(r){I(r.userId===n.userId);var i=ki(e.fe,r);return qi(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.Sc=function(t){var e=t.store(di.store),n=t.store(hi.store);return t.store(vi.store).get(vi.key).next((function(t){var r=[];return n.Fs((function(n,i){var o=new st(n),u=function(t){return[0,ti(t)]}(o);r.push(e.get(u).next((function(n){return n?cr.resolve():function(n){return e.put(new di(0,ti(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return cr.hs(r)}))}))},t.prototype.Dc=function(t,e){t.createObjectStore(yi.store,{keyPath:yi.keyPath});var n=e.store(yi.store),r=new Vi,i=function(t){if(r.add(t)){var e=t.Vt(),i=t.yt();return n.put({collectionId:e,parent:ti(i)})}};return e.store(hi.store).Fs({Ns:!0},(function(t,e){var n=new st(t);return i(n.yt())})).next((function(){return e.store(ui.store).Fs({Ns:!0},(function(t,e){t[0];var n=t[1],r=(t[2],ni(n));return i(r.yt())}))}))},t.prototype.Cc=function(t){var e=this,n=t.store(pi.store);return n.Fs((function(t,r){var i=xi(r),o=Di(e.fe,i);return n.put(o)}))},t}();function uo(t){t.createObjectStore(di.store,{keyPath:di.keyPath}).createIndex(di.documentTargetsIndex,di.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(pi.store,{keyPath:pi.keyPath}).createIndex(pi.queryTargetsIndexName,pi.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(vi.store)}var ao="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",co=function(){function t(e,n,r,i,o,u,s,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.js=o,this.window=u,this.document=s,this.xc=c,this.Nc=h,this.Fc=null,this.Oc=!1,this.isPrimary=!1,this.networkEnabled=!0,this.kc=null,this.inForeground=!1,this.Mc=null,this.Lc=null,this.$c=Number.NEGATIVE_INFINITY,this.Bc=function(t){return Promise.resolve()},!t.G())throw new k(S.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Io=new Zi(this,i),this.qc=n+"main",this.fe=new _i(a),this.Uc=new lr(this.qc,11,new so(this.fe)),this.Qc=new Qi(this.Io,this.fe),this.To=new Mi,this.Kc=function(t,e){return new eo(t,e)}(this.fe,this.To),this.Wc=new Ri,this.window&&this.window.localStorage?this.jc=this.window.localStorage:(this.jc=null,!1===h&&v("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.Gc().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new k(S.FAILED_PRECONDITION,ao);return t.zc(),t.Hc(),t.Jc(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.Qc.jo(e)}))})).then((function(e){t.Fc=new Dr(e,t.xc)})).then((function(){t.Oc=!0})).catch((function(e){return t.Uc&&t.Uc.close(),Promise.reject(e)}))},t.prototype.Yc=function(t){var e=this;return this.Bc=function(n){return Object(h.a)(e,void 0,void 0,(function(){return Object(h.c)(this,(function(e){return this.Nr?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.Xc=function(t){var e=this;this.Uc.gs((function(n){return Object(h.a)(e,void 0,void 0,(function(){return Object(h.c)(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.Zc=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.js.Ws((function(){return Object(h.a)(e,void 0,void 0,(function(){return Object(h.c)(this,(function(t){switch(t.label){case 0:return this.Nr?[4,this.Gc()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.Gc=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return fo(e).put(new gi(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.ta(e).next((function(e){e||(t.isPrimary=!1,t.js.ea((function(){return t.Bc(!1)})))}))})).next((function(){return t.na(e)})).next((function(n){return t.isPrimary&&!n?t.sa(e).next((function(){return!1})):!!n&&t.ia(e).next((function(){return!0}))}))})).catch((function(e){if(vr(e))return d("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return d("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.js.ea((function(){return t.Bc(e)})),t.isPrimary=e}))},t.prototype.ta=function(t){var e=this;return ho(t).get(ii.key).next((function(t){return cr.resolve(e.ra(t))}))},t.prototype.oa=function(t){return fo(t).delete(this.clientId)},t.prototype.ca=function(){return Object(h.a)(this,void 0,void 0,(function(){var t,e,n,r,i=this;return Object(h.c)(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.aa(this.$c,18e5)?[3,2]:(this.$c=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=Ei(t,gi.store);return e.Ds().next((function(t){var n=i.ua(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return cr.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.jc)for(e=0,n=t;e<n.length;e++)r=n[e],this.jc.removeItem(this.ha(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.Jc=function(){var t=this;this.Lc=this.js.ni("client_metadata_refresh",4e3,(function(){return t.Gc().then((function(){return t.ca()})).then((function(){return t.Jc()}))}))},t.prototype.ra=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.na=function(t){var e=this;return this.Nc?cr.resolve(!0):ho(t).get(ii.key).next((function(n){if(null!==n&&e.aa(n.leaseTimestampMs,5e3)&&!e.la(n.ownerId)){if(e.ra(n)&&e.networkEnabled)return!0;if(!e.ra(n)){if(!n.allowTabSynchronization)throw new k(S.FAILED_PRECONDITION,ao);return!1}}return!(!e.networkEnabled||!e.inForeground)||fo(t).Ds().next((function(t){return void 0===e.ua(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&d("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.$=function(){return Object(h.a)(this,void 0,void 0,(function(){var t=this;return Object(h.c)(this,(function(e){switch(e.label){case 0:return this.Oc=!1,this._a(),this.Lc&&(this.Lc.cancel(),this.Lc=null),this.fa(),this.da(),[4,this.Uc.runTransaction("shutdown","readwrite",[ii.store,gi.store],(function(e){var n=new Ii(e,Dr.Zi);return t.sa(n).next((function(){return t.oa(n)}))}))];case 1:return e.sent(),this.Uc.close(),this.wa(),[2]}}))}))},t.prototype.ua=function(t,e){var n=this;return t.filter((function(t){return n.aa(t.updateTimeMs,e)&&!n.la(t.clientId)}))},t.prototype.Ea=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return fo(e).Ds().next((function(e){return t.ua(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"Nr",{get:function(){return this.Oc},enumerable:!1,configurable:!0}),t.prototype.Ta=function(t){return Gi.Ao(t,this.fe,this.To,this.Io)},t.prototype.ac=function(){return this.Qc},t.prototype._c=function(){return this.Kc},t.prototype.Ia=function(){return this.To},t.prototype.ma=function(){return this.Wc},t.prototype.runTransaction=function(t,e,n){var r=this;d("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Uc.runTransaction(t,o,wi,(function(o){return i=new Ii(o,r.Fc?r.Fc.next():Dr.Zi),"readwrite-primary"===e?r.ta(i).next((function(t){return!!t||r.na(i)})).next((function(e){if(!e)throw v("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.js.ea((function(){return r.Bc(!1)})),new k(S.FAILED_PRECONDITION,Nr);return n(i)})).next((function(t){return r.ia(i).next((function(){return t}))})):r.Aa(i).next((function(){return n(i)}))})).then((function(t){return i.ki(),t}))},t.prototype.Aa=function(t){var e=this;return ho(t).get(ii.key).next((function(t){if(null!==t&&e.aa(t.leaseTimestampMs,5e3)&&!e.la(t.ownerId)&&!e.ra(t)&&!(e.Nc||e.allowTabSynchronization&&t.allowTabSynchronization))throw new k(S.FAILED_PRECONDITION,ao)}))},t.prototype.ia=function(t){var e=new ii(this.clientId,this.allowTabSynchronization,Date.now());return ho(t).put(ii.key,e)},t.G=function(){return lr.G()},t.prototype.sa=function(t){var e=this,n=ho(t);return n.get(ii.key).next((function(t){return e.ra(t)?(d("IndexedDbPersistence","Releasing primary lease."),n.delete(ii.key)):cr.resolve()}))},t.prototype.aa=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(v("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.zc=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Mc=function(){t.js.Ws((function(){return t.inForeground="visible"===t.document.visibilityState,t.Gc()}))},this.document.addEventListener("visibilitychange",this.Mc),this.inForeground="visible"===this.document.visibilityState)},t.prototype.fa=function(){this.Mc&&(this.document.removeEventListener("visibilitychange",this.Mc),this.Mc=null)},t.prototype.Hc=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.kc=function(){e._a(),e.js.Ws((function(){return e.$()}))},this.window.addEventListener("unload",this.kc))},t.prototype.da=function(){this.kc&&(this.window.removeEventListener("unload",this.kc),this.kc=null)},t.prototype.la=function(t){var e;try{var n=null!==(null===(e=this.jc)||void 0===e?void 0:e.getItem(this.ha(t)));return d("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return v("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype._a=function(){if(this.jc)try{this.jc.setItem(this.ha(this.clientId),String(Date.now()))}catch(t){v("Failed to set zombie client id.",t)}},t.prototype.wa=function(){if(this.jc)try{this.jc.removeItem(this.ha(this.clientId))}catch(t){}},t.prototype.ha=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function ho(t){return Ei(t,ii.store)}function fo(t){return Ei(t,gi.store)}function lo(t,e){var n=t.projectId;return t.M||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var po=function(){function t(t,e,n){this.Kc=t,this.Ra=e,this.To=n}return t.prototype.Pa=function(t,e){var n=this;return this.Ra.So(t,e).next((function(r){return n.ya(t,e,r)}))},t.prototype.ya=function(t,e,n){return this.Kc.Ar(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].ir(e,t);return t}))},t.prototype.ga=function(t,e,n){var r=fn();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].ir(t,e);r=r.Ie(t,e)})),r},t.prototype.Va=function(t,e){var n=this;return this.Kc.getEntries(t,e).next((function(e){return n.pa(t,e)}))},t.prototype.pa=function(t,e){var n=this;return this.Ra.Do(t,e).next((function(r){var i=n.ga(t,e,r),o=hn();return i.forEach((function(t,e){e||(e=new Ut(t,it.min())),o=o.Ie(t,e)})),o}))},t.prototype.Pc=function(t,e,n){return function(t){return at.qt(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.ba(t,e.path):le(e)?this.va(t,e,n):this.Sa(t,e,n)},t.prototype.ba=function(t,e){return this.Pa(t,new at(e)).next((function(t){var e=pn();return t instanceof Lt&&(e=e.Ie(t.key,t)),e}))},t.prototype.va=function(t,e,n){var r=this,i=e.collectionGroup,o=pn();return this.To.wo(t,i).next((function(u){return cr.forEach(u,(function(u){var s=function(t,e){return new oe(e,null,t.ne.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,u.child(i));return r.Sa(t,s,n).next((function(t){t.forEach((function(t,e){o=o.Ie(t,e)}))}))})).next((function(){return o}))}))},t.prototype.Sa=function(t,e,n){var r,i,o=this;return this.Kc.Pc(t,e,n).next((function(n){return r=n,o.Ra.xo(t,e)})).next((function(e){return i=e,o.Da(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],u=0,s=o.mutations;u<s.length;u++){var a=s[u],c=a.key,h=r.get(c),f=ze(a,h,h,o.er);r=f instanceof Lt?r.Ie(c,f):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){be(e,n)||(r=r.remove(t))})),r}))},t.prototype.Da=function(t,e,n){for(var r=gn(),i=0,o=e;i<o.length;i++)for(var u=0,s=o[i].mutations;u<s.length;u++){var a=s[u];a instanceof Qe&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Kc.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof Lt&&(c=c.Ie(t,e))})),c}))},t}(),vo=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.Ca=n,this.xa=r}return t.Na=function(e,n){for(var r=gn(),i=gn(),o=0,u=n.docChanges;o<u.length;o++){var s=u[o];switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),yo=function(){function t(){}return t.prototype.Fa=function(t){this.Oa=t},t.prototype.Pc=function(t,e,n,i){var o=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.ne.length||1===t.ne.length&&t.ne[0].field.Ot())}(e)||n.isEqual(it.min())?this.ka(t,e):this.Oa.Va(t,i).next((function(u){var s=o.Ma(e,u);return(ae(e)||ce(e))&&o.La(e.limitType,s,i,n)?o.ka(t,e):(l()<=r.a.DEBUG&&d("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),me(e)),o.Oa.Pc(t,e,n).next((function(t){return s.forEach((function(e){t=t.Ie(e.key,e)})),t})))}))},t.prototype.Ma=function(t,e){var n=new un(we(t));return e.forEach((function(e,r){r instanceof Lt&&be(t,r)&&(n=n.add(r))})),n},t.prototype.La=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.u(r)>0)},t.prototype.ka=function(t,e){return l()<=r.a.DEBUG&&d("QueryEngine","Using full collection scan to execute query:",me(e)),this.Oa.Pc(t,e,it.min())},t}(),go=function(){function t(t,e,n,r){this.persistence=t,this.$a=e,this.fe=r,this.Ba=new rn(T),this.qa=new Ur((function(t){return qt(t)}),Bt),this.Ua=it.min(),this.Ra=t.Ta(n),this.Qa=t._c(),this.Qc=t.ac(),this.Ka=new po(this.Qa,this.Ra,this.persistence.Ia()),this.Wc=t.ma(),this.$a.Fa(this.Ka)}return t.prototype.Fr=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.Ur(n,e.Ba)}))},t}();function mo(t,e,n,r){return new go(t,e,n,r)}function bo(t,e){return Object(h.a)(this,void 0,void 0,(function(){var n,r,i,o;return Object(h.c)(this,(function(u){switch(u.label){case 0:return n=E(t),r=n.Ra,i=n.Ka,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n.Ra.vo(t).next((function(u){return o=u,r=n.persistence.Ta(e),i=new po(n.Qa,r,n.persistence.Ia()),r.vo(t)})).next((function(e){for(var n=[],r=[],u=gn(),s=0,a=o;s<a.length;s++){var c=a[s];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++){var l=f[h];u=u.add(l.key)}}for(var p=0,d=e;p<d.length;p++){var v=d[p];r.push(v.batchId);for(var y=0,m=v.mutations;y<m.length;y++){var g=m[y];u=u.add(g.key)}}return i.Va(t,u).next((function(t){return{Wa:t,ja:n,Ga:r}}))}))}))];case 1:return o=u.sent(),[2,(n.Ra=r,n.Ka=i,n.$a.Fa(n.Ka),o)]}}))}))}function wo(t,e){var n=E(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.Qa.lc({yc:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),u=cr.resolve();return o.forEach((function(t){u=u.next((function(){return r.Ar(e,t)})).next((function(e){var o=e,u=n.ar.get(t);I(null!==u),(!o||o.version.u(u)<0)&&(o=i.nr(t,o,n))&&r.Er(o,n.cr)}))})),u.next((function(){return t.Ra.No(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n.Ra.ko(t)})).next((function(){return n.Ka.Va(t,r)}))}))}function Io(t){var e=E(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.Qc.Wo(t)}))}function Eo(t,e){var n=E(t),r=e.oe,i=n.Ba;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.Qa.lc({yc:!0});i=n.Ba;var u=[];e.rn.forEach((function(e,o){var s=i.get(o);if(s){u.push(n.Qc.ic(t,e.dn,o).next((function(){return n.Qc.nc(t,e._n,o)})));var a=e.resumeToken;if(a.o()>0){var c=s.ae(a,r).ce(t.oo);i=i.Ie(o,c),function(t,e,n){return I(e.resumeToken.o()>0),0===t.resumeToken.o()||e.oe.Et()-t.oe.Et()>=3e8||n._n.size+n.fn.size+n.dn.size>0}(s,c,e)&&u.push(n.Qc.Yo(t,c))}}}));var s=hn();if(e.cn.forEach((function(r,i){e.an.has(r)&&u.push(n.persistence.Io.fc(t,r))})),u.push(_o(t,o,e.cn,r,void 0).next((function(t){s=t}))),!r.isEqual(it.min())){var a=n.Qc.Wo(t).next((function(e){return n.Qc.Go(t,t.oo,r)}));u.push(a)}return cr.hs(u).next((function(){return o.apply(t)})).next((function(){return n.Ka.pa(t,s)}))})).then((function(t){return n.Ba=i,t}))}function _o(t,e,n,r,i){var o=gn();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=hn();return n.forEach((function(n,u){var s=t.get(n),a=(null==i?void 0:i.get(n))||r;u instanceof Ut&&u.version.isEqual(it.min())?(e.mr(n,a),o=o.Ie(n,u)):null==s||u.version.u(s.version)>0||0===u.version.u(s.version)&&s.hasPendingWrites?(e.Er(u,a),o=o.Ie(n,u)):d("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",u.version)})),o}))}function Oo(t,e){var n=E(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n.Ra.po(t,e)}))}function To(t,e){var n=E(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.Qc.ec(t,e).next((function(i){return i?(r=i,cr.resolve(r)):n.Qc.Uo(t).next((function(i){return r=new Ee(e,i,0,t.oo),n.Qc.zo(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Ba.get(t.targetId);return(null===r||t.oe.u(r.oe)>0)&&(n.Ba=n.Ba.Ie(t.targetId,t),n.qa.set(e,t.targetId)),t}))}function Ao(t,e,n){return Object(h.a)(this,void 0,void 0,(function(){var r,i,o,u;return Object(h.c)(this,(function(s){switch(s.label){case 0:r=E(t),i=r.Ba.get(e),o=n?"readwrite":"readwrite-primary",s.label=1;case 1:return s.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.Io.removeTarget(t,i)}))];case 2:s.sent(),s.label=3;case 3:return[3,5];case 4:if(!vr(u=s.sent()))throw u;return d("LocalStore","Failed to update sequence numbers for target "+e+": "+u),[3,5];case 5:return r.Ba=r.Ba.remove(e),r.qa.delete(i.target),[2]}}))}))}function jo(t,e,n){var r=E(t),i=it.min(),o=gn();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=E(t),i=r.qa.get(n);return void 0!==i?cr.resolve(r.Ba.get(i)):r.Qc.ec(e,n)}(r,t,de(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.Qc.oc(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.$a.Pc(t,e,n?i:it.min(),n?o:gn())})).next((function(t){return{documents:t,za:o}}))}))}function No(t,e){var n=E(t),r=E(n.Qc),i=n.Ba.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.Zn(t,e).next((function(t){return t?t.target:null}))}))}function So(t){var e=E(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=E(t),i=hn(),o=Ai(n),u=io(e),s=IDBKeyRange.lowerBound(o,!0);return u.Fs({index:hi.readTimeIndex,range:s},(function(t,e){var n=Oi(r.fe,e);i=i.Ie(n.key,n),o=e.readTime})).next((function(){return{tr:i,readTime:ji(o)}}))}(e.Qa,t,e.Ua)})).then((function(t){var n=t.tr,r=t.readTime;return e.Ua=r,n}))}function ko(t){return Object(h.a)(this,void 0,void 0,(function(){var e;return Object(h.c)(this,(function(n){return[2,(e=E(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=io(t),n=it.min();return e.Fs({index:hi.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=ji(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.Ua=t}))]}))}))}function xo(t,e,n,r){return Object(h.a)(this,void 0,void 0,(function(){var i,o,u,s,a,c,f,l,d,p;return Object(h.c)(this,(function(h){switch(h.label){case 0:for(i=E(t),o=gn(),u=hn(),s=vn(),a=0,c=n;a<c.length;a++)f=c[a],l=e.Ha(f.metadata.name),f.document&&(o=o.add(l)),u=u.Ie(l,e.Ja(f)),s=s.Ie(l,e.Ya(f.metadata.readTime));return d=i.Qa.lc({yc:!0}),[4,To(i,function(t){return de(ue(st.xt("__bundle__/docs/"+t)))}(r))];case 1:return p=h.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",(function(t){return _o(t,d,u,it.min(),s).next((function(e){return d.apply(t),e})).next((function(e){return i.Qc.Zo(t,p.targetId).next((function(){return i.Qc.nc(t,o,p.targetId)})).next((function(){return i.Ka.pa(t,e)}))}))}))]}}))}))}function Do(t,e,n){return void 0===n&&(n=gn()),Object(h.a)(this,void 0,void 0,(function(){var r,i;return Object(h.c)(this,(function(o){switch(o.label){case 0:return[4,To(t,de(Pi(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=E(t)).persistence.runTransaction("Save named query","readwrite",(function(t){var o=Vn(e.readTime);if(r.oe.u(o)>=0)return i.Wc.lo(t,e);var u=r.ae(N.h,o);return i.Ba=i.Ba.Ie(u.targetId,u),i.Qc.Yo(t,u).next((function(){return i.Qc.Zo(t,r.targetId)})).next((function(){return i.Qc.nc(t,n,r.targetId)})).next((function(){return i.Wc.lo(t,e)}))}))]}}))}))}var Po=function(){function t(t){this.fe=t,this.Xa=new Map,this.Za=new Map}return t.prototype.ao=function(t,e){return cr.resolve(this.Xa.get(e))},t.prototype.uo=function(t,e){var n;return this.Xa.set(e.id,{id:(n=e).id,version:n.version,createTime:Vn(n.createTime)}),cr.resolve()},t.prototype.ho=function(t,e){return cr.resolve(this.Za.get(e))},t.prototype.lo=function(t,e){return this.Za.set(e.name,function(t){return{name:t.name,query:Pi(t.bundledQuery),readTime:Vn(t.readTime)}}(e)),cr.resolve()},t}(),Ro=function(){function t(){this.tu=new un(Co.eu),this.nu=new un(Co.su)}return t.prototype.bt=function(){return this.tu.bt()},t.prototype.sc=function(t,e){var n=new Co(t,e);this.tu=this.tu.add(n),this.nu=this.nu.add(n)},t.prototype.iu=function(t,e){var n=this;t.forEach((function(t){return n.sc(t,e)}))},t.prototype.rc=function(t,e){this.ru(new Co(t,e))},t.prototype.ou=function(t,e){var n=this;t.forEach((function(t){return n.rc(t,e)}))},t.prototype.cu=function(t){var e=this,n=new at(new st([])),r=new Co(n,t),i=new Co(n,t+1),o=[];return this.nu.Qe([r,i],(function(t){e.ru(t),o.push(t.key)})),o},t.prototype.au=function(){var t=this;this.tu.forEach((function(e){return t.ru(e)}))},t.prototype.ru=function(t){this.tu=this.tu.delete(t),this.nu=this.nu.delete(t)},t.prototype.uu=function(t){var e=new at(new st([])),n=new Co(e,t),r=new Co(e,t+1),i=gn();return this.nu.Qe([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.Mo=function(t){var e=new Co(t,0),n=this.tu.We(e);return null!==n&&t.isEqual(n.key)},t}(),Co=function(){function t(t,e){this.key=t,this.hu=e}return t.eu=function(t,e){return at.At(t.key,e.key)||T(t.hu,e.hu)},t.su=function(t,e){return T(t.hu,e.hu)||at.At(t.key,e.key)},t}(),Lo=function(){function t(t,e){this.To=t,this.Io=e,this.Ra=[],this.lu=1,this._u=new un(Co.eu)}return t.prototype.Ro=function(t){return cr.resolve(0===this.Ra.length)},t.prototype.Po=function(t,e,n,r){var i=this.lu;this.lu++,this.Ra.length>0&&this.Ra[this.Ra.length-1];var o=new Cr(i,e,n,r);this.Ra.push(o);for(var u=0,s=r;u<s.length;u++){var a=s[u];this._u=this._u.add(new Co(a.key,i)),this.To.fo(t,a.key.path.yt())}return cr.resolve(o)},t.prototype.yo=function(t,e){return cr.resolve(this.fu(e))},t.prototype.po=function(t,e){var n=e+1,r=this.du(n),i=r<0?0:r;return cr.resolve(this.Ra.length>i?this.Ra[i]:null)},t.prototype.bo=function(){return cr.resolve(0===this.Ra.length?-1:this.lu-1)},t.prototype.vo=function(t){return cr.resolve(this.Ra.slice())},t.prototype.So=function(t,e){var n=this,r=new Co(e,0),i=new Co(e,Number.POSITIVE_INFINITY),o=[];return this._u.Qe([r,i],(function(t){var e=n.fu(t.hu);o.push(e)})),cr.resolve(o)},t.prototype.Do=function(t,e){var n=this,r=new un(T);return e.forEach((function(t){var e=new Co(t,0),i=new Co(t,Number.POSITIVE_INFINITY);n._u.Qe([e,i],(function(t){r=r.add(t.hu)}))})),cr.resolve(this.wu(r))},t.prototype.xo=function(t,e){var n=e.path,r=n.length+1,i=n;at.qt(i)||(i=i.child(""));var o=new Co(new at(i),0),u=new un(T);return this._u.Ke((function(t){var e=t.key.path;return!!n.vt(e)&&(e.length===r&&(u=u.add(t.hu)),!0)}),o),cr.resolve(this.wu(u))},t.prototype.wu=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.fu(t);null!==r&&n.push(r)})),n},t.prototype.No=function(t,e){var n=this;I(0===this.Eu(e.batchId,"removed")),this.Ra.shift();var r=this._u;return cr.forEach(e.mutations,(function(i){var o=new Co(i.key,e.batchId);return r=r.delete(o),n.Io.Oo(t,i.key)})).next((function(){n._u=r}))},t.prototype.Fo=function(t){},t.prototype.Mo=function(t,e){var n=new Co(e,0),r=this._u.We(n);return cr.resolve(e.isEqual(r&&r.key))},t.prototype.ko=function(t){return this.Ra.length,cr.resolve()},t.prototype.Eu=function(t,e){return this.du(t)},t.prototype.du=function(t){return 0===this.Ra.length?0:t-this.Ra[0].batchId},t.prototype.fu=function(t){var e=this.du(t);return e<0||e>=this.Ra.length?null:this.Ra[e]},t}(),Uo=function(){function t(t,e){this.To=t,this.Tu=e,this.docs=new rn(at.At),this.size=0}return t.prototype.Er=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,u=this.Tu(e);return this.docs=this.docs.Ie(r,{Ir:e,size:u,readTime:n}),this.size+=u-o,this.To.fo(t,r.path.yt())},t.prototype.mr=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.Ar=function(t,e){var n=this.docs.get(e);return cr.resolve(n?n.Ir:null)},t.prototype.getEntries=function(t,e){var n=this,r=fn();return e.forEach((function(t){var e=n.docs.get(t);r=r.Ie(t,e?e.Ir:null)})),cr.resolve(r)},t.prototype.Pc=function(t,e,n){for(var r=pn(),i=new at(e.path.child("")),o=this.docs.Ve(i);o.Ce();){var u=o.De(),s=u.key,a=u.value,c=a.Ir,h=a.readTime;if(!e.path.vt(s.path))break;h.u(n)<=0||c instanceof Lt&&be(e,c)&&(r=r.Ie(c.key,c))}return cr.resolve(r)},t.prototype.Iu=function(t,e){return cr.forEach(this.docs,(function(t){return e(t)}))},t.prototype.lc=function(t){return new Vo(this)},t.prototype.dc=function(t){return cr.resolve(this.size)},t}(),Vo=function(t){function e(e){var n=this;return(n=t.call(this)||this).gc=e,n}return Object(h.b)(e,t),e.prototype.yr=function(t){var e=this,n=[];return this._r.forEach((function(r,i){i&&i.Ir?n.push(e.gc.Er(t,i.Ir,e.wr(r))):e.gc.mr(r)})),cr.hs(n)},e.prototype.Rr=function(t,e){return this.gc.Ar(t,e)},e.prototype.Pr=function(t,e){return this.gc.getEntries(t,e)},e}(Vr),Mo=function(){function t(t){this.persistence=t,this.mu=new Ur((function(t){return qt(t)}),Bt),this.lastRemoteSnapshotVersion=it.min(),this.highestTargetId=0,this.Au=0,this.Ru=new Ro,this.targetCount=0,this.Pu=Yi.Bo()}return t.prototype.Un=function(t,e){return this.mu.forEach((function(t,n){return e(n)})),cr.resolve()},t.prototype.Wo=function(t){return cr.resolve(this.lastRemoteSnapshotVersion)},t.prototype.jo=function(t){return cr.resolve(this.Au)},t.prototype.Uo=function(t){return this.highestTargetId=this.Pu.next(),cr.resolve(this.highestTargetId)},t.prototype.Go=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Au&&(this.Au=e),cr.resolve()},t.prototype.Ho=function(t){this.mu.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Pu=new Yi(e),this.highestTargetId=e),t.sequenceNumber>this.Au&&(this.Au=t.sequenceNumber)},t.prototype.zo=function(t,e){return this.Ho(e),this.targetCount+=1,cr.resolve()},t.prototype.Yo=function(t,e){return this.Ho(e),cr.resolve()},t.prototype.Xo=function(t,e){return this.mu.delete(e.target),this.Ru.cu(e.targetId),this.targetCount-=1,cr.resolve()},t.prototype.Br=function(t,e,n){var r=this,i=0,o=[];return this.mu.forEach((function(u,s){s.sequenceNumber<=e&&null===n.get(s.targetId)&&(r.mu.delete(u),o.push(r.Zo(t,s.targetId)),i++)})),cr.hs(o).next((function(){return i}))},t.prototype.tc=function(t){return cr.resolve(this.targetCount)},t.prototype.ec=function(t,e){var n=this.mu.get(e)||null;return cr.resolve(n)},t.prototype.nc=function(t,e,n){return this.Ru.iu(e,n),cr.resolve()},t.prototype.ic=function(t,e,n){this.Ru.ou(e,n);var r=this.persistence.Io,i=[];return r&&e.forEach((function(e){i.push(r.Oo(t,e))})),cr.hs(i)},t.prototype.Zo=function(t,e){return this.Ru.cu(e),cr.resolve()},t.prototype.oc=function(t,e){var n=this.Ru.uu(e);return cr.resolve(n)},t.prototype.Mo=function(t,e){return cr.resolve(this.Ru.Mo(e))},t}(),Fo=function(){function t(t,e){var n=this;this.yu={},this.Fc=new Dr(0),this.Oc=!1,this.Oc=!0,this.Io=t(this),this.Qc=new Mo(this),this.To=new Ui,this.Kc=function(t,e){return new Uo(t,(function(t){return n.Io.gu(t)}))}(this.To),this.fe=new _i(e),this.Wc=new Po(this.fe)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.$=function(){return this.Oc=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Nr",{get:function(){return this.Oc},enumerable:!1,configurable:!0}),t.prototype.Xc=function(){},t.prototype.Zc=function(){},t.prototype.Ia=function(){return this.To},t.prototype.Ta=function(t){var e=this.yu[t.I()];return e||(e=new Lo(this.To,this.Io),this.yu[t.I()]=e),e},t.prototype.ac=function(){return this.Qc},t.prototype._c=function(){return this.Kc},t.prototype.ma=function(){return this.Wc},t.prototype.runTransaction=function(t,e,n){var r=this;d("MemoryPersistence","Starting transaction:",t);var i=new qo(this.Fc.next());return this.Io.Vu(),n(i).next((function(t){return r.Io.pu(i).next((function(){return t}))})).cs().then((function(t){return i.ki(),t}))},t.prototype.bu=function(t,e){return cr.ls(Object.values(this.yu).map((function(n){return function(){return n.Mo(t,e)}})))},t}(),qo=function(t){function e(e){var n=this;return(n=t.call(this)||this).oo=e,n}return Object(h.b)(e,t),e}(Sr),Bo=function(){function t(t){this.persistence=t,this.vu=new Ro,this.Su=null}return t.Du=function(e){return new t(e)},Object.defineProperty(t.prototype,"Cu",{get:function(){if(this.Su)return this.Su;throw w()},enumerable:!1,configurable:!0}),t.prototype.sc=function(t,e,n){return this.vu.sc(n,e),this.Cu.delete(n.toString()),cr.resolve()},t.prototype.rc=function(t,e,n){return this.vu.rc(n,e),this.Cu.add(n.toString()),cr.resolve()},t.prototype.Oo=function(t,e){return this.Cu.add(e.toString()),cr.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.vu.cu(e.targetId).forEach((function(t){return n.Cu.add(t.toString())}));var r=this.persistence.ac();return r.oc(t,e.targetId).next((function(t){t.forEach((function(t){return n.Cu.add(t.toString())}))})).next((function(){return r.Xo(t,e)}))},t.prototype.Vu=function(){this.Su=new Set},t.prototype.pu=function(t){var e=this,n=this.persistence._c().lc();return cr.forEach(this.Cu,(function(r){var i=at.Lt(r);return e.xu(t,i).next((function(t){t||n.mr(i)}))})).next((function(){return e.Su=null,n.apply(t)}))},t.prototype.fc=function(t,e){var n=this;return this.xu(t,e).next((function(t){t?n.Cu.delete(e.toString()):n.Cu.add(e.toString())}))},t.prototype.gu=function(t){return 0},t.prototype.xu=function(t,e){var n=this;return cr.ls([function(){return cr.resolve(n.vu.Mo(e))},function(){return n.persistence.ac().Mo(t,e)},function(){return n.persistence.bu(t,e)}])},t}();function Go(t,e){return"firestore_clients_"+t+"_"+e}function zo(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.T()&&(r+="_"+e.uid),r}function Ko(t,e){return"firestore_targets_"+t+"_"+e}var Ho=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Nu=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),u=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(u=new k(i.error.code,i.error.message)),o?new t(e,n,i.state,u):(v("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Fu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Wo=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Nu=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new k(r.error.code,r.error.message)),i?new t(e,r.state,o):(v("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Fu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Yo=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Nu=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=bn(),u=0;i&&u<r.activeTargetIds.length;++u)i=Y(r.activeTargetIds[u]),o=o.add(r.activeTargetIds[u]);return i?new t(e,o):(v("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Qo=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Nu=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(v("SharedClientState","Failed to parse online state: "+e),null)},t}(),Jo=function(){function t(){this.activeTargetIds=bn()}return t.prototype.Ou=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.ku=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Fu=function(){var t={activeTargetIds:this.activeTargetIds.Dt(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Xo=function(){function t(t,e,n,r,i){this.window=t,this.js=e,this.persistenceKey=n,this.Mu=r,this.Lu=null,this.$u=null,this.Hi=null,this.Bu=this.qu.bind(this),this.Uu=new rn(T),this.Nr=!1,this.Qu=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ku=Go(this.persistenceKey,this.Mu),this.Wu=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Uu=this.Uu.Ie(this.Mu,new Jo),this.ju=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Gu=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.zu=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Hu=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Ju=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.Bu)}return t.G=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(h.a)(this,void 0,void 0,(function(){var t,e,n,r,i,o,u,s,a,c,f,l=this;return Object(h.c)(this,(function(h){switch(h.label){case 0:return[4,this.Lu.Ea()];case 1:for(t=h.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Mu&&(i=this.getItem(Go(this.persistenceKey,r)))&&(o=Yo.Nu(r,i))&&(this.Uu=this.Uu.Ie(o.clientId,o));for(this.Yu(),(u=this.storage.getItem(this.Hu))&&(s=this.Xu(u))&&this.Zu(s),a=0,c=this.Qu;a<c.length;a++)f=c[a],this.qu(f);return this.Qu=[],this.window.addEventListener("unload",(function(){return l.$()})),this.Nr=!0,[2]}}))}))},t.prototype.Xi=function(t){this.setItem(this.Wu,JSON.stringify(t))},t.prototype.th=function(){return this.eh(this.Uu)},t.prototype.nh=function(t){var e=!1;return this.Uu.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.sh=function(t){this.ih(t,"pending")},t.prototype.rh=function(t,e,n){this.ih(t,e,n),this.oh(t)},t.prototype.ah=function(t){var e="not-current";if(this.nh(t)){var n=this.storage.getItem(Ko(this.persistenceKey,t));if(n){var r=Wo.Nu(t,n);r&&(e=r.state)}}return this.uh.Ou(t),this.Yu(),e},t.prototype.hh=function(t){this.uh.ku(t),this.Yu()},t.prototype.lh=function(t){return this.uh.activeTargetIds.has(t)},t.prototype._h=function(t){this.removeItem(Ko(this.persistenceKey,t))},t.prototype.fh=function(t,e,n){this.dh(t,e,n)},t.prototype.wh=function(t,e,n){var r=this;e.forEach((function(t){r.oh(t)})),this.currentUser=t,n.forEach((function(t){r.sh(t)}))},t.prototype.Eh=function(t){this.Th(t)},t.prototype.Ih=function(){this.mh()},t.prototype.$=function(){this.Nr&&(this.window.removeEventListener("storage",this.Bu),this.removeItem(this.Ku),this.Nr=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return d("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){d("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){d("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.qu=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(d("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ku)return void v("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.js.ea((function(){return Object(h.a)(e,void 0,void 0,(function(){var t,e,r,i,o,u;return Object(h.c)(this,(function(s){if(this.Nr){if(null!==n.key)if(this.ju.test(n.key)){if(null==n.newValue)return t=this.Ah(n.key),[2,this.Rh(t,null)];if(e=this.Ph(n.key,n.newValue))return[2,this.Rh(e.clientId,e)]}else if(this.Gu.test(n.key)){if(null!==n.newValue&&(r=this.yh(n.key,n.newValue)))return[2,this.gh(r)]}else if(this.zu.test(n.key)){if(null!==n.newValue&&(i=this.Vh(n.key,n.newValue)))return[2,this.ph(i)]}else if(n.key===this.Hu){if(null!==n.newValue&&(o=this.Xu(n.newValue)))return[2,this.Zu(o)]}else if(n.key===this.Wu)(u=function(t){var e=Dr.Zi;if(null!=t)try{var n=JSON.parse(t);I("number"==typeof n),e=n}catch(t){v("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Dr.Zi&&this.Hi(u);else if(n.key===this.Ju)return[2,this.Lu.bh()]}else this.Qu.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"uh",{get:function(){return this.Uu.get(this.Mu)},enumerable:!1,configurable:!0}),t.prototype.Yu=function(){this.setItem(this.Ku,this.uh.Fu())},t.prototype.ih=function(t,e,n){var r=new Ho(this.currentUser,t,e,n),i=zo(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Fu())},t.prototype.oh=function(t){var e=zo(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Th=function(t){var e={clientId:this.Mu,onlineState:t};this.storage.setItem(this.Hu,JSON.stringify(e))},t.prototype.dh=function(t,e,n){var r=Ko(this.persistenceKey,t),i=new Wo(t,e,n);this.setItem(r,i.Fu())},t.prototype.mh=function(){this.setItem(this.Ju,"value-not-used")},t.prototype.Ah=function(t){var e=this.ju.exec(t);return e?e[1]:null},t.prototype.Ph=function(t,e){var n=this.Ah(t);return Yo.Nu(n,e)},t.prototype.yh=function(t,e){var n=this.Gu.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Ho.Nu(new C(i),r,e)},t.prototype.Vh=function(t,e){var n=this.zu.exec(t),r=Number(n[1]);return Wo.Nu(r,e)},t.prototype.Xu=function(t){return Qo.Nu(t)},t.prototype.gh=function(t){return Object(h.a)(this,void 0,void 0,(function(){return Object(h.c)(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.Lu.Sh(t.batchId,t.state,t.error)]:(d("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.ph=function(t){return this.Lu.Dh(t.targetId,t.state,t.error)},t.prototype.Rh=function(t,e){var n=this,r=e?this.Uu.Ie(t,e):this.Uu.remove(t),i=this.eh(this.Uu),o=this.eh(r),u=[],s=[];return o.forEach((function(t){i.has(t)||u.push(t)})),i.forEach((function(t){o.has(t)||s.push(t)})),this.Lu.Ch(u,s).then((function(){n.Uu=r}))},t.prototype.Zu=function(t){this.Uu.get(t.clientId)&&this.$u(t.onlineState)},t.prototype.eh=function(t){var e=bn();return t.forEach((function(t,n){e=e.je(n.activeTargetIds)})),e},t}(),$o=function(){function t(){this.xh=new Jo,this.Nh={},this.$u=null,this.Hi=null}return t.prototype.sh=function(t){},t.prototype.rh=function(t,e,n){},t.prototype.ah=function(t){return this.xh.Ou(t),this.Nh[t]||"not-current"},t.prototype.fh=function(t,e,n){this.Nh[t]=e},t.prototype.hh=function(t){this.xh.ku(t)},t.prototype.lh=function(t){return this.xh.activeTargetIds.has(t)},t.prototype._h=function(t){delete this.Nh[t]},t.prototype.th=function(){return this.xh.activeTargetIds},t.prototype.nh=function(t){return this.xh.activeTargetIds.has(t)},t.prototype.start=function(){return this.xh=new Jo,Promise.resolve()},t.prototype.wh=function(t,e,n){},t.prototype.Eh=function(t){},t.prototype.$=function(){},t.prototype.Xi=function(t){},t.prototype.Ih=function(){},t}();function Zo(){return"undefined"!=typeof window?window:null}function ts(){return"undefined"!=typeof document?document:null}var es=function(){function t(t,e){this.ks=t,this.$u=e,this.state="Unknown",this.Fh=0,this.Oh=null,this.kh=!0}return t.prototype.Mh=function(){var t=this;0===this.Fh&&(this.Lh("Unknown"),this.Oh=this.ks.ni("online_state_timeout",1e4,(function(){return t.Oh=null,t.$h("Backend didn't respond within 10 seconds."),t.Lh("Offline"),Promise.resolve()})))},t.prototype.Bh=function(t){"Online"===this.state?this.Lh("Unknown"):(this.Fh++,this.Fh>=1&&(this.qh(),this.$h("Connection failed 1 times. Most recent error: "+t.toString()),this.Lh("Offline")))},t.prototype.set=function(t){this.qh(),this.Fh=0,"Online"===t&&(this.kh=!1),this.Lh(t)},t.prototype.Lh=function(t){t!==this.state&&(this.state=t,this.$u(t))},t.prototype.$h=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.kh?(v(e),this.kh=!1):d("OnlineStateTracker",e)},t.prototype.qh=function(){null!==this.Oh&&(this.Oh.cancel(),this.Oh=null)},t}(),ns=function(t,e,n,r,i){var o=this;this.Uh=t,this.Qh=e,this.ks=n,this.Kh={},this.Wh=[],this.jh=new Map,this.Gh=new Set,this.zh=[],this.Hh=i,this.Hh.L((function(t){n.Ws((function(){return Object(h.a)(o,void 0,void 0,(function(){return Object(h.c)(this,(function(t){switch(t.label){case 0:return fs(this)?(d("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(h.a)(this,void 0,void 0,(function(){var e;return Object(h.c)(this,(function(n){switch(n.label){case 0:return(e=E(t)).Gh.add(4),[4,is(e)];case 1:return n.sent(),e.Jh.set("Unknown"),e.Gh.delete(4),[4,rs(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Jh=new es(n,r)};function rs(t){return Object(h.a)(this,void 0,void 0,(function(){var e,n;return Object(h.c)(this,(function(r){switch(r.label){case 0:if(!fs(t))return[3,4];e=0,n=t.zh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function is(t){return Object(h.a)(this,void 0,void 0,(function(){var e,n;return Object(h.c)(this,(function(r){switch(r.label){case 0:e=0,n=t.zh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function os(t,e){var n=E(t);n.jh.has(e.targetId)||(n.jh.set(e.targetId,e),hs(n)?cs(n):As(n).li()&&us(n,e))}function ss(t,e){var n=E(t),r=As(n);n.jh.delete(e),r.li()&&as(n,e),0===n.jh.size&&(r.li()?r.di():fs(n)&&n.Jh.set("Unknown"))}function us(t,e){t.Yh.Dn(e.targetId),As(t).gi(e)}function as(t,e){t.Yh.Dn(e),As(t).Vi(e)}function cs(t){t.Yh=new Sn({Xn:function(e){return t.Kh.Xn(e)},Zn:function(e){return t.jh.get(e)||null}}),As(t).start(),t.Jh.Mh()}function hs(t){return fs(t)&&!As(t).hi()&&t.jh.size>0}function fs(t){return 0===E(t).Gh.size}function ls(t){t.Yh=void 0}function ps(t){return Object(h.a)(this,void 0,void 0,(function(){return Object(h.c)(this,(function(e){return t.jh.forEach((function(e,n){us(t,e)})),[2]}))}))}function ds(t,e){return Object(h.a)(this,void 0,void 0,(function(){return Object(h.c)(this,(function(n){return ls(t),hs(t)?(t.Jh.Bh(e),cs(t)):t.Jh.set("Unknown"),[2]}))}))}function vs(t,e,n){return Object(h.a)(this,void 0,void 0,(function(){var r,i,o;return Object(h.c)(this,(function(u){switch(u.label){case 0:if(t.Jh.set("Online"),!(e instanceof jn&&2===e.state&&e.cause))return[3,6];u.label=1;case 1:return u.trys.push([1,3,,5]),[4,function(t,e){return Object(h.a)(this,void 0,void 0,(function(){var n,r,i,o;return Object(h.c)(this,(function(u){switch(u.label){case 0:n=e.cause,r=0,i=e.targetIds,u.label=1;case 1:return r<i.length?(o=i[r],t.jh.has(o)?[4,t.Kh.Xh(o,n)]:[3,3]):[3,5];case 2:u.sent(),t.jh.delete(o),t.Yh.removeTarget(o),u.label=3;case 3:u.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return u.sent(),[3,5];case 3:return r=u.sent(),d("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,ys(t,r)];case 4:return u.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Tn?t.Yh.Ln(e):e instanceof An?t.Yh.jn(e):t.Yh.qn(e),n.isEqual(it.min()))return[3,13];u.label=7;case 7:return u.trys.push([7,11,,13]),[4,Io(t.Uh)];case 8:return i=u.sent(),n.u(i)>=0?[4,function(t,e){var n=t.Yh.Hn(e);return n.rn.forEach((function(n,r){if(n.resumeToken.o()>0){var i=t.jh.get(r);i&&t.jh.set(r,i.ae(n.resumeToken,e))}})),n.on.forEach((function(e){var n=t.jh.get(e);if(n){t.jh.set(e,n.ae(N.h,n.oe)),as(t,e);var r=new Ee(n.target,e,1,n.sequenceNumber);us(t,r)}})),t.Kh.Zh(n)}(t,n)]:[3,10];case 9:u.sent(),u.label=10;case 10:return[3,13];case 11:return d("RemoteStore","Failed to raise snapshot:",o=u.sent()),[4,ys(t,o)];case 12:return u.sent(),[3,13];case 13:return[2]}}))}))}function ys(t,e,n){return Object(h.a)(this,void 0,void 0,(function(){var r=this;return Object(h.c)(this,(function(i){switch(i.label){case 0:if(!vr(e))throw e;return t.Gh.add(1),[4,is(t)];case 1:return i.sent(),t.Jh.set("Offline"),n||(n=function(){return Io(t.Uh)}),t.ks.ea((function(){return Object(h.a)(r,void 0,void 0,(function(){return Object(h.c)(this,(function(e){switch(e.label){case 0:return d("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Gh.delete(1),[4,rs(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function gs(t,e){return e().catch((function(n){return ys(t,n,e)}))}function ms(t){return Object(h.a)(this,void 0,void 0,(function(){var e,n,r,i,o;return Object(h.c)(this,(function(u){switch(u.label){case 0:e=E(t),n=js(e),r=e.Wh.length>0?e.Wh[e.Wh.length-1].batchId:-1,u.label=1;case 1:if(!function(t){return fs(t)&&t.Wh.length<10}(e))return[3,7];u.label=2;case 2:return u.trys.push([2,4,,6]),[4,Oo(e.Uh,r)];case 3:return null===(i=u.sent())?(0===e.Wh.length&&n.di(),[3,7]):(r=i.batchId,function(t,e){t.Wh.push(e);var n=js(t);n.li()&&n.bi&&n.vi(e.mutations)}(e,i),[3,6]);case 4:return o=u.sent(),[4,ys(e,o)];case 5:return u.sent(),[3,6];case 6:return[3,1];case 7:return bs(e)&&ws(e),[2]}}))}))}function bs(t){return fs(t)&&!js(t).hi()&&t.Wh.length>0}function ws(t){js(t).start()}function Is(t){return Object(h.a)(this,void 0,void 0,(function(){return Object(h.c)(this,(function(e){return js(t).Ci(),[2]}))}))}function Es(t){return Object(h.a)(this,void 0,void 0,(function(){var e,n,r,i;return Object(h.c)(this,(function(o){for(e=js(t),n=0,r=t.Wh;n<r.length;n++)i=r[n],e.vi(i.mutations);return[2]}))}))}function _s(t,e,n){return Object(h.a)(this,void 0,void 0,(function(){var r,i;return Object(h.c)(this,(function(o){switch(o.label){case 0:return r=t.Wh.shift(),i=Lr.from(r,e,n),[4,gs(t,(function(){return t.Kh.tl(i)}))];case 1:return o.sent(),[4,ms(t)];case 2:return o.sent(),[2]}}))}))}function Os(t,e){return Object(h.a)(this,void 0,void 0,(function(){return Object(h.c)(this,(function(n){switch(n.label){case 0:return e&&js(t).bi?[4,function(t,e){return Object(h.a)(this,void 0,void 0,(function(){var n,r;return Object(h.c)(this,(function(i){switch(i.label){case 0:return X(r=e.code)&&r!==S.ABORTED?(n=t.Wh.shift(),js(t).fi(),[4,gs(t,(function(){return t.Kh.el(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,ms(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return bs(t)&&ws(t),[2]}}))}))}function Ts(t,e){return Object(h.a)(this,void 0,void 0,(function(){var n;return Object(h.c)(this,(function(i){switch(i.label){case 0:return n=E(t),e?(n.Gh.delete(2),[4,rs(n)]):[3,2];case 1:return i.sent(),[3,5];case 2:return e?[3,4]:(n.Gh.add(2),[4,is(n)]);case 3:i.sent(),n.Jh.set("Unknown"),i.label=4;case 4:i.label=5;case 5:return[2]}}))}))}function As(t){var e=this;return t.nl||(t.nl=function(t,e,n){var r=E(t);return r.Ni(),new Tr(e,r.ri,r.credentials,r.fe,n)}(t.Qh,t.ks,{Y:ps.bind(null,t),Z:ds.bind(null,t),yi:vs.bind(null,t)}),t.zh.push((function(n){return Object(h.a)(e,void 0,void 0,(function(){return Object(h.c)(this,(function(e){switch(e.label){case 0:return n?(t.nl.fi(),hs(t)?cs(t):t.Jh.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.nl.stop()];case 2:e.sent(),ls(t),e.label=3;case 3:return[2]}}))}))}))),t.nl}function js(t){var e=this;return t.sl||(t.sl=function(t,e,n){var r=E(t);return r.Ni(),new Ar(e,r.ri,r.credentials,r.fe,n)}(t.Qh,t.ks,{Y:Is.bind(null,t),Z:Os.bind(null,t),Di:Es.bind(null,t),Si:_s.bind(null,t)}),t.zh.push((function(n){return Object(h.a)(e,void 0,void 0,(function(){return Object(h.c)(this,(function(e){switch(e.label){case 0:return n?(t.sl.fi(),[4,ms(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.sl.stop()];case 3:e.sent(),t.Wh.length>0&&(d("RemoteStore","Stopping write stream with "+t.Wh.length+" pending writes"),t.Wh=[]),e.label=4;case 4:return[2]}}))}))}))),t.sl}var Ns=function(){this.il=void 0,this.listeners=[]},Ss=function(){this.queries=new Ur((function(t){return ge(t)}),ye),this.onlineState="Unknown",this.rl=new Set};function ks(t,e){return Object(h.a)(this,void 0,void 0,(function(){var n,r,i,o,u,s,a;return Object(h.c)(this,(function(c){switch(c.label){case 0:if(n=E(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new Ns),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),u=o,[4,n.ol(r)];case 2:return u.il=c.sent(),[3,4];case 3:return s=c.sent(),a=Er(s,"Initialization of query '"+me(e.query)+"' failed"),[2,void e.onError(a)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.cl(n.onlineState),o.il&&e.al(o.il)&&Rs(n),[2]}}))}))}function xs(t,e){return Object(h.a)(this,void 0,void 0,(function(){var n,r,i,o,u;return Object(h.c)(this,(function(s){return n=E(t),r=e.query,i=!1,(o=n.queries.get(r))&&(u=o.listeners.indexOf(e))>=0&&(o.listeners.splice(u,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.ul(r))]:[2]}))}))}function Ds(t,e){for(var n=E(t),r=!1,i=0,o=e;i<o.length;i++){var u=o[i],s=u.query,a=n.queries.get(s);if(a){for(var c=0,h=a.listeners;c<h.length;c++)h[c].al(u)&&(r=!0);a.il=u}}r&&Rs(n)}function Ps(t,e,n){var r=E(t),i=r.queries.get(e);if(i)for(var o=0,u=i.listeners;o<u.length;o++)u[o].onError(n);r.queries.delete(e)}function Rs(t){t.rl.forEach((function(t){t.next()}))}var Cs=function(){function t(t,e,n){this.query=t,this.hl=e,this.ll=!1,this._l=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.al=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new En(t.query,t.docs,t.Ze,e,t.tn,t.fromCache,t.en,!0)}var o=!1;return this.ll?this.fl(t)&&(this.hl.next(t),o=!0):this.dl(t,this.onlineState)&&(this.wl(t),o=!0),this._l=t,o},t.prototype.onError=function(t){this.hl.error(t)},t.prototype.cl=function(t){this.onlineState=t;var e=!1;return this._l&&!this.ll&&this.dl(this._l,t)&&(this.wl(this._l),e=!0),e},t.prototype.dl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.El&&n||t.docs.bt()&&"Offline"!==e)},t.prototype.fl=function(t){if(t.docChanges.length>0)return!0;var e=this._l&&this._l.hasPendingWrites!==t.hasPendingWrites;return!(!t.en&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.wl=function(t){t=En.sn(t.query,t.docs,t.tn,t.fromCache),this.ll=!0,this.hl.next(t)},t}(),Ls=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.Tl=function(){return"metadata"in this.payload},t}(),Us=function(){function t(t){this.fe=t}return t.prototype.Ha=function(t){return Bn(this.fe,t)},t.prototype.Ja=function(t){return t.metadata.exists?Wn(this.fe,t.document,!1):new Ut(this.Ha(t.metadata.name),this.Ya(t.metadata.readTime))},t.prototype.Ya=function(t){return Vn(t)},t}();!function(){function t(t,e,n){this.Il=t,this.Uh=e,this.fe=n,this.queries=[],this.documents=[],this.progress=Vs(t)}t.prototype.ml=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.Al=function(t){for(var e=new Map,n=new Us(this.fe),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var u=n.Ha(o.metadata.name),s=0,a=o.metadata.queries;s<a.length;s++){var c=a[s],h=(e.get(c)||gn()).add(u);e.set(c,h)}}return e},t.prototype.complete=function(){return Object(h.a)(this,void 0,void 0,(function(){var t,e,n,r,i;return Object(h.c)(this,(function(o){switch(o.label){case 0:return[4,xo(this.Uh,new Us(this.fe),this.documents,this.Il.id)];case 1:t=o.sent(),e=this.Al(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?(i=r[n],[4,Do(this.Uh,i,e.get(i.name))]):[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Rr(Object.assign({},this.progress),t))]}}))}))}}();function Vs(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Ms=function(t){this.key=t},Fs=function(t){this.key=t},qs=function(){function t(t,e){this.query=t,this.Rl=e,this.Pl=null,this.ln=!1,this.yl=gn(),this.tn=gn(),this.gl=we(t),this.Vl=new wn(this.gl)}return Object.defineProperty(t.prototype,"pl",{get:function(){return this.Rl},enumerable:!1,configurable:!0}),t.prototype.bl=function(t,e){var n=this,r=e?e.vl:new In,i=e?e.Vl:this.Vl,o=e?e.tn:this.tn,u=i,s=!1,a=ae(this.query)&&i.size===this.query.limit?i.last():null,c=ce(this.query)&&i.size===this.query.limit?i.first():null;if(t.Pe((function(t,e){var h=i.get(t),f=e instanceof Lt?e:null;f&&(f=be(n.query,f)?f:null);var l=!!h&&n.tn.has(h.key),p=!!f&&(f.Jt||n.tn.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.Sl(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.gl(f,a)>0||c&&n.gl(f,c)<0)&&(s=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(s=!0)),d&&(f?(u=u.add(f),o=p?o.add(t):o.delete(t)):(u=u.delete(t),o=o.delete(t)))})),ae(this.query)||ce(this.query))for(;u.size>this.query.limit;){var h=ae(this.query)?u.last():u.first();u=u.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{Vl:u,vl:r,La:s,tn:o}},t.prototype.Sl=function(t,e){return t.Jt&&e.hasCommittedMutations&&!e.Jt},t.prototype.yr=function(t,e,n){var r=this,i=this.Vl;this.Vl=t.Vl,this.tn=t.tn;var o=t.vl.Xe();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return w()}};return n(t)-n(e)}(t.type,e.type)||r.gl(t.doc,e.doc)})),this.Dl(n);var u=e?this.Cl():[],s=0===this.yl.size&&this.ln?1:0,a=s!==this.Pl;return this.Pl=s,0!==o.length||a?{snapshot:new En(this.query,t.Vl,i,o,t.tn,0===s,a,!1),xl:u}:{xl:u}},t.prototype.cl=function(t){return this.ln&&"Offline"===t?(this.ln=!1,this.yr({Vl:this.Vl,vl:new In,tn:this.tn,La:!1},!1)):{xl:[]}},t.prototype.Nl=function(t){return!this.Rl.has(t)&&!!this.Vl.has(t)&&!this.Vl.get(t).Jt},t.prototype.Dl=function(t){var e=this;t&&(t._n.forEach((function(t){return e.Rl=e.Rl.add(t)})),t.fn.forEach((function(t){})),t.dn.forEach((function(t){return e.Rl=e.Rl.delete(t)})),this.ln=t.ln)},t.prototype.Cl=function(){var t=this;if(!this.ln)return[];var e=this.yl;this.yl=gn(),this.Vl.forEach((function(e){t.Nl(e.key)&&(t.yl=t.yl.add(e.key))}));var n=[];return e.forEach((function(e){t.yl.has(e)||n.push(new Fs(e))})),this.yl.forEach((function(t){e.has(t)||n.push(new Ms(t))})),n},t.prototype.Fl=function(t){this.Rl=t.za,this.yl=gn();var e=this.bl(t.documents);return this.yr(e,!0)},t.prototype.Ol=function(){return En.sn(this.query,this.Vl,this.tn,0===this.Pl)},t}(),Bs=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Gs=function(t){this.key=t,this.kl=!1},zs=function(){function t(t,e,n,r,i,o){this.Uh=t,this.Ml=e,this.Ll=n,this.$l=r,this.currentUser=i,this.Bl=o,this.ql={},this.Ul=new Ur((function(t){return ge(t)}),ye),this.Ql=new Map,this.Kl=[],this.Wl=new rn(at.At),this.jl=new Map,this.Gl=new Ro,this.zl={},this.Hl=new Map,this.Jl=Yi.qo(),this.onlineState="Unknown",this.Yl=void 0}return Object.defineProperty(t.prototype,"Xl",{get:function(){return!0===this.Yl},enumerable:!1,configurable:!0}),t}();function Ks(t,e){return Object(h.a)(this,void 0,void 0,(function(){var n,r,i,o,u,s;return Object(h.c)(this,(function(a){switch(a.label){case 0:return n=wu(t),(o=n.Ul.get(e))?(r=o.targetId,n.$l.ah(r),i=o.view.Ol(),[3,4]):[3,1];case 1:return[4,To(n.Uh,de(e))];case 2:return u=a.sent(),s=n.$l.ah(u.targetId),r=u.targetId,[4,Hs(n,e,r,"current"===s)];case 3:i=a.sent(),n.Xl&&os(n.Ml,u),a.label=4;case 4:return[2,i]}}))}))}function Hs(t,e,n,r){return Object(h.a)(this,void 0,void 0,(function(){var i,o,u,s,a,c;return Object(h.c)(this,(function(f){switch(f.label){case 0:return t.Zl=function(e,n,r){return function(t,e,n,r){return Object(h.a)(this,void 0,void 0,(function(){var i,o,u;return Object(h.c)(this,(function(s){switch(s.label){case 0:return(i=e.view.bl(n)).La?[4,jo(t.Uh,e.query,!1).then((function(t){var n=t.documents;return e.view.bl(n,i)}))]:[3,2];case 1:i=s.sent(),s.label=2;case 2:return o=r&&r.rn.get(e.targetId),u=e.view.yr(i,t.Xl,o),[2,(ou(t,e.targetId,u.xl),u.snapshot)]}}))}))}(t,e,n,r)},[4,jo(t.Uh,e,!0)];case 1:return i=f.sent(),o=new qs(e,i.za),u=o.bl(i.documents),s=On.hn(n,r&&"Offline"!==t.onlineState),a=o.yr(u,t.Xl,s),ou(t,n,a.xl),c=new Bs(e,n,o),[2,(t.Ul.set(e,c),t.Ql.has(n)?t.Ql.get(n).push(e):t.Ql.set(n,[e]),a.snapshot)]}}))}))}function Ws(t,e){return Object(h.a)(this,void 0,void 0,(function(){var n,r,i;return Object(h.c)(this,(function(o){switch(o.label){case 0:return n=E(t),r=n.Ul.get(e),(i=n.Ql.get(r.targetId)).length>1?[2,(n.Ql.set(r.targetId,i.filter((function(t){return!ye(t,e)}))),void n.Ul.delete(e))]:n.Xl?(n.$l.hh(r.targetId),n.$l.nh(r.targetId)?[3,2]:[4,Ao(n.Uh,r.targetId,!1).then((function(){n.$l._h(r.targetId),ss(n.Ml,r.targetId),ru(n,r.targetId)})).catch(Pr)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return ru(n,r.targetId),[4,Ao(n.Uh,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function Ys(t,e,n){return Object(h.a)(this,void 0,void 0,(function(){var r,i,o,u;return Object(h.c)(this,(function(s){switch(s.label){case 0:r=Iu(t),s.label=1;case 1:return s.trys.push([1,5,,6]),[4,function(t,e){var n,r=E(t),i=nt.now(),o=e.reduce((function(t,e){return t.add(e.key)}),gn());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Ka.Va(t,o).next((function(o){n=o;for(var u=[],s=0,a=e;s<a.length;s++){var c=a[s],h=Ke(c,n.get(c.key));null!=h&&u.push(new Qe(c.key,h,Rt(h.proto.mapValue),Fe.exists(!0)))}return r.Ra.Po(t,i,u,e)}))})).then((function(t){var e=t.rr(n);return{batchId:t.batchId,_r:e}}))}(r.Uh,e)];case 2:return i=s.sent(),r.$l.sh(i.batchId),function(t,e,n){var r=t.zl[t.currentUser.I()];r||(r=new rn(T)),r=r.Ie(e,n),t.zl[t.currentUser.I()]=r}(r,i.batchId,n),[4,au(r,i._r)];case 3:return s.sent(),[4,ms(r.Ml)];case 4:return s.sent(),[3,6];case 5:return o=s.sent(),u=Er(o,"Failed to persist write"),n.reject(u),[3,6];case 6:return[2]}}))}))}function Qs(t,e){return Object(h.a)(this,void 0,void 0,(function(){var n,r;return Object(h.c)(this,(function(i){switch(i.label){case 0:n=E(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Eo(n.Uh,e)];case 2:return r=i.sent(),e.rn.forEach((function(t,e){var r=n.jl.get(e);r&&(I(t._n.size+t.fn.size+t.dn.size<=1),t._n.size>0?r.kl=!0:t.fn.size>0?I(r.kl):t.dn.size>0&&(I(r.kl),r.kl=!1))})),[4,au(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Pr(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function Js(t,e,n){var r=E(t);if(r.Xl&&0===n||!r.Xl&&1===n){var i=[];r.Ul.forEach((function(t,n){var r=n.view.cl(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=E(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].cl(e)&&(r=!0)})),r&&Rs(n)}(r.Ll,e),i.length&&r.ql.yi(i),r.onlineState=e,r.Xl&&r.$l.Eh(e)}}function Xs(t,e,n){return Object(h.a)(this,void 0,void 0,(function(){var r,i,o,u,s,a;return Object(h.c)(this,(function(c){switch(c.label){case 0:return(r=E(t)).$l.fh(e,"rejected",n),i=r.jl.get(e),(o=i&&i.key)?(u=(u=new rn(at.At)).Ie(o,new Ut(o,it.min())),s=gn().add(o),a=new _n(it.min(),new Map,new un(T),u,s),[4,Qs(r,a)]):[3,2];case 1:return c.sent(),r.Wl=r.Wl.remove(o),r.jl.delete(e),uu(r),[3,4];case 2:return[4,Ao(r.Uh,e,!1).then((function(){return ru(r,e,n)})).catch(Pr)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function $s(t,e){return Object(h.a)(this,void 0,void 0,(function(){var n,r,i;return Object(h.c)(this,(function(o){switch(o.label){case 0:n=E(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,wo(n.Uh,e)];case 2:return i=o.sent(),nu(n,r,null),eu(n,r),n.$l.rh(r,"acknowledged"),[4,au(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Pr(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Zs(t,e,n){return Object(h.a)(this,void 0,void 0,(function(){var r,i;return Object(h.c)(this,(function(o){switch(o.label){case 0:r=E(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=E(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n.Ra.yo(t,e).next((function(e){return I(null!==e),r=e.keys(),n.Ra.No(t,e)})).next((function(){return n.Ra.ko(t)})).next((function(){return n.Ka.Va(t,r)}))}))}(r.Uh,e)];case 2:return i=o.sent(),nu(r,e,n),eu(r,e),r.$l.rh(e,"rejected",n),[4,au(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Pr(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function tu(t,e){return Object(h.a)(this,void 0,void 0,(function(){var n,r,i,o,u;return Object(h.c)(this,(function(s){switch(s.label){case 0:fs((n=E(t)).Ml)||d("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,function(t){var e=E(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e.Ra.bo(t)}))}(n.Uh)];case 2:return-1===(r=s.sent())?[2,void e.resolve()]:((i=n.Hl.get(r)||[]).push(e),n.Hl.set(r,i),[3,4]);case 3:return o=s.sent(),u=Er(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(u),[3,4];case 4:return[2]}}))}))}function eu(t,e){(t.Hl.get(e)||[]).forEach((function(t){t.resolve()})),t.Hl.delete(e)}function nu(t,e,n){var r=E(t),i=r.zl[r.currentUser.I()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.zl[r.currentUser.I()]=i}}function ru(t,e,n){void 0===n&&(n=null),t.$l.hh(e);for(var r=0,i=t.Ql.get(e);r<i.length;r++){var o=i[r];t.Ul.delete(o),n&&t.ql.t_(o,n)}t.Ql.delete(e),t.Xl&&t.Gl.cu(e).forEach((function(e){t.Gl.Mo(e)||iu(t,e)}))}function iu(t,e){var n=t.Wl.get(e);null!==n&&(ss(t.Ml,n),t.Wl=t.Wl.remove(e),t.jl.delete(n),uu(t))}function ou(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Ms?(t.Gl.sc(o.key,e),su(t,o)):o instanceof Fs?(d("SyncEngine","Document no longer in limbo: "+o.key),t.Gl.rc(o.key,e),t.Gl.Mo(o.key)||iu(t,o.key)):w()}}function su(t,e){var n=e.key;t.Wl.get(n)||(d("SyncEngine","New document in limbo: "+n),t.Kl.push(n),uu(t))}function uu(t){for(;t.Kl.length>0&&t.Wl.size<t.Bl;){var e=t.Kl.shift(),n=t.Jl.next();t.jl.set(n,new Gs(e)),t.Wl=t.Wl.Ie(e,n),os(t.Ml,new Ee(de(ue(e.path)),n,2,Dr.Zi))}}function au(t,e,n){return Object(h.a)(this,void 0,void 0,(function(){var r,i,o,u;return Object(h.c)(this,(function(s){switch(s.label){case 0:return r=E(t),i=[],o=[],u=[],r.Ul.bt()?[3,3]:(r.Ul.forEach((function(t,s){u.push(r.Zl(s,e,n).then((function(t){if(t){r.Xl&&r.$l.fh(s.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=vo.Na(s.targetId,t);o.push(e)}})))})),[4,Promise.all(u)]);case 1:return s.sent(),r.ql.yi(i),[4,function(t,e){return Object(h.a)(this,void 0,void 0,(function(){var n,r,i,o,u,s,a,c,f;return Object(h.c)(this,(function(h){switch(h.label){case 0:n=E(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return cr.forEach(e,(function(e){return cr.forEach(e.Ca,(function(r){return n.persistence.Io.sc(t,e.targetId,r)})).next((function(){return cr.forEach(e.xa,(function(r){return n.persistence.Io.rc(t,e.targetId,r)}))}))}))}))];case 2:return h.sent(),[3,4];case 3:if(!vr(r=h.sent()))throw r;return d("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)u=o[i],s=u.targetId,u.fromCache||(a=n.Ba.get(s),c=a.oe,f=a.ue(c),n.Ba=n.Ba.Ie(s,f));return[2]}}))}))}(r.Uh,o)];case 2:s.sent(),s.label=3;case 3:return[2]}}))}))}function cu(t,e){return Object(h.a)(this,void 0,void 0,(function(){var n,r;return Object(h.c)(this,(function(i){switch(i.label){case 0:return(n=E(t)).currentUser.isEqual(e)?[3,3]:(d("SyncEngine","User change. New user:",e.I()),[4,bo(n.Uh,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Hl.forEach((function(t){t.forEach((function(t){t.reject(new k(S.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Hl.clear()}(n),n.$l.wh(e,r.ja,r.Ga),[4,au(n,r.Wa)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function hu(t,e){var n=E(t),r=n.jl.get(e);if(r&&r.kl)return gn().add(r.key);var i=gn(),o=n.Ql.get(e);if(!o)return i;for(var u=0,s=o;u<s.length;u++){var a=s[u],c=n.Ul.get(a);i=i.je(c.view.pl)}return i}function fu(t,e){return Object(h.a)(this,void 0,void 0,(function(){var n,r,i;return Object(h.c)(this,(function(o){switch(o.label){case 0:return[4,jo((n=E(t)).Uh,e.query,!0)];case 1:return r=o.sent(),i=e.view.Fl(r),[2,(n.Xl&&ou(n,e.targetId,i.xl),i)]}}))}))}function lu(t){return Object(h.a)(this,void 0,void 0,(function(){var e;return Object(h.c)(this,(function(n){return[2,So((e=E(t)).Uh).then((function(t){return au(e,t)}))]}))}))}function pu(t,e,n,r){return Object(h.a)(this,void 0,void 0,(function(){var i,o;return Object(h.c)(this,(function(u){switch(u.label){case 0:return[4,function(t,e){var n=E(t),r=E(n.Ra);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.Vo(t,e).next((function(e){return e?n.Ka.Va(t,e):cr.resolve(null)}))}))}((i=E(t)).Uh,e)];case 1:return null===(o=u.sent())?[3,6]:"pending"!==n?[3,3]:[4,ms(i.Ml)];case 2:return u.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(nu(i,e,r||null),eu(i,e),function(t,e){E(E(t).Ra).Fo(e)}(i.Uh,e)):w(),u.label=4;case 4:return[4,au(i,o)];case 5:return u.sent(),[3,7];case 6:d("SyncEngine","Cannot apply mutation batch with id: "+e),u.label=7;case 7:return[2]}}))}))}function du(t,e){return Object(h.a)(this,void 0,void 0,(function(){var n,r,i,o,u,s,a,c;return Object(h.c)(this,(function(h){switch(h.label){case 0:return wu(n=E(t)),Iu(n),!0!==e||!0===n.Yl?[3,3]:(r=n.$l.th(),[4,vu(n,r.Dt())]);case 1:return i=h.sent(),n.Yl=!0,[4,Ts(n.Ml,!0)];case 2:for(h.sent(),o=0,u=i;o<u.length;o++)s=u[o],os(n.Ml,s);return[3,7];case 3:return!1!==e||!1===n.Yl?[3,7]:(a=[],c=Promise.resolve(),n.Ql.forEach((function(t,e){n.$l.lh(e)?a.push(e):c=c.then((function(){return ru(n,e),Ao(n.Uh,e,!0)})),ss(n.Ml,e)})),[4,c]);case 4:return h.sent(),[4,vu(n,a)];case 5:return h.sent(),function(t){var e=E(t);e.jl.forEach((function(t,n){ss(e.Ml,n)})),e.Gl.au(),e.jl=new Map,e.Wl=new rn(at.At)}(n),n.Yl=!1,[4,Ts(n.Ml,!1)];case 6:h.sent(),h.label=7;case 7:return[2]}}))}))}function vu(t,e,n){return Object(h.a)(this,void 0,void 0,(function(){var n,r,i,o,u,s,a,c,f,l,d,p,v,y;return Object(h.c)(this,(function(h){switch(h.label){case 0:n=E(t),r=[],i=[],o=0,u=e,h.label=1;case 1:return o<u.length?(s=u[o],a=void 0,(c=n.Ql.get(s))&&0!==c.length?[4,To(n.Uh,de(c[0]))]:[3,7]):[3,13];case 2:a=h.sent(),f=0,l=c,h.label=3;case 3:return f<l.length?(d=l[f],p=n.Ul.get(d),[4,fu(n,p)]):[3,6];case 4:(v=h.sent()).snapshot&&i.push(v.snapshot),h.label=5;case 5:return f++,[3,3];case 6:return[3,11];case 7:return[4,No(n.Uh,s)];case 8:return y=h.sent(),[4,To(n.Uh,y)];case 9:return a=h.sent(),[4,Hs(n,yu(y),s,!1)];case 10:h.sent(),h.label=11;case 11:r.push(a),h.label=12;case 12:return o++,[3,1];case 13:return[2,(n.ql.yi(i),r)]}}))}))}function yu(t){return se(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function gu(t){var e=E(t);return E(E(e.Uh).persistence).Ea()}function mu(t,e,n,r){return Object(h.a)(this,void 0,void 0,(function(){var i,o,u;return Object(h.c)(this,(function(s){switch(s.label){case 0:return(i=E(t)).Yl?(d("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Ql.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,So(i.Uh)];case 3:return o=s.sent(),u=_n.un(e,"current"===n),[4,au(i,o,u)];case 4:return s.sent(),[3,8];case 5:return[4,Ao(i.Uh,e,!0)];case 6:return s.sent(),ru(i,e,r),[3,8];case 7:w(),s.label=8;case 8:return[2]}}))}))}function bu(t,e,n){return Object(h.a)(this,void 0,void 0,(function(){var r,i,o,u,s,a,c,f,l,v;return Object(h.c)(this,(function(p){switch(p.label){case 0:if(!(r=wu(t)).Yl)return[3,10];i=0,o=e,p.label=1;case 1:return i<o.length?(u=o[i],r.Ql.has(u)?(d("SyncEngine","Adding an already active target "+u),[3,5]):[4,No(r.Uh,u)]):[3,6];case 2:return s=p.sent(),[4,To(r.Uh,s)];case 3:return a=p.sent(),[4,Hs(r,yu(s),a.targetId,!1)];case 4:p.sent(),os(r.Ml,a),p.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(h.c)(this,(function(e){switch(e.label){case 0:return r.Ql.has(t)?[4,Ao(r.Uh,t,!1).then((function(){ss(r.Ml,t),ru(r,t)})).catch(Pr)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},f=0,l=n,p.label=7;case 7:return f<l.length?(v=l[f],[5,c(v)]):[3,10];case 8:p.sent(),p.label=9;case 9:return f++,[3,7];case 10:return[2]}}))}))}function wu(t){var e=E(t);return e.Ml.Kh.Zh=Qs.bind(null,e),e.Ml.Kh.Xn=hu.bind(null,e),e.Ml.Kh.Xh=Xs.bind(null,e),e.ql.yi=Ds.bind(null,e.Ll),e.ql.t_=Ps.bind(null,e.Ll),e}function Iu(t){var e=E(t);return e.Ml.Kh.tl=$s.bind(null,e),e.Ml.Kh.el=Zs.bind(null,e),e}var Eu=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(h.a)(this,void 0,void 0,(function(){return Object(h.c)(this,(function(e){switch(e.label){case 0:return this.fe=br(t.rt.O),this.$l=this.r_(t),this.persistence=this.o_(t),[4,this.persistence.start()];case 1:return e.sent(),this.c_=this.a_(t),this.Uh=this.u_(t),[2]}}))}))},t.prototype.a_=function(t){return null},t.prototype.u_=function(t){return mo(this.persistence,new yo,t.h_,this.fe)},t.prototype.o_=function(t){return new Fo(Bo.Du,this.fe)},t.prototype.r_=function(t){return new $o},t.prototype.terminate=function(){return Object(h.a)(this,void 0,void 0,(function(){return Object(h.c)(this,(function(t){switch(t.label){case 0:return this.c_&&this.c_.stop(),[4,this.$l.$()];case 1:return t.sent(),[4,this.persistence.$()];case 2:return t.sent(),[2]}}))}))},t}(),_u=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).l_=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(h.b)(e,t),e.prototype.initialize=function(e){return Object(h.a)(this,void 0,void 0,(function(){return Object(h.c)(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,ko(this.Uh)];case 2:return n.sent(),[4,this.l_.initialize(this,e)];case 3:return n.sent(),[4,Iu(this.l_.Lu)];case 4:return n.sent(),[4,ms(this.l_.Ml)];case 5:return n.sent(),[2]}}))}))},e.prototype.u_=function(t){return mo(this.persistence,new yo,t.h_,this.fe)},e.prototype.a_=function(t){var e=this.persistence.Io.vr;return new qr(e,t.ks)},e.prototype.o_=function(t){var e=lo(t.rt.O,t.rt.persistenceKey),n=void 0!==this.cacheSizeBytes?xr.Ki(this.cacheSizeBytes):xr.Gi;return new co(this.synchronizeTabs,e,t.clientId,n,t.ks,Zo(),ts(),this.fe,this.$l,!!this.forceOwnership)},e.prototype.r_=function(t){return new $o},e}(Eu),Ou=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).l_=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(h.b)(e,t),e.prototype.initialize=function(e){return Object(h.a)(this,void 0,void 0,(function(){var n,r=this;return Object(h.c)(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.l_.Lu,this.$l instanceof Xo?(this.$l.Lu={Sh:pu.bind(null,n),Dh:mu.bind(null,n),Ch:bu.bind(null,n),Ea:gu.bind(null,n),bh:lu.bind(null,n)},[4,this.$l.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.Yc((function(t){return Object(h.a)(r,void 0,void 0,(function(){return Object(h.c)(this,(function(e){switch(e.label){case 0:return[4,du(this.l_.Lu,t)];case 1:return e.sent(),this.c_&&(t&&!this.c_.Nr?this.c_.start(this.Uh):t||this.c_.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.r_=function(t){var e=Zo();if(!Xo.G(e))throw new k(S.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=lo(t.rt.O,t.rt.persistenceKey);return new Xo(e,t.ks,n,t.clientId,t.h_)},e}(_u),Tu=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(h.a)(this,void 0,void 0,(function(){var n=this;return Object(h.c)(this,(function(r){switch(r.label){case 0:return this.Uh?[3,2]:(this.Uh=t.Uh,this.$l=t.$l,this.Qh=this.__(e),this.Ml=this.f_(e),this.Ll=this.d_(e),this.Lu=this.w_(e,!t.synchronizeTabs),this.$l.$u=function(t){return Js(n.Lu,t,1)},this.Ml.Kh.E_=cu.bind(null,this.Lu),[4,Ts(this.Ml,this.Lu.Xl)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.d_=function(t){return new Ss},t.prototype.__=function(t){var e,n=br(t.rt.O),r=(e=t.rt,new et(e));return function(t,e,n){return new jr(t,e,n)}(t.credentials,r,n)},t.prototype.f_=function(t){var e,n,r,i,o,u=this;return e=this.Uh,n=this.Qh,r=t.ks,i=function(t){return Js(u.Lu,t,0)},o=K.G()?new K:new z,new ns(e,n,r,i,o)},t.prototype.w_=function(t,e){return function(t,e,n,r,i,o,u){var s=new zs(t,e,n,r,i,o);return u&&(s.Yl=!0),s}(this.Uh,this.Ml,this.Ll,this.$l,t.h_,t.Bl,e)},t.prototype.terminate=function(){return function(t){return Object(h.a)(this,void 0,void 0,(function(){var e;return Object(h.c)(this,(function(n){switch(n.label){case 0:return e=E(t),d("RemoteStore","RemoteStore shutting down."),e.Gh.add(5),[4,is(e)];case 1:return n.sent(),e.Hh.$(),e.Jh.set("Unknown"),[2]}}))}))}(this.Ml)},t}();var Au=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.T_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.T_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.I_=function(){this.muted=!0},t.prototype.T_=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),ju=(function(){function t(t,e){var n=this;this.m_=t,this.fe=e,this.metadata=new tt,this.buffer=new Uint8Array,this.A_=new TextDecoder("utf-8"),this.R_().then((function(t){t&&t.Tl()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))}),(function(t){return n.metadata.reject(t)}))}t.prototype.close=function(){return this.m_.cancel()},t.prototype.getMetadata=function(){return Object(h.a)(this,void 0,void 0,(function(){return Object(h.c)(this,(function(t){return[2,this.metadata.promise]}))}))},t.prototype.s_=function(){return Object(h.a)(this,void 0,void 0,(function(){return Object(h.c)(this,(function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.R_())]}}))}))},t.prototype.R_=function(){return Object(h.a)(this,void 0,void 0,(function(){var t,e,n,r;return Object(h.c)(this,(function(i){switch(i.label){case 0:return[4,this.P_()];case 1:return null===(t=i.sent())?[2,null]:(e=this.A_.decode(t),n=Number(e),isNaN(n)&&this.y_("length string ("+e+") is not valid number"),[4,this.g_(n)]);case 2:return r=i.sent(),[2,new Ls(JSON.parse(r),t.length+n)]}}))}))},t.prototype.V_=function(){return this.buffer.findIndex((function(t){return t==="{".charCodeAt(0)}))},t.prototype.P_=function(){return Object(h.a)(this,void 0,void 0,(function(){var t,e;return Object(h.c)(this,(function(n){switch(n.label){case 0:return this.V_()<0?[4,this.p_()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.V_())<0&&this.y_("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}}))}))},t.prototype.g_=function(t){return Object(h.a)(this,void 0,void 0,(function(){var e;return Object(h.c)(this,(function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.p_()]:[3,3];case 1:n.sent()&&this.y_("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.A_.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}}))}))},t.prototype.y_=function(t){throw this.m_.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.p_=function(){return Object(h.a)(this,void 0,void 0,(function(){var t,e;return Object(h.c)(this,(function(n){switch(n.label){case 0:return[4,this.m_.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}}))}))}}(),function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new k(S.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.b_=new ut(t)}return t.prototype.isEqual=function(t){return this.b_.isEqual(t.b_)},t}()),Nu=function(t){this._methodName=t},Su=function(){function t(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.Vt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.S_.path.Ct()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new xu(this.firestore,this.v_,this.S_.path.yt())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.S_)},t}(),ku=function(){function t(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.C_)},t}(),xu=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,ue(r))||this).firestore=e,i.D_=r,i.type="collection",i}return Object(h.b)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.C_.path.Vt()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.C_.path.Ct()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.D_.yt();return t.bt()?null:new Su(this.firestore,null,new at(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.D_)},e}(ku);function Du(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof q&&(t=t._),Gr("collection","path",e),t instanceof Zr)return Wr(n=st.xt.apply(st,Object(h.d)([e],r))),new xu(t,null,n);if(!(t instanceof Su||t instanceof xu))throw new k(S.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Wr(n=st.xt.apply(st,Object(h.d)([t.path],r)).child(st.xt(e))),new xu(t.firestore,null,n)}function Pu(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof q&&(t=t._),1===arguments.length&&(e=O.t()),Gr("doc","path",e),t instanceof Zr)return Hr(n=st.xt.apply(st,Object(h.d)([e],r))),new Su(t,null,new at(n));if(!(t instanceof Su||t instanceof xu))throw new k(S.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Hr(n=t.D_.child(st.xt.apply(st,Object(h.d)([e],r)))),new Su(t.firestore,t instanceof xu?t.v_:null,new at(n))}function Ru(t,e){return t instanceof q&&(t=t._),e instanceof q&&(e=e._),(t instanceof Su||t instanceof xu)&&(e instanceof Su||e instanceof xu)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function Cu(t,e){return t instanceof q&&(t=t._),e instanceof q&&(e=e._),t instanceof ku&&e instanceof ku&&t.firestore===e.firestore&&ye(t.C_,e.C_)&&t.v_===e.v_}var Lu=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new k(S.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new k(S.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},t.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},t.prototype.dt=function(t){return T(this.x_,t.x_)||T(this.N_,t.N_)},t}(),Uu=/^__.*__$/,Vu=function(){function t(t,e,n){this.data=t,this.Te=e,this.fieldTransforms=n}return t.prototype.F_=function(t,e){return null!==this.Te?new Qe(t,this.data,this.Te,e,this.fieldTransforms):new Ye(t,this.data,e,this.fieldTransforms)},t}(),Mu=function(){function t(t,e,n){this.data=t,this.Te=e,this.fieldTransforms=n}return t.prototype.F_=function(t,e){return new Qe(t,this.data,this.Te,e,this.fieldTransforms)},t}();function Fu(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw w()}}var qu=function(){function t(t,e,n,r,i,o){this.settings=t,this.O=e,this.fe=n,this.ignoreUndefinedProperties=r,void 0===i&&this.O_(),this.fieldTransforms=i||[],this.Te=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),t.prototype.M_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.O,this.fe,this.ignoreUndefinedProperties,this.fieldTransforms,this.Te)},t.prototype.L_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.q_(t),r},t.prototype.U_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.O_(),r},t.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},t.prototype.K_=function(t){return ua(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},t.prototype.contains=function(t){return void 0!==this.Te.find((function(e){return t.vt(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.vt(e.field)}))},t.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},t.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(Fu(this.k_)&&Uu.test(t))throw this.K_('Document fields cannot begin and end with "__"')},t}(),Bu=function(){function t(t,e,n){this.O=t,this.ignoreUndefinedProperties=e,this.fe=n||br(t)}return t.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new qu({k_:t,methodName:e,j_:n,path:ut.Nt(),B_:!1,W_:r},this.O,this.fe,this.ignoreUndefinedProperties)},t}();function Gu(t){var e=t.so(),n=br(t.zr);return new Bu(t.zr,!!e.ignoreUndefinedProperties,n)}function zu(t,e,n,r,i,o){void 0===o&&(o={});var u=t.G_(o.merge||o.mergeFields?2:0,e,n,i);ra("Data must be an object, but it was:",u,r);var s,a,c=ea(r,u);if(o.merge)s=new lt(u.Te),a=u.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=ia(e,l[f],n);if(!u.contains(p))throw new k(S.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");aa(h,p)||h.push(p)}s=new lt(h),a=u.fieldTransforms.filter((function(t){return s.Qt(t.field)}))}else s=null,a=u.fieldTransforms;return new Vu(new Dt(c),s,a)}var Ku=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.b)(e,t),e.prototype.z_=function(t){if(2!==t.k_)throw 1===t.k_?t.K_(this._methodName+"() can only appear at the top level of your update data"):t.K_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.Te.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Nu);function Hu(t,e,n){return new qu({k_:3,j_:e.settings.j_,methodName:t._methodName,B_:n},e.O,e.fe,e.ignoreUndefinedProperties)}var Wu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.b)(e,t),e.prototype.z_=function(t){return new Ve(t.path,new ke)},e.prototype.isEqual=function(t){return t instanceof e},e}(Nu),Yu=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return Object(h.b)(e,t),e.prototype.z_=function(t){var e=Hu(this,t,!0),n=this.H_.map((function(t){return ta(t,e)})),r=new xe(n);return new Ve(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Nu),Qu=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return Object(h.b)(e,t),e.prototype.z_=function(t){var e=Hu(this,t,!0),n=this.H_.map((function(t){return ta(t,e)})),r=new Pe(n);return new Ve(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Nu),Ju=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).J_=n,r}return Object(h.b)(e,t),e.prototype.z_=function(t){var e=new Ce(t.fe,Te(t.fe,this.J_));return new Ve(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Nu);function Xu(t,e,n,r){var i=t.G_(1,e,n);ra("Data must be an object, but it was:",i,r);var o=[],u=new Pt;ht(r,(function(t,r){var s=sa(e,t,n);r instanceof q&&(r=r._);var a=i.U_(s);if(r instanceof Ku)o.push(s);else{var c=ta(r,a);null!=c&&(o.push(s),u.set(s,c))}}));var s=new lt(o);return new Mu(u.Gt(),s,i.fieldTransforms)}function $u(t,e,n,r,i,o){var u=t.G_(1,e,n),s=[ia(e,r,n)],a=[i];if(o.length%2!=0)throw new k(S.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)s.push(ia(e,o[c])),a.push(o[c+1]);for(var h=[],f=new Pt,l=s.length-1;l>=0;--l)if(!aa(h,s[l])){var p=s[l],d=a[l];d instanceof q&&(d=d._);var v=u.U_(p);if(d instanceof Ku)h.push(p);else{var y=ta(d,v);null!=y&&(h.push(p),f.set(p,y))}}var m=new lt(h);return new Mu(f.Gt(),m,u.fieldTransforms)}function Zu(t,e,n,r){return void 0===r&&(r=!1),ta(n,t.G_(r?4:3,e))}function ta(t,e){if(t instanceof q&&(t=t._),na(t))return ra("Unsupported field value:",e,t),ea(t,e);if(t instanceof Nu)return function(t,e){if(!Fu(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");var n=t.z_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.Te.push(e.path),t instanceof Array){if(e.settings.B_&&4!==e.k_)throw e.K_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var u=ta(o[i],e.Q_(r));null==u&&(u={nullValue:"NULL_VALUE"}),n.push(u),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof q&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Te(e.fe,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=nt.fromDate(t);return{timestampValue:Cn(e.fe,n)}}if(t instanceof nt)return n=new nt(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Cn(e.fe,n)};if(t instanceof Lu)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof x)return{bytesValue:Ln(e.fe,t.l)};if(t instanceof Su){n=e.O;var r=t.firestore.zr;if(!r.isEqual(n))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Mn(t.firestore.zr||e.O,t.S_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.K_("Unsupported field value: "+Yr(t))}(t,e)}function ea(t,e){var n={};return ft(t)?e.path&&e.path.length>0&&e.Te.push(e.path):ht(t,(function(t,r){var i=ta(r,e.L_(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function na(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof nt||t instanceof Lu||t instanceof x||t instanceof Su||t instanceof Nu)}function ra(t,e,n){if(!na(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Yr(n);throw"an object"===r?e.K_(t+" a custom object"):e.K_(t+" "+r)}}function ia(t,e,n){if(e instanceof q&&(e=e._),e instanceof ju)return e.b_;if("string"==typeof e)return sa(t,e);throw ua("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var oa=new RegExp("[~\\*/\\[\\]]");function sa(t,e,n){if(e.search(oa)>=0)throw ua("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(ju.bind.apply(ju,Object(h.d)([void 0],e.split("."))))).b_}catch(r){throw ua("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function ua(t,e,n,r,i){var o=r&&!r.bt(),u=void 0!==i,s="Function "+e+"() called with invalid data";n&&(s+=" (via `toFirestore()`)");var a="";return(o||u)&&(a+=" (found",o&&(a+=" in field "+r),u&&(a+=" in document "+i),a+=")"),new k(S.INVALID_ARGUMENT,(s+=". ")+t+a)}function aa(t,e){return t.some((function(t){return t.isEqual(e)}))}var ca=function(){function t(t){this.Qh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}return t.prototype.ef=function(t){return Object(h.a)(this,void 0,void 0,(function(){var e,n=this;return Object(h.c)(this,(function(r){switch(r.label){case 0:if(this.nf(),this.mutations.length>0)throw new k(S.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(h.a)(this,void 0,void 0,(function(){var n,r,i,o,u,s;return Object(h.c)(this,(function(a){switch(a.label){case 0:return n=E(t),r=tr(n.fe)+"/documents",i={documents:e.map((function(t){return qn(n.fe,t)}))},[4,n._t("BatchGetDocuments",r,i)];case 1:return o=a.sent(),u=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){I(!!e.found),e.found.name,e.found.updateTime;var n=Bn(t,e.found.name),r=Vn(e.found.updateTime),i=new Dt({mapValue:{fields:e.found.fields}});return new Lt(n,r,i,{})}(t,e):"missing"in e?function(t,e){I(!!e.missing),I(!!e.readTime);var n=Bn(t,e.missing),r=Vn(e.readTime);return new Ut(n,r)}(t,e):w()}(n.fe,t);u.set(e.key.toString(),e)})),s=[],[2,(e.forEach((function(t){var e=u.get(t.toString());I(!!e),s.push(e)})),s)]}}))}))}(this.Qh,t)];case 1:return[2,((e=r.sent()).forEach((function(t){t instanceof Ut||t instanceof Lt?n.sf(t):w()})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.F_(t,this.Ee(t))),this.tf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.F_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},t.prototype.delete=function(t){this.write(new tn(t,this.Ee(t))),this.tf.add(t.toString())},t.prototype.commit=function(){return Object(h.a)(this,void 0,void 0,(function(){var t,e=this;return Object(h.c)(this,(function(n){switch(n.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return t=this.Y_,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=at.Lt(n);e.mutations.push(new en(r,e.Ee(r)))})),[4,function(t,e){return Object(h.a)(this,void 0,void 0,(function(){var n,r,i;return Object(h.c)(this,(function(o){switch(o.label){case 0:return n=E(t),r=tr(n.fe)+"/documents",i={writes:e.map((function(t){return Yn(n.fe,t)}))},[4,n.at("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.Qh,this.mutations)];case 1:return n.sent(),this.X_=!0,[2]}}))}))},t.prototype.sf=function(t){var e;if(t instanceof Lt)e=t.version;else{if(!(t instanceof Ut))throw w();e=it.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new k(S.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},t.prototype.Ee=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?Fe.updateTime(e):Fe.de()},t.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(!this.tf.has(t.toString())&&e){if(e.isEqual(it.min()))throw new k(S.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Fe.updateTime(e)}return Fe.exists(!0)},t.prototype.write=function(t){this.nf(),this.mutations.push(t)},t.prototype.nf=function(){},t}(),ha=function(){function t(t,e,n,r){this.ks=t,this.Qh=e,this.updateFunction=n,this.Bs=r,this.cf=5,this.ui=new _r(this.ks,"transaction_retry")}return t.prototype.run=function(){this.af()},t.prototype.af=function(){var t=this;this.ui.ti((function(){return Object(h.a)(t,void 0,void 0,(function(){var t,e,n=this;return Object(h.c)(this,(function(r){return t=new ca(this.Qh),(e=this.uf(t))&&e.then((function(e){n.ks.Ws((function(){return t.commit().then((function(){n.Bs.resolve(e)})).catch((function(t){n.hf(t)}))}))})).catch((function(t){n.hf(t)})),[2]}))}))}))},t.prototype.uf=function(t){try{var e=this.updateFunction(t);return!H(e)&&e.catch&&e.then?e:(this.Bs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Bs.reject(t),null}},t.prototype.hf=function(t){var e=this;this.cf>0&&this.lf(t)?(this.cf-=1,this.ks.Ws((function(){return e.af(),Promise.resolve()}))):this.Bs.reject(t)},t.prototype.lf=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!X(e)}return!1},t}(),fa=function(){function t(t,e,n){var r=this;this.credentials=t,this.ks=e,this.rt=n,this.user=C.UNAUTHENTICATED,this.clientId=O.t(),this._f=function(){},this.S=new tt,this.credentials.V((function(t){d("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r._f(t)),r.S.resolve()}))}return t.prototype.getConfiguration=function(){return Object(h.a)(this,void 0,void 0,(function(){return Object(h.c)(this,(function(t){switch(t.label){case 0:return[4,this.S.promise];case 1:return[2,(t.sent(),{ks:this.ks,rt:this.rt,clientId:this.clientId,credentials:this.credentials,h_:this.user,Bl:100})]}}))}))},t.prototype.ff=function(t){var e=this;this._f=t,this.S.promise.then((function(){return e._f(e.user)}))},t.prototype.df=function(){if(this.ks.wf)throw new k(S.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.ks.Ef();var e=new tt;return this.ks.Tf((function(){return Object(h.a)(t,void 0,void 0,(function(){var t,n;return Object(h.c)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.p(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Er(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();function la(t,e){return Object(h.a)(this,void 0,void 0,(function(){var n,r=this;return Object(h.c)(this,(function(i){switch(i.label){case 0:return t.ks.Af(),d("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=i.sent(),[4,e.initialize(n)];case 2:return i.sent(),t.ff((function(n){return t.ks.ea((function(){return Object(h.a)(r,void 0,void 0,(function(){return Object(h.c)(this,(function(t){switch(t.label){case 0:return[4,bo(e.Uh,n)];case 1:return t.sent(),[2]}}))}))}))})),e.persistence.Xc((function(){return t.terminate()})),t.mf=e,[2]}}))}))}function pa(t,e){return Object(h.a)(this,void 0,void 0,(function(){var n,r;return Object(h.c)(this,(function(i){switch(i.label){case 0:return t.ks.Af(),[4,da(t)];case 1:return n=i.sent(),d("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.ff((function(n){return t.ks.ea((function(){return function(t,e){return Object(h.a)(this,void 0,void 0,(function(){var n,r;return Object(h.c)(this,(function(i){switch(i.label){case 0:return(n=E(t)).ks.Af(),d("RemoteStore","RemoteStore received new credentials"),r=fs(n),n.Gh.add(3),[4,is(n)];case 1:return i.sent(),r&&n.Jh.set("Unknown"),[4,n.Kh.E_(e)];case 2:return i.sent(),n.Gh.delete(3),[4,rs(n)];case 3:return i.sent(),[2]}}))}))}(e.Ml,n)}))})),t.If=e,[2]}}))}))}function da(t){return Object(h.a)(this,void 0,void 0,(function(){return Object(h.c)(this,(function(e){switch(e.label){case 0:return t.mf?[3,2]:(d("FirestoreClient","Using default OfflineComponentProvider"),[4,la(t,new Eu)]);case 1:e.sent(),e.label=2;case 2:return[2,t.mf]}}))}))}function va(t){return Object(h.a)(this,void 0,void 0,(function(){return Object(h.c)(this,(function(e){switch(e.label){case 0:return t.If?[3,2]:(d("FirestoreClient","Using default OnlineComponentProvider"),[4,pa(t,new Tu)]);case 1:e.sent(),e.label=2;case 2:return[2,t.If]}}))}))}function ya(t){return da(t).then((function(t){return t.persistence}))}function ga(t){return da(t).then((function(t){return t.Uh}))}function ma(t){return va(t).then((function(t){return t.Ml}))}function ba(t){return va(t).then((function(t){return t.Lu}))}function wa(t){return Object(h.a)(this,void 0,void 0,(function(){var e,n;return Object(h.c)(this,(function(r){switch(r.label){case 0:return[4,va(t)];case 1:return e=r.sent(),[2,((n=e.Ll).ol=Ks.bind(null,e.Lu),n.ul=Ws.bind(null,e.Lu),n)]}}))}))}function Ia(t,e,n){var r=this;void 0===n&&(n={});var i=new tt;return t.ks.Ws((function(){return Object(h.a)(r,void 0,void 0,(function(){var r;return Object(h.c)(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Au({next:function(o){e.Ws((function(){return xs(t,u)}));var s=o.docs.has(n);!s&&o.fromCache?i.reject(new k(S.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&o.fromCache&&r&&"server"===r.source?i.reject(new k(S.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),u=new Cs(ue(n.path),o,{includeMetadataChanges:!0,El:!0});return ks(t,u)},[4,wa(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.ks,e,n,i])]}}))}))})),i.promise}function Ea(t,e,n){var r=this;void 0===n&&(n={});var i=new tt;return t.ks.Ws((function(){return Object(h.a)(r,void 0,void 0,(function(){var r;return Object(h.c)(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Au({next:function(n){e.Ws((function(){return xs(t,u)})),n.fromCache&&"server"===r.source?i.reject(new k(S.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),u=new Cs(n,o,{includeMetadataChanges:!0,El:!0});return ks(t,u)},[4,wa(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.ks,e,n,i])]}}))}))})),i.promise}var _a=function(){function t(){var t=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.ui=new _r(this,"async_queue_retry"),this.vf=function(){var e=ts();e&&d("AsyncQueue","Visibility state changed to "+e.visibilityState),t.ui.si()};var e=ts();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.vf)}return Object.defineProperty(t.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),t.prototype.Ws=function(t){this.enqueue(t)},t.prototype.Tf=function(t){this.Sf(),this.Df(t)},t.prototype.Ef=function(){if(!this.yf){this.yf=!0;var t=ts();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf)}},t.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise((function(t){})):this.Df(t)},t.prototype.ea=function(t){var e=this;this.Ws((function(){return e.Pf.push(t),e.Cf()}))},t.prototype.Cf=function(){return Object(h.a)(this,void 0,void 0,(function(){var t,e=this;return Object(h.c)(this,(function(n){switch(n.label){case 0:if(0===this.Pf.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return n.sent(),this.Pf.shift(),this.ui.reset(),[3,4];case 3:if(!vr(t=n.sent()))throw t;return d("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Pf.length>0&&this.ui.ti((function(){return e.Cf()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Df=function(t){var e=this,n=this.Rf.then((function(){return e.pf=!0,t().catch((function(t){throw e.Vf=t,e.pf=!1,v("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.pf=!1,t}))}));return this.Rf=n,n},t.prototype.ni=function(t,e,n){var r=this;this.Sf(),this.bf.indexOf(t)>-1&&(e=0);var i=Ir.qs(this,t,e,n,(function(t){return r.xf(t)}));return this.gf.push(i),i},t.prototype.Sf=function(){this.Vf&&w()},t.prototype.Af=function(){},t.prototype.Nf=function(){return Object(h.a)(this,void 0,void 0,(function(){var t;return Object(h.c)(this,(function(e){switch(e.label){case 0:return[4,t=this.Rf];case 1:e.sent(),e.label=2;case 2:if(t!==this.Rf)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Ff=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].Ms===t)return!0;return!1},t.prototype.Of=function(t){var e=this;return this.Nf().then((function(){e.gf.sort((function(t,e){return t.Ls-e.Ls}));for(var n=0,r=e.gf;n<r.length;n++){var i=r[n];if(i.Ks(),"all"!==t&&i.Ms===t)break}return e.Nf()}))},t.prototype.kf=function(t){this.bf.push(t)},t.prototype.xf=function(t){var e=this.gf.indexOf(t);this.gf.splice(e,1)},t}(),Oa=-1,Ta=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).Mf=new _a,r.Wr="name"in e?e.name:"[DEFAULT]",r}return Object(h.b)(e,t),e.prototype.io=function(){return this.Lf||ja(this),this.Lf.terminate()},e}(Zr);function Aa(t){return t.Lf||ja(t),t.Lf.df(),t.Lf}function ja(t){var e=t.so(),n=function(t,e,n){return new B(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.zr,t.Wr,e);t.Lf=new fa(t.Hr,t.Mf,n)}function Na(t,e,n){var r=this,i=new tt;return t.ks.enqueue((function(){return Object(h.a)(r,void 0,void 0,(function(){var r;return Object(h.c)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,la(t,n)];case 1:return o.sent(),[4,pa(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===S.FAILED_PRECONDITION||t.code===S.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function Sa(t){if(t.Yr||t.Xr)throw new k(S.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var ka=function(){function t(){}return t.prototype.$f=function(t,e){switch(void 0===e&&(e="none"),wt(t)){case 0:return null;case 1:return t.booleanValue;case 2:return yt(t.integerValue||t.doubleValue);case 3:return this.Bf(t.timestampValue);case 4:return this.qf(t,e);case 5:return t.stringValue;case 6:return this.Uf(gt(t.bytesValue));case 7:return this.Qf(t.referenceValue);case 8:return this.Kf(t.geoPointValue);case 9:return this.Wf(t.arrayValue,e);case 10:return this.jf(t.mapValue,e);default:throw w()}},t.prototype.jf=function(t,e){var n=this,r={};return ht(t.fields||{},(function(t,i){r[t]=n.$f(i,e)})),r},t.prototype.Kf=function(t){return new Lu(yt(t.latitude),yt(t.longitude))},t.prototype.Wf=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.$f(t,e)}))},t.prototype.qf=function(t,e){switch(e){case"previous":var n=function t(e){var n=e.mapValue.fields.__previous_value__;return mt(n)?t(n):n}(t);return null==n?null:this.$f(n,e);case"estimate":return this.Bf(bt(t));default:return null}},t.prototype.Bf=function(t){var e=vt(t);return new nt(e.seconds,e.nanos)},t.prototype.Gf=function(t,e){var n=st.xt(t);I(ar(n));var r=new G(n.get(1),n.get(3)),i=new at(n.Pt(5));return r.isEqual(e)||v("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),xa=function(){function t(t,e,n,r,i){this.zf=t,this.Hf=e,this.S_=n,this.Jf=r,this.v_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.Vt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Su(this.zf,this.v_,this.S_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.Jf},t.prototype.data=function(){if(this.Jf){if(this.v_){var t=new Da(this.zf,this.Hf,this.S_,this.Jf,null);return this.v_.fromFirestore(t)}return this.Hf.$f(this.Jf.Yt())}},t.prototype.get=function(t){if(this.Jf){var e=this.Jf.data().field(Pa("DocumentSnapshot.get",t));if(null!==e)return this.Hf.$f(e)}},t}(),Da=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.b)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(xa);function Pa(t,e){return"string"==typeof e?sa(t,e):e instanceof q?e._.b_:e.b_}function Ra(t){if(ce(t)&&0===t.ne.length)throw new k(S.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Ca=function(){};function La(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o.Yf(t)}return t}var Ua=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xf=e,i.Zf=n,i.td=r,i.type="where",i}return Object(h.b)(e,t),e.prototype.Yf=function(t){var e=Gu(t.firestore),n=function(t,e,n,r,i,o,u){var s;if(i.Ot()){if("array-contains"===o||"array-contains-any"===o)throw new k(S.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){za(u,o);for(var a=[],c=0,h=u;c<h.length;c++){var f=h[c];a.push(Ga(r,t,f))}s={arrayValue:{values:a}}}else s=Ga(r,t,u)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||za(u,o),s=Zu(n,"where",u,"in"===o||"not-in"===o);var l=zt.create(i,o,s);return function(t,e){if(e.ee()){var n=fe(t);if(null!==n&&!n.isEqual(e.field))throw new k(S.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=he(t);null!==r&&Ka(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new k(S.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new k(S.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}(t.C_,0,e,t.firestore.zr,this.Xf,this.Zf,this.td);return new ku(t.firestore,t.v_,function(t,e){var n=t.filters.concat([e]);return new oe(t.path,t.collectionGroup,t.ne.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,n))},e}(Ca),Va=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Xf=e,r.ed=n,r.type="orderBy",r}return Object(h.b)(e,t),e.prototype.Yf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new k(S.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new k(S.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new ee(e,n);return function(t,e){if(null===he(t)){var n=fe(t);null!==n&&Ka(t,n,e.field)}}(t,r),r}(t.C_,this.Xf,this.ed);return new ku(t.firestore,t.v_,function(t,e){var n=t.ne.concat([e]);return new oe(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,e))},e}(Ca),Ma=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.nd=n,i.sd=r,i}return Object(h.b)(e,t),e.prototype.Yf=function(t){return new ku(t.firestore,t.v_,ve(t.C_,this.nd,this.sd))},e}(Ca),Fa=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.rd=n,i.od=r,i}return Object(h.b)(e,t),e.prototype.Yf=function(t){var e=Ba(t,this.type,this.rd,this.od);return new ku(t.firestore,t.v_,function(t,e){return new oe(t.path,t.collectionGroup,t.ne.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.C_,e))},e}(Ca),qa=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.rd=n,i.od=r,i}return Object(h.b)(e,t),e.prototype.Yf=function(t){var e=Ba(t,this.type,this.rd,this.od);return new ku(t.firestore,t.v_,function(t,e){return new oe(t.path,t.collectionGroup,t.ne.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.C_,e))},e}(Ca);function Ba(t,e,n,r){if(n[0]instanceof q&&(n[0]=n[0]._),n[0]instanceof xa)return function(t,e,n,r,i){if(!r)throw new k(S.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],u=0,s=pe(t);u<s.length;u++){var a=s[u];if(a.field.Ot())o.push(At(e,r.key));else{var c=r.field(a.field);if(mt(c))throw new k(S.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.Ct();throw new k(S.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Zt(o,i)}(t.C_,t.firestore.zr,e,n[0].Jf,r);var i=Gu(t.firestore);return function(t,e,n,r,i,o){var u=t.ne;if(i.length>u.length)throw new k(S.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var s=[],a=0;a<i.length;a++){var c=i[a];if(u[a].field.Ot()){if("string"!=typeof c)throw new k(S.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!le(t)&&-1!==c.indexOf("/"))throw new k(S.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(st.xt(c));if(!at.qt(h))throw new k(S.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new at(h);s.push(At(e,f))}else{var l=Zu(n,r,c);s.push(l)}}return new Zt(s,o)}(t.C_,t.firestore.zr,i,e,n,r)}function Ga(t,e,n){if(n instanceof q&&(n=n._),"string"==typeof n){if(""===n)throw new k(S.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!le(e)&&-1!==n.indexOf("/"))throw new k(S.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(st.xt(n));if(!at.qt(r))throw new k(S.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return At(t,new at(r))}if(n instanceof Su)return At(t,n.S_);throw new k(S.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Yr(n)+".")}function za(t,e){if(!Array.isArray(t)||0===t.length)throw new k(S.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new k(S.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Ka(t,e,n){if(!n.isEqual(e))throw new k(S.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Ha(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Wa=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(h.b)(e,t),e.prototype.Uf=function(t){return new x(t)},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.zr);return new Su(this.firestore,null,e)},e}(ka);function Ya(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Qa=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Ja=function(t){function e(e,n,r,i,o,u){var s=this;return(s=t.call(this,e,n,r,i,u)||this).zf=e,s.ad=e,s.metadata=o,s}return Object(h.b)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this.Jf){if(this.v_){var e=new Xa(this.zf,this.Hf,this.S_,this.Jf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Hf.$f(this.Jf.Yt(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Jf){var n=this.Jf.data().field(Pa("DocumentSnapshot.get",t));if(null!==n)return this.Hf.$f(n,e.serverTimestamps)}},e}(xa),Xa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.b)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(Ja),$a=function(){function t(t,e,n,r){this.zf=t,this.Hf=e,this.ud=r,this.metadata=new Qa(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.ud.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this.ud.docs.forEach((function(r){t.call(e,new Xa(n.zf,n.Hf,r.key,r,new Qa(n.ud.tn.has(r.key),n.ud.fromCache),n.query.v_))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this.ud.nn)throw new k(S.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.hd&&this.ld===e||(this.hd=function(t,e){if(t.ud.Ze.bt()){var n=0;return t.ud.docChanges.map((function(e){var r=new Xa(t.zf,t.Hf,e.doc.key,e.doc,new Qa(t.ud.tn.has(e.doc.key),t.ud.fromCache),t.query.v_);return e.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=t.ud.Ze;return t.ud.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new Xa(t.zf,t.Hf,e.doc.key,e.doc,new Qa(t.ud.tn.has(e.doc.key),t.ud.fromCache),t.query.v_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:Za(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this.ld=e),this.hd},t}();function Za(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return w()}}function tc(t,e){return t instanceof Ja&&e instanceof Ja?t.zf===e.zf&&t.S_.isEqual(e.S_)&&(null===t.Jf?null===e.Jf:t.Jf.isEqual(e.Jf))&&t.v_===e.v_:t instanceof $a&&e instanceof $a&&t.zf===e.zf&&Cu(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.ud.isEqual(e.ud)}var ec=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(h.b)(e,t),e.prototype.Uf=function(t){return new x(t)},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.zr);return new Su(this.firestore,null,e)},e}(ka);function nc(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Qr(t,Su);var o=Qr(t.firestore,Ta),u=Gu(o);return e instanceof q&&(e=e._),ic(o,[("string"==typeof e||e instanceof ju?$u(u,"updateDoc",t.S_,e,n,r):Xu(u,"updateDoc",t.S_,e)).F_(t.S_,Fe.exists(!0))])}function rc(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t instanceof q&&(t=t._);var u={includeMetadataChanges:!1},s=0;"object"!=typeof i[s]||Ya(i[s])||(u=i[s],s++);var a,c,f,l={includeMetadataChanges:u.includeMetadataChanges};if(Ya(i[s])){var d=i[s];i[s]=null===(e=d.next)||void 0===e?void 0:e.bind(d),i[s+1]=null===(n=d.error)||void 0===n?void 0:n.bind(d),i[s+2]=null===(r=d.complete)||void 0===r?void 0:r.bind(d)}if(t instanceof Su)c=Qr(t.firestore,Ta),f=ue(t.S_.path),a={next:function(e){i[s]&&i[s](oc(c,t,e))},error:i[s+1],complete:i[s+2]};else{var p=Qr(t,ku);c=Qr(p.firestore,Ta),f=p.C_;var v=new ec(c);a={next:function(t){i[s]&&i[s](new $a(c,v,p,t))},error:i[s+1],complete:i[s+2]},Ra(t.C_)}return function(t,e,n,r){var i=this,o=new Au(r),u=new Cs(e,o,n);return t.ks.Ws((function(){return Object(h.a)(i,void 0,void 0,(function(){var e;return Object(h.c)(this,(function(n){switch(n.label){case 0:return e=ks,[4,wa(t)];case 1:return[2,e.apply(void 0,[n.sent(),u])]}}))}))})),function(){o.I_(),t.ks.Ws((function(){return Object(h.a)(i,void 0,void 0,(function(){var e;return Object(h.c)(this,(function(n){switch(n.label){case 0:return e=xs,[4,wa(t)];case 1:return[2,e.apply(void 0,[n.sent(),u])]}}))}))}))}}(Aa(c),f,l,a)}function ic(t,e){return function(t,e){var n=this,r=new tt;return t.ks.Ws((function(){return Object(h.a)(n,void 0,void 0,(function(){var n;return Object(h.c)(this,(function(i){switch(i.label){case 0:return n=Ys,[4,ba(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(Aa(t),e)}function oc(t,e,n){var r=n.docs.get(e.S_),i=new ec(t);return new Ja(t,i,e.S_,r,new Qa(n.hasPendingWrites,n.fromCache),e.v_)}var sc=function(){function t(t,e){this.zf=t,this._d=e,this.fd=[],this.dd=!1,this.wd=Gu(t)}return t.prototype.set=function(t,e,n){this.Ed();var r=uc(t,this.zf),i=Ha(r.v_,e,n),o=zu(this.wd,"WriteBatch.set",r.S_,i,null!==r.v_,n);return this.fd.push(o.F_(r.S_,Fe.de())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Ed();var o,u=uc(t,this.zf);return e instanceof q&&(e=e._),o="string"==typeof e||e instanceof ju?$u(this.wd,"WriteBatch.update",u.S_,e,n,r):Xu(this.wd,"WriteBatch.update",u.S_,e),this.fd.push(o.F_(u.S_,Fe.exists(!0))),this},t.prototype.delete=function(t){this.Ed();var e=uc(t,this.zf);return this.fd=this.fd.concat(new tn(e.S_,Fe.de())),this},t.prototype.commit=function(){return this.Ed(),this.dd=!0,this.fd.length>0?this._d(this.fd):Promise.resolve()},t.prototype.Ed=function(){if(this.dd)throw new k(S.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function uc(t,e){if(t instanceof q&&(t=t._),t.firestore!==e)throw new k(S.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var ac=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).zf=e,r}return Object(h.b)(e,t),e.prototype.get=function(e){var n=this,r=uc(e,this.zf),i=new ec(this.zf);return t.prototype.get.call(this,e).then((function(t){return new Ja(n.zf,i,r.S_,t.Jf,new Qa(!1,!1),r.v_)}))},e}(function(){function t(t,e){this.zf=t,this.Td=e,this.wd=Gu(t)}return t.prototype.get=function(t){var e=this,n=uc(t,this.zf),r=new Wa(this.zf);return this.Td.ef([n.S_]).then((function(t){if(!t||1!==t.length)return w();var i=t[0];if(i instanceof Ut)return new xa(e.zf,r,n.S_,null,n.v_);if(i instanceof Lt)return new xa(e.zf,r,i.key,i,n.v_);throw w()}))},t.prototype.set=function(t,e,n){var r=uc(t,this.zf),i=Ha(r.v_,e,n),o=zu(this.wd,"Transaction.set",r.S_,i,null!==r.v_,n);return this.Td.set(r.S_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,u=uc(t,this.zf);return e instanceof q&&(e=e._),o="string"==typeof e||e instanceof ju?$u(this.wd,"Transaction.update",u.S_,e,n,r):Xu(this.wd,"Transaction.update",u.S_,e),this.Td.update(u.S_,o),this},t.prototype.delete=function(t){var e=uc(t,this.zf);return this.Td.delete(e.S_),this},t}()),cc=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Sa(t=Qr(t,Ta));var n=Aa(t),r=t.so(),i=new Tu;return Na(n,i,new _u(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Sa(t=Qr(t,Ta));var e=Aa(t),n=t.so(),r=new Tu;return Na(e,r,new Ou(r,n.cacheSizeBytes))}(t._)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.Yr&&!t.Xr)throw new k(S.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new tt;return t.Mf.Tf((function(){return Object(h.a)(e,void 0,void 0,(function(){var e;return Object(h.c)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(h.a)(this,void 0,void 0,(function(){var e;return Object(h.c)(this,(function(n){switch(n.label){case 0:return lr.G()?(e=t+"main",[4,lr.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(lo(t.zr,t.Wr))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._)},t}(),hc=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).Id=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof G||(i.md=e),i}return Object(h.b)(e,t),Object.defineProperty(e.prototype,"zr",{get:function(){return this._.zr},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.no()),t)).merge,this._.eo(t)},e.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this._.no().host&&y("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},e.prototype.enableNetwork=function(){return function(t){var e=this;return t.ks.enqueue((function(){return Object(h.a)(e,void 0,void 0,(function(){var e,n;return Object(h.c)(this,(function(r){switch(r.label){case 0:return[4,ya(t)];case 1:return e=r.sent(),[4,ma(t)];case 2:return n=r.sent(),[2,(e.Zc(!0),function(t){var e=E(t);return e.Gh.delete(0),rs(e)}(n))]}}))}))}))}(Aa(Qr(this._,Ta)))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t.ks.enqueue((function(){return Object(h.a)(e,void 0,void 0,(function(){var e,n;return Object(h.c)(this,(function(r){switch(r.label){case 0:return[4,ya(t)];case 1:return e=r.sent(),[4,ma(t)];case 2:return n=r.sent(),[2,(e.Zc(!1),function(t){return Object(h.a)(this,void 0,void 0,(function(){var e;return Object(h.c)(this,(function(n){switch(n.label){case 0:return(e=E(t)).Gh.add(0),[4,is(e)];case 1:return n.sent(),e.Jh.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(Aa(Qr(this._,Ta)))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Kr("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Id.enableMultiTabIndexedDbPersistence(this):this.Id.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.Id.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new tt;return t.ks.Ws((function(){return Object(h.a)(e,void 0,void 0,(function(){var e;return Object(h.c)(this,(function(r){switch(r.label){case 0:return e=tu,[4,ba(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(Aa(Qr(this._,Ta)))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new Au(e);return t.ks.Ws((function(){return Object(h.a)(n,void 0,void 0,(function(){var e;return Object(h.c)(this,(function(n){switch(n.label){case 0:return e=function(t,e){E(t).rl.add(e),e.next()},[4,wa(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.I_(),t.ks.Ws((function(){return Object(h.a)(n,void 0,void 0,(function(){var e;return Object(h.c)(this,(function(n){switch(n.label){case 0:return e=function(t,e){E(t).rl.delete(e)},[4,wa(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(Aa(t=Qr(t,Ta)),Ya(e)?e:{next:e})}(this._,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.md)throw new k(S.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.md},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Oc(this,Du(this._,t))}catch(t){throw yc(t,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new vc(this,Pu(this._,t))}catch(t){throw yc(t,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new Ic(this,function(t,e){if(t=Qr(t,Zr),Gr("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new k(S.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new ku(t,null,function(t){return new oe(st.Nt(),t)}(e))}(this._,t))}catch(t){throw yc(t,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new tt;return t.ks.Ws((function(){return Object(h.a)(n,void 0,void 0,(function(){var n;return Object(h.c)(this,(function(i){switch(i.label){case 0:return[4,function(t){return va(t).then((function(t){return t.Qh}))}(t)];case 1:return n=i.sent(),new ha(t.ks,n,e,r).run(),[2]}}))}))})),r.promise}(Aa(t),(function(n){return e(new ac(t,n))}))}(this._,(function(n){return t(new pc(e,n))}))},e.prototype.batch=function(){var t=this;return Aa(this._),new dc(new sc(this._,(function(e){return ic(t._,e)})))},e.prototype.loadBundle=function(t){throw new k(S.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},e.prototype.namedQuery=function(t){throw new k(S.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},e}(q),fc=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(h.b)(e,t),e.prototype.Uf=function(t){return new R(new x(t))},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.zr);return vc.Ad(e,this.firestore,null)},e}(ka);function lc(t){var e;e=t,f.setLogLevel(e)}var pc=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(h.b)(e,t),e.prototype.get=function(t){var e=this,n=Tc(t);return this._.get(n).then((function(t){return new bc(e.zf,t)}))},e.prototype.set=function(t,e,n){var r=Tc(t);return n?(zr("Transaction.set",n),this._.set(r,e,n)):this._.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var u=Tc(t);return 2===arguments.length?this._.update(u,e):(r=this._).update.apply(r,Object(h.d)([u,e,n],i)),this},e.prototype.delete=function(t){var e=Tc(t);return this._.delete(e),this},e}(q),dc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.b)(e,t),e.prototype.set=function(t,e,n){var r=Tc(t);return n?(zr("WriteBatch.set",n),this._.set(r,e,n)):this._.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var u=Tc(t);return 2===arguments.length?this._.update(u,e):(r=this._).update.apply(r,Object(h.d)([u,e,n],i)),this},e.prototype.delete=function(t){var e=Tc(t);return this._.delete(e),this},e.prototype.commit=function(){return this._.commit()},e}(q),vc=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Hf=new fc(e),r}return Object(h.b)(e,t),e.Rd=function(t,n,r){if(t.length%2!=0)throw new k(S.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.Ct()+" has "+t.length);return new e(n,new Su(n._,r,new at(t)))},e.Ad=function(t,n,r){return new e(n,new Su(n._,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new Oc(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Oc(this.firestore,Du(this._,t))}catch(t){throw yc(t,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return t instanceof q&&(t=t._),t instanceof Su&&Ru(this._,t)},e.prototype.set=function(t,e){e=zr("DocumentReference.set",e);try{return function(t,e,n){t=Qr(t,Su);var r=Qr(t.firestore,Ta),i=Ha(t.v_,e,n);return ic(r,[zu(Gu(r),"setDoc",t.S_,i,null!==t.v_,n).F_(t.S_,Fe.de())])}(this._,t,e)}catch(t){throw yc(t,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?nc(this._,t):nc.apply(void 0,Object(h.d)([this._,t,e],n))}catch(t){throw yc(t,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return ic(Qr((t=this._).firestore,Ta),[new tn(t.S_,Fe.de())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=gc(e),i=mc(e,(function(e){return new bc(t.firestore,new Ja(t.firestore._,t.Hf,e.S_,e.Jf,e.metadata,t._.v_))}));return rc(this._,r,i)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Qr(t,Su);var e=Qr(t.firestore,Ta),n=Aa(e),r=new ec(e);return function(t,e){var n=this,r=new tt;return t.ks.Ws((function(){return Object(h.a)(n,void 0,void 0,(function(){var n;return Object(h.c)(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(h.a)(this,void 0,void 0,(function(){var r,i;return Object(h.c)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=E(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Ka.Pa(t,e)}))}(t,e)];case 1:return(i=o.sent())instanceof Lt?n.resolve(i):i instanceof Ut?n.resolve(null):n.reject(new k(S.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=Er(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,ga(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t.S_).then((function(n){return new Ja(e,r,t.S_,n,new Qa(n instanceof Lt&&n.Jt,!0),t.v_)}))}(this._):"server"===(null==t?void 0:t.source)?function(t){t=Qr(t,Su);var e=Qr(t.firestore,Ta);return Ia(Aa(e),t.S_,{source:"server"}).then((function(n){return oc(e,t,n)}))}(this._):function(t){t=Qr(t,Su);var e=Qr(t.firestore,Ta);return Ia(Aa(e),t.S_).then((function(n){return oc(e,t,n)}))}(this._)).then((function(t){return new bc(e.firestore,new Ja(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))}))},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(q);function yc(t,e,n){return t.message=t.message.replace(e,n),t}function gc(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Ya(r))return r}return{}}function mc(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=Ya(t[0])?t[0]:Ya(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var bc=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(h.b)(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new vc(this.zf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this._.data(t)},e.prototype.get=function(t,e){return this._.get(t,e)},e.prototype.isEqual=function(t){return tc(this._,t._)},e}(q),wc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.b)(e,t),e.prototype.data=function(t){return this._.data(t)},e}(bc),Ic=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Hf=new fc(e),r}return Object(h.b)(e,t),e.prototype.where=function(t,n,r){try{return new e(this.firestore,La(this._,function(t,e,n){var r=e,i=Pa("where",t);return new Ua(i,r,n)}(t,n,r)))}catch(t){throw yc(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,La(this._,function(t,e){void 0===e&&(e="asc");var n=e,r=Pa("orderBy",t);return new Va(r,n)}(t,n)))}catch(t){throw yc(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,La(this._,function(t){return Jr("limit",t),new Ma("limit",t,"F")}(t)))}catch(t){throw yc(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,La(this._,function(t){return Jr("limitToLast",t),new Ma("limitToLast",t,"L")}(t)))}catch(t){throw yc(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,La(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Fa("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw yc(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,La(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Fa("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw yc(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,La(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new qa("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw yc(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,La(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new qa("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw yc(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return Cu(this._,t._)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Qr(t,ku);var e=Qr(t.firestore,Ta),n=Aa(e),r=new ec(e);return function(t,e){var n=this,r=new tt;return t.ks.Ws((function(){return Object(h.a)(n,void 0,void 0,(function(){var n;return Object(h.c)(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(h.a)(this,void 0,void 0,(function(){var r,i,o,u,s;return Object(h.c)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,jo(t,e,!0)];case 1:return s=a.sent(),r=new qs(e,s.za),i=r.bl(s.documents),o=r.yr(i,!1),n.resolve(o.snapshot),[3,3];case 2:return u=a.sent(),s=Er(u,"Failed to execute query '"+e+" against cache"),n.reject(s),[3,3];case 3:return[2]}}))}))},[4,ga(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t.C_).then((function(n){return new $a(e,r,t,n)}))}(this._):"server"===(null==t?void 0:t.source)?function(t){t=Qr(t,ku);var e=Qr(t.firestore,Ta),n=Aa(e),r=new ec(e);return Ea(n,t.C_,{source:"server"}).then((function(n){return new $a(e,r,t,n)}))}(this._):function(t){t=Qr(t,ku);var e=Qr(t.firestore,Ta),n=Aa(e),r=new ec(e);return Ra(t.C_),Ea(n,t.C_).then((function(n){return new $a(e,r,t,n)}))}(this._)).then((function(t){return new _c(e.firestore,new $a(e.firestore._,e.Hf,e._,t.ud))}))},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=gc(e),i=mc(e,(function(e){return new _c(t.firestore,new $a(t.firestore._,t.Hf,t._,e.ud))}));return rc(this._,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(q),Ec=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(h.b)(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new wc(this.zf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),e}(q),_c=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(h.b)(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new Ic(this.zf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this._.docs.map((function(e){return new wc(t.zf,e)}))},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map((function(t){return new Ec(e.zf,t)}))},e.prototype.forEach=function(t,e){var n=this;this._.forEach((function(r){t.call(e,new wc(n.zf,r))}))},e.prototype.isEqual=function(t){return tc(this._,t._)},e}(q),Oc=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._=n,r}return Object(h.b)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._.parent;return t?new vc(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new vc(this.firestore,void 0===t?Pu(this._):Pu(this._,t))}catch(t){throw yc(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Qr(t.firestore,Ta),r=Pu(t),i=Ha(t.v_,e);return ic(n,[zu(Gu(t.firestore),"addDoc",r.S_,i,null!==t.v_,{}).F_(r.S_,Fe.exists(!1))]).then((function(){return r}))}(this._,t).then((function(t){return new vc(e.firestore,t)}))},e.prototype.isEqual=function(t){return Ru(this._,t._)},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(Ic);function Tc(t){return t instanceof q&&(t=t._),Qr(t,Su)}var Ac=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(ju.bind.apply(ju,Object(h.d)([void 0],e))))||this}return Object(h.b)(e,t),e.documentId=function(){return new e(ut.kt().Ct())},e.prototype.isEqual=function(t){return t instanceof q&&(t=t._),t instanceof ju&&this._.b_.isEqual(t.b_)},e}(q),jc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.b)(e,t),e.serverTimestamp=function(){var t=new Wu("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new Ku("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Yu("arrayUnion",t)}.apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Qu("arrayRemove",t)}.apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new Ju("increment",t)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this._.isEqual(t._)},e}(q);!function(){function t(){this.Pd={},this.yd=new tt,this.gd={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this.Pd={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this.yd.promise.catch(t)},t.prototype.then=function(t,e){return this.yd.promise.then(t,e)},t.prototype.e_=function(t){this.n_(t),this.Pd.complete&&this.Pd.complete(),this.yd.resolve(t)},t.prototype.i_=function(t){this.gd.taskState="Error",this.Pd.next&&this.Pd.next(this.gd),this.Pd.error&&this.Pd.error(t),this.yd.reject(t)},t.prototype.n_=function(t){this.gd=t,this.Pd.next&&this.Pd.next(t)}}()}).call(this,n(146))},833:function(t,e,n){"use strict";n.r(e);var r,o=n(780),c=(n(792),n(779),n(799),n(819)),h=n(801),f={Firestore:c.d,GeoPoint:c.o,Timestamp:c.p,Blob:c.c,Transaction:c.e,WriteBatch:c.n,DocumentReference:c.a,DocumentSnapshot:c.g,Query:c.i,QueryDocumentSnapshot:c.f,QuerySnapshot:c.l,CollectionReference:c.j,FieldPath:c.m,FieldValue:c.r,setLogLevel:c.b,CACHE_SIZE_UNLIMITED:c.k};(function(t,e){t.INTERNAL.registerComponent(new h.a("firestore",(function(t){return function(t,e){return new c.d(t,new c.h(t,e),new c.q)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},f)))})(r=o.a),r.registerVersion("@firebase/firestore","2.1.0")}}]);